import{j as r}from"./index-lWfxYzVq.js";import{f as R,u as P,r as a,L as D}from"./vendor-router-Ck4ZuSP9.js";import{p as b}from"./firebaseProgramRegistrations-CcV5GOOA.js";import{p as w}from"./firebasePrograms-DQfL_YhU.js";import{p as h}from"./firebasePeople-B5ZBKo1U.js";import{p as A}from"./firebasePaymentMethods-CJsgpCPD.js";import{V as $,S as C,B as u,ax as E,x as _,H as k,aE as s,a8 as Y}from"./vendor-antd-CieyQibU.js";import"./vendor-react-Ck9bq5u-.js";import"./vendor-redux-BbD-gcRX.js";import"./vendor-firebase-BzUsRx-X.js";import"./slugify-IzZIKjBC.js";const{Title:F}=_;function Q(){const{id:m}=R(),d=P(),c=window.__wgys_location__||void 0,p=c&&c.state?.from||void 0,[x,y]=a.useState(!0),[e,j]=a.useState(null),[N,B]=a.useState(""),[I,l]=a.useState(""),[v,g]=a.useState(""),[M,f]=a.useState("");return a.useEffect(()=>{(async()=>{if(m){y(!0);try{const t=await b.getProgramRegistration(m);j(t)}catch(t){console.error("Failed to load registration",t)}finally{y(!1)}}})()},[m]),a.useEffect(()=>{(async()=>{if(e)try{if(e.programId||e.programName){let t=e.programName;!t&&e.programId&&(t=(await w.getPrograms()).find(i=>i.id===e.programId)?.name||e.programId),B(t||"")}if(!e.playerName&&!e.athleteName&&e.athleteId)try{const t=await h.getPersonById(e.athleteId);if(t){const o=`${t.firstName||""} ${t.lastName||""}`.trim();f(o)}}catch{}else f(e.playerName||e.athleteName||"");if(e.registeredBy)try{const t=await h.getPersonByUserId(e.registeredBy);if(t){const o=`${t.firstName||""} ${t.lastName||""}`.trim();l(o||e.registeredBy)}else l(e.registeredBy)}catch{l(e.registeredBy)}if(e.paymentDisplay)g(e.paymentDisplay);else if(e.paymentMethod){let t=e.paymentMethod;if(e.registeredBy)try{const n=(await A.getPaymentMethodsByUser(e.registeredBy)).find(i=>i.id===e.paymentMethod||i.stripePaymentMethodId===e.paymentMethod);if(n){const i=(n.brand||"").toUpperCase(),S=n.last4||"";t=`${i} **** ${S}`.trim()}else t==="stripe"?t="Stripe":t==="other"&&(t="Other")}catch{}g(t)}}catch(t){console.error("Failed to resolve confirmation display fields",t)}})()},[e]),x?r.jsx($,{}):e?r.jsxs("div",{className:"page-container",children:[r.jsx("div",{style:{marginBottom:16},children:r.jsxs(C,{direction:"vertical",style:{width:"100%"},children:[r.jsx(u,{icon:r.jsx(E,{}),onClick:()=>{if(p)return d(p);d(-1)},children:"Back"}),r.jsx(F,{level:2,style:{margin:0},children:"Registration Confirmation"})]})}),r.jsxs(k,{children:[r.jsxs(s,{column:1,bordered:!0,children:[r.jsx(s.Item,{label:"Program",children:N||e.programName||e.programId}),r.jsx(s.Item,{label:"Registrant",children:M||e.playerName||e.athleteName||"N/A"}),r.jsx(s.Item,{label:"Registered By",children:I||e.registeredBy}),r.jsxs(s.Item,{label:"Amount",children:["$",(e.totalAmount??e.amount??0).toFixed(2)]}),r.jsx(s.Item,{label:"Payment Method",children:e.paymentDisplay||v||e.paymentMethod}),r.jsx(s.Item,{label:"Status",children:e.status||"pending"}),r.jsx(s.Item,{label:"Created At",children:e.createdAt?Y(e.createdAt).format("MMM D, YYYY h:mm A"):""})]}),r.jsx("div",{style:{marginTop:16},children:r.jsx(u,{type:"primary",children:r.jsx(D,{to:"/my-registrations",children:"Back to My Registrations"})})})]})]}):r.jsx("div",{children:"Registration not found"})}export{Q as default};
