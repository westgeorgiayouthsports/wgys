const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/firebaseFamilies-CHrcTgng.js","assets/vendor-firebase-BzUsRx-X.js","assets/index-lWfxYzVq.js","assets/vendor-react-Ck9bq5u-.js","assets/vendor-router-Ck4ZuSP9.js","assets/vendor-antd-CieyQibU.js","assets/vendor-redux-BbD-gcRX.js","assets/index-C63fGlVj.css"])))=>i.map(i=>d[i]);
import{_ as z,j as e}from"./index-lWfxYzVq.js";import{u as ge,r as u}from"./vendor-router-Ck4ZuSP9.js";import{a as ve}from"./vendor-redux-BbD-gcRX.js";import{p as g}from"./firebasePeople-B5ZBKo1U.js";import{s as L,c as Q}from"./storageService-BGD7Twul.js";import{v as Ie,f as _}from"./firebaseFiles-ka_SnfIb.js";import{F as Oe,G as c,a8 as $,W as b,X as y,x as Fe,S as A,B as j,ao as ee,ar as be,H as we,V as Ne,a2 as Se,M as T,I as v,a9 as Ce,d as s,as as Ae,a0 as C,ai as Pe,b as Me,s as Be,f as De,an as Ye,h as ke,af as Ee,ag as Re,ah as ze}from"./vendor-antd-CieyQibU.js";import{c as Le}from"./age-BJnAeRxZ.js";import"./vendor-react-Ck9bq5u-.js";import"./vendor-firebase-BzUsRx-X.js";const{Title:_e,Text:w}=Fe;function Je(){const{user:o}=ve(a=>a.auth),V=ge(),{message:d}=Oe.useApp(),[O,F]=u.useState([]),[t,P]=u.useState(null),[ae,U]=u.useState(!0),[M,N]=u.useState(!1),[l,B]=u.useState(null),[ie,W]=u.useState(!1),[K,se]=u.useState([]),[te,G]=u.useState(!1),[,D]=u.useState({}),[S,Y]=u.useState(!1),[le,k]=u.useState(!1),[p,H]=u.useState(null),[E,q]=u.useState(""),[X,J]=u.useState(""),[x]=c.useForm();u.useEffect(()=>{Z()},[]),u.useEffect(()=>{M&&l&&x.setFieldsValue({firstName:l.firstName,lastName:l.lastName,email:l.email,phone:l.phone,dateOfBirth:l.dateOfBirth?$(l.dateOfBirth):null,sex:l.sex,roles:l.roles,address:l.address,city:l.city,state:l.state,zipCode:l.zipCode,schoolName:l.schoolName,graduationYear:l.graduationYear})},[M,l,x]);const Z=async()=>{U(!0);try{const i=(await g.getPeople()).find(r=>r.userId===o?.uid);if(P(i||null),i?.familyId){const r=await g.getPeopleByFamily(i.familyId);F(r);const{familiesService:m}=await z(async()=>{const{familiesService:h}=await import("./firebaseFamilies-CHrcTgng.js");return{familiesService:h}},__vite__mapDeps([0,1,2,3,4,5,6,7])),n=await m.getFamily(i.familyId);H(n)}else if(i)F([i]);else{const r={firstName:o?.displayName?.split(" ")[0]||"User",lastName:o?.displayName?.split(" ").slice(1).join(" ")||"",email:o?.email||"",roles:["parent"]},m=await g.createPerson(r,o?.uid||"");await g.linkPersonToAccount(m,o?.uid||"");const n={id:m,...r,hasAccount:!0,userId:o?.uid,contactPreferences:[],programs:[],teams:[],groups:[],source:"signup",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),createdBy:o?.uid||"",isActive:!0};P(n),F([n])}}catch(a){console.error("❌ Error loading family data:",a),d.error("Failed to load family information")}finally{U(!1)}},re=()=>{B(null),x.resetFields(),Y(!0),t&&x.setFieldsValue({address:t.address,city:t.city,state:t.state,zipCode:t.zipCode}),N(!0)},ne=a=>{if(a.userId!==o?.uid&&a.familyId!==t?.familyId&&a.createdBy!==o?.uid){d.error("You can only edit your own family members");return}B(a);const i=t&&a.address===t.address&&a.city===t.city&&a.state===t.state&&a.zipCode===t.zipCode;Y(a.userId===o?.uid?!1:i||!1),x.setFieldsValue({firstName:a.firstName,lastName:a.lastName,email:a.email,phone:a.phone,dateOfBirth:a.dateOfBirth?$(a.dateOfBirth):null,sex:a.sex,roles:a.roles,address:a.address,city:a.city,state:a.state,zipCode:a.zipCode,schoolName:a.schoolName,graduationYear:a.graduationYear}),N(!0)},oe=async a=>{B(a),W(!0),await R()},R=async()=>{if(t?.familyId){G(!0);try{const a=await _.getFilesByFamily(t.familyId);se(a||[])}catch(a){console.error("Failed to load family files",a);const i=a;i&&(i.code==="PERMISSION_DENIED"||i.message&&i.message.toLowerCase().includes("permission"))?d.error("You do not have permission to access family files"):d.error("Failed to load family files")}finally{G(!1)}}},de=async(a,i)=>{if(!t?.familyId||!o?.uid)return;const r=20*1024*1024;if(a.size>r){d.error("File too large (max 20 MB)");return}if(["desktop.ini",".ds_store"].includes(a.name.toLowerCase())||a.name.startsWith(".")){d.error("Unsupported file");return}const n=`family_documents/${t.familyId}/${o.uid}/${Date.now()}_${a.name}`,h=`${Date.now()}_${a.name}`;D(f=>({...f,[h]:0}));try{const{path:f}=await L.uploadFileWithProgress(n,a,I=>{D(je=>({...je,[h]:I}))});await _.addFamilyFile(t.familyId,{fileName:a.name,storagePath:f,uploaderId:o.uid,size:a.size,athleteId:i||null}),d.success(`${a.name} uploaded`),await R()}catch(f){console.error("Upload failed",f),d.error("Upload failed")}finally{D(f=>{const I={...f};return delete I[h],I})}},ce=async a=>{if(t?.familyId)try{await L.deleteFile(a.storagePath),await _.deleteFamilyFile(t.familyId,a.id),d.success("File deleted"),await R()}catch(i){console.error("Failed to delete file",i),d.error("Failed to delete file")}},me=async a=>{const i=O.find(r=>r.id===a);if(i?.userId===o?.uid){d.error("You cannot delete your own account");return}if(i?.familyId!==t?.familyId){d.error("You can only delete your own family members");return}try{await g.deletePerson(a),F(O.filter(r=>r.id!==a)),d.success("Family member removed successfully")}catch(r){console.error("❌ Error deleting person:",r),d.error("Failed to remove family member")}},he=async a=>{try{const i={...a,dateOfBirth:a.dateOfBirth?$(a.dateOfBirth).format("YYYY-MM-DD"):void 0},r=i.roles||[],m=r.includes("athlete")||r.includes("child");if(m&&t&&(i.address=t.address,i.city=t.city,i.state=t.state,i.zipCode=t.zipCode),m||(i.schoolName=void 0,i.graduationYear=void 0),i.graduationYear){const n=Number(i.graduationYear);i.graduationYear=Number.isNaN(n)?void 0:n}if(l)await g.updatePerson(l.id,i),F(O.map(n=>n.id===l.id?{...n,...i,updatedAt:new Date().toISOString()}:n)),d.success("Information updated successfully");else{const n=await g.createPerson(i,o?.uid||"");let h=t?.familyId;if(t?.familyId)await g.addPersonToFamily(t.familyId,n);else if(t){const I=`${t.lastName} Family`;h=await g.createFamily(I,t.id,o?.uid||""),await g.addPersonToFamily(h,n),P({...t,familyId:h})}const f={id:n,...i,hasAccount:!1,familyId:h,contactPreferences:[],programs:[],teams:[],groups:[],source:"manual",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),createdBy:o?.uid||"",isActive:!0};F([...O,f]),d.success("Family member added successfully")}N(!1),x.resetFields()}catch(i){console.error("❌ Error saving person:",i),d.error("Failed to save information")}},ue=a=>({parent:"blue",guardian:"cyan",athlete:"green",grandparent:"magenta",relative:"geekblue",other:"default"})[a]||"default",ye=a=>Le(a),pe=a=>{const i=new URLSearchParams;a.dateOfBirth&&i.set("dateOfBirth",a.dateOfBirth),a.sex&&i.set("sex",a.sex),i.set("athleteId",a.id),V(`/register?${i.toString()}`)},xe=a=>{const i=new URLSearchParams;a.dateOfBirth&&i.set("dateOfBirth",a.dateOfBirth),a.sex&&i.set("sex",a.sex),V(`/registration-help?${i.toString()}`)},fe=[{title:"Name",key:"name",render:a=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx(Pe,{size:40,src:a.photoURL,icon:e.jsx(Me,{}),style:{backgroundColor:a.hasAccount?"#52c41a":"#1890ff"},onError:()=>!0}),e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:500},children:[a.firstName," ",a.lastName,a.userId===o?.uid&&e.jsx(C,{color:"gold",style:{marginLeft:8},children:"You"}),p&&a.id===p.primaryPersonId&&e.jsx(C,{color:"blue",style:{marginLeft:8},children:"Primary"}),a.hasAccount&&a.userId!==o?.uid&&e.jsx(C,{color:"green",style:{marginLeft:8},children:"Account"})]}),e.jsx(w,{type:"secondary",children:a.email})]})]})},{title:"Relationship",key:"roles",render:a=>e.jsx("div",{children:a.roles.map(i=>e.jsx(C,{color:ue(i),style:{marginBottom:"4px"},children:i},i))})},{title:"Contact",key:"contact",render:a=>e.jsxs("div",{children:[a.phone&&e.jsx("div",{children:a.phone}),a.dateOfBirth&&e.jsxs("div",{children:[e.jsx("div",{children:e.jsxs(w,{type:"secondary",children:["Age: ",ye(a.dateOfBirth)]})}),((a.roles||[]).includes("athlete")||(a.roles||[]).includes("child"))&&e.jsx("div",{style:{marginTop:4},children:e.jsxs(w,{type:"secondary",children:["Grade: ",(()=>{const i=Q(a.graduationYear);return i===null?"—":i===0?"K":i})()]})})]})]})},{title:"School Info",key:"school",render:a=>e.jsxs("div",{children:[a.schoolName&&e.jsx("div",{children:a.schoolName}),a.graduationYear&&e.jsxs(w,{type:"secondary",children:["Class of ",a.graduationYear]})]})},{title:"Actions",key:"actions",render:a=>e.jsxs(A,{children:[((a.roles||[]).includes("athlete")||(a.roles||[]).includes("child"))&&e.jsxs(e.Fragment,{children:[e.jsx(j,{size:"small",type:"primary",icon:e.jsx(Be,{}),onClick:()=>{pe(a)},children:"Register"}),e.jsx(j,{size:"small",icon:e.jsx(De,{}),onClick:()=>{xe(a)},title:"Registration Help",children:"Help"})]}),p&&(a.roles?.includes("parent")||a.roles?.includes("guardian"))&&a.id!==p.primaryPersonId&&e.jsx(j,{size:"small",type:"primary",icon:e.jsx(Ye,{}),onClick:async()=>{try{const{familiesService:i}=await z(async()=>{const{familiesService:r}=await import("./firebaseFamilies-CHrcTgng.js");return{familiesService:r}},__vite__mapDeps([0,1,2,3,4,5,6,7]));await i.updateFamily(p.id,{primaryPersonId:a.id}),H({...p,primaryPersonId:a.id}),d.success({content:`${a.firstName} ${a.lastName} is now the primary member`})}catch{d.error({content:"Failed to set primary member"})}},children:"Set Primary"}),e.jsx(j,{size:"small",icon:e.jsx(ke,{}),onClick:()=>oe(a),children:"Files"}),e.jsx(j,{size:"small",icon:e.jsx(Ee,{}),onClick:()=>{ne(a)},children:"Edit"}),a.userId!==o?.uid&&p?.primaryPersonId!==a.id&&e.jsx(Re,{title:"Remove Family Member",description:"Are you sure you want to remove this family member?",onConfirm:()=>me(a.id),okText:"Yes",cancelText:"No",children:e.jsx(j,{size:"small",danger:!0,icon:e.jsx(ze,{}),children:"Remove"})})]})}];return e.jsxs("div",{className:"page-container",children:[e.jsx("div",{style:{marginBottom:"24px"},children:e.jsxs(b,{justify:"space-between",align:"middle",children:[e.jsxs(y,{children:[e.jsx(_e,{level:2,style:{margin:0},children:"My Family"}),e.jsx(w,{type:"secondary",children:"Manage your family information and add family members"})]}),e.jsx(y,{children:e.jsxs(A,{children:[p&&e.jsx(j,{icon:e.jsx(ee,{}),onClick:()=>{J(p.name),q(p.primaryPersonId),k(!0)},children:"Manage Family"}),e.jsx(j,{type:"primary",icon:e.jsx(be,{}),onClick:re,children:"Add Family Member"})]})})]})}),e.jsx(we,{title:e.jsxs(A,{children:[e.jsx(ee,{}),e.jsxs("span",{children:[t?.lastName||"Your"," Family (",O.length," members)"]})]}),children:e.jsx(Ne,{spinning:ae,children:e.jsx(Se,{columns:fe,dataSource:O,rowKey:"id",pagination:!1,locale:{emptyText:"No family members found"}})})}),e.jsxs(T,{title:l?`${l.firstName} ${l.lastName} — Files`:"Family Files",open:ie,onCancel:()=>W(!1),footer:null,width:700,children:[e.jsxs("div",{style:{marginBottom:12},children:[e.jsx("div",{style:{marginBottom:8},children:e.jsx("strong",{children:"Upload file for:"})}),e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx("input",{type:"file",id:"familyFileInput",onChange:a=>{const i=a.target.files?a.target.files[0]:null;i&&de(i,l?.id||null),a.target.value=""}}),e.jsx("div",{style:{color:"#8c8c8c",fontSize:12},children:"Max 20 MB. Hidden/system files rejected."})]})]}),e.jsxs("div",{children:[e.jsx("div",{style:{marginBottom:8},children:e.jsx("strong",{children:"Files"})}),te?e.jsx("div",{children:"Loading files..."}):e.jsxs("div",{children:[K.length===0&&e.jsx("div",{children:"No files uploaded"}),K.map(a=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 0",borderBottom:"1px solid #f0f0f0"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600},children:a.fileName}),e.jsxs("div",{style:{fontSize:12,color:"#8c8c8c"},children:[a.athleteId?`Athlete: ${a.athleteId}`:"Family file"," • ",a.size?`${Math.round(a.size/1024)} KB`:"—"," • ",a.uploadedAt?new Date(a.uploadedAt).toLocaleString():"—"]})]}),e.jsxs("div",{children:[e.jsx("a",{href:"#",onClick:async i=>{i.preventDefault();try{const r=await L.getFileUrl(a.storagePath);window.open(r,"_blank")}catch(r){console.error(r),d.error("Failed to get file URL")}},children:"Download"}),e.jsx(j,{style:{marginLeft:8},size:"small",danger:!0,onClick:()=>ce(a),children:"Delete"})]})]},a.id))]})]})]}),e.jsx(T,{title:e.jsxs("div",{children:[l?"Edit Family Member":"Add Family Member",l?.userId===o?.uid&&e.jsx(C,{color:"blue",style:{marginLeft:8},children:"Primary Account"})]}),open:M,onCancel:()=>{N(!1),x.resetFields()},footer:null,width:600,children:e.jsxs(c,{form:x,layout:"vertical",onFinish:he,children:[e.jsxs(b,{gutter:16,children:[e.jsx(y,{span:12,children:e.jsx(c.Item,{name:"firstName",label:"First Name",rules:[{required:!0,message:"Please enter first name"}],children:e.jsx(v,{placeholder:"Enter first name"})})}),e.jsx(y,{span:12,children:e.jsx(c.Item,{name:"lastName",label:"Last Name",rules:[{required:!0,message:"Please enter last name"}],children:e.jsx(v,{placeholder:"Enter last name"})})})]}),e.jsxs(b,{gutter:16,children:[e.jsx(y,{span:12,children:e.jsx(c.Item,{name:"email",label:"Email (Optional)",rules:[{type:"email",message:"Please enter valid email"}],children:e.jsx(v,{placeholder:"Enter email address (optional)"})})}),e.jsx(y,{span:12,children:e.jsx(c.Item,{name:"phone",label:"Phone",children:e.jsx(v,{placeholder:"Enter phone number"})})})]}),e.jsxs(b,{gutter:16,children:[e.jsx(y,{span:8,children:e.jsx(c.Item,{name:"dateOfBirth",label:"Date of Birth",children:e.jsx(Ce,{style:{width:"100%"},format:"YYYY-MM-DD",placeholder:"YYYY-MM-DD",allowClear:!0})})}),e.jsx(y,{span:8,children:e.jsx(c.Item,{name:"sex",label:"Sex",children:e.jsxs(s,{placeholder:"Select sex",children:[e.jsx(s.Option,{value:"male",children:"Male"}),e.jsx(s.Option,{value:"female",children:"Female"})]})})}),e.jsx(y,{span:8,children:e.jsx(c.Item,{name:"roles",label:"Relationship",rules:[{required:!0,message:"Please select relationship"},{validator:Ie}],children:e.jsxs(s,{mode:"multiple",placeholder:"Select relationship",children:[e.jsx(s.Option,{value:"athlete",children:"Athlete/Child"}),e.jsx(s.Option,{value:"grandparent",children:"Grandparent"}),e.jsx(s.Option,{value:"guardian",children:"Guardian"}),e.jsx(s.Option,{value:"other",children:"Other"}),e.jsx(s.Option,{value:"parent",children:"Parent"}),e.jsx(s.Option,{value:"relative",children:"Relative"})]})})})]}),e.jsx(c.Item,{noStyle:!0,shouldUpdate:()=>!0,children:({getFieldValue:a})=>{const i=a("roles")??(l?.roles||[]);return(i||[]).includes("athlete")||(i||[]).includes("child")?null:e.jsxs(e.Fragment,{children:[e.jsx(c.Item,{children:e.jsx(Ae,{checked:S,disabled:l?.userId===o?.uid,onChange:m=>{Y(m.target.checked),m.target.checked&&t?x.setFieldsValue({address:t.address,city:t.city,state:t.state,zipCode:t.zipCode}):x.setFieldsValue({address:"",city:"",state:"",zipCode:""})},children:"Same address as primary account"})}),e.jsx(c.Item,{name:"address",label:"Address",children:e.jsx(v,{placeholder:"Enter street address",disabled:S})}),e.jsxs(b,{gutter:16,children:[e.jsx(y,{span:8,children:e.jsx(c.Item,{name:"city",label:"City",children:e.jsx(v,{placeholder:"Enter city",disabled:S})})}),e.jsx(y,{span:8,children:e.jsx(c.Item,{name:"state",label:"State",children:e.jsxs(s,{placeholder:"Select state",disabled:S,showSearch:{filterOption:(m,n)=>{const h=n?.label??n?.children;return String(h||"").toLowerCase().includes(String(m).toLowerCase())}},children:[e.jsx(s.Option,{value:"AL",children:"Alabama"}),e.jsx(s.Option,{value:"AK",children:"Alaska"}),e.jsx(s.Option,{value:"AZ",children:"Arizona"}),e.jsx(s.Option,{value:"AR",children:"Arkansas"}),e.jsx(s.Option,{value:"CA",children:"California"}),e.jsx(s.Option,{value:"CO",children:"Colorado"}),e.jsx(s.Option,{value:"CT",children:"Connecticut"}),e.jsx(s.Option,{value:"DE",children:"Delaware"}),e.jsx(s.Option,{value:"FL",children:"Florida"}),e.jsx(s.Option,{value:"GA",children:"Georgia"}),e.jsx(s.Option,{value:"HI",children:"Hawaii"}),e.jsx(s.Option,{value:"ID",children:"Idaho"}),e.jsx(s.Option,{value:"IL",children:"Illinois"}),e.jsx(s.Option,{value:"IN",children:"Indiana"}),e.jsx(s.Option,{value:"IA",children:"Iowa"}),e.jsx(s.Option,{value:"KS",children:"Kansas"}),e.jsx(s.Option,{value:"KY",children:"Kentucky"}),e.jsx(s.Option,{value:"LA",children:"Louisiana"}),e.jsx(s.Option,{value:"ME",children:"Maine"}),e.jsx(s.Option,{value:"MD",children:"Maryland"}),e.jsx(s.Option,{value:"MA",children:"Massachusetts"}),e.jsx(s.Option,{value:"MI",children:"Michigan"}),e.jsx(s.Option,{value:"MN",children:"Minnesota"}),e.jsx(s.Option,{value:"MS",children:"Mississippi"}),e.jsx(s.Option,{value:"MO",children:"Missouri"}),e.jsx(s.Option,{value:"MT",children:"Montana"}),e.jsx(s.Option,{value:"NE",children:"Nebraska"}),e.jsx(s.Option,{value:"NV",children:"Nevada"}),e.jsx(s.Option,{value:"NH",children:"New Hampshire"}),e.jsx(s.Option,{value:"NJ",children:"New Jersey"}),e.jsx(s.Option,{value:"NM",children:"New Mexico"}),e.jsx(s.Option,{value:"NY",children:"New York"}),e.jsx(s.Option,{value:"NC",children:"North Carolina"}),e.jsx(s.Option,{value:"ND",children:"North Dakota"}),e.jsx(s.Option,{value:"OH",children:"Ohio"}),e.jsx(s.Option,{value:"OK",children:"Oklahoma"}),e.jsx(s.Option,{value:"OR",children:"Oregon"}),e.jsx(s.Option,{value:"PA",children:"Pennsylvania"}),e.jsx(s.Option,{value:"RI",children:"Rhode Island"}),e.jsx(s.Option,{value:"SC",children:"South Carolina"}),e.jsx(s.Option,{value:"SD",children:"South Dakota"}),e.jsx(s.Option,{value:"TN",children:"Tennessee"}),e.jsx(s.Option,{value:"TX",children:"Texas"}),e.jsx(s.Option,{value:"UT",children:"Utah"}),e.jsx(s.Option,{value:"VT",children:"Vermont"}),e.jsx(s.Option,{value:"VA",children:"Virginia"}),e.jsx(s.Option,{value:"WA",children:"Washington"}),e.jsx(s.Option,{value:"WV",children:"West Virginia"}),e.jsx(s.Option,{value:"WI",children:"Wisconsin"}),e.jsx(s.Option,{value:"WY",children:"Wyoming"}),e.jsx(s.Option,{value:"DC",children:"District of Columbia"})]})})}),e.jsx(y,{span:8,children:e.jsx(c.Item,{name:"zipCode",label:"Zip Code",children:e.jsx(v,{placeholder:"Enter zip code",disabled:S})})})]})]})}}),e.jsx(c.Item,{noStyle:!0,shouldUpdate:()=>!0,children:({getFieldValue:a})=>{const i=a("roles")??(l?.roles||[]);return(i||[]).includes("athlete")||(i||[]).includes("child")?e.jsxs(b,{gutter:16,children:[e.jsx(y,{span:12,children:e.jsx(c.Item,{name:"schoolName",label:"School Name",children:e.jsx(v,{placeholder:"Enter school name"})})}),e.jsx(y,{span:12,children:(()=>{const m=a("graduationYear"),n=m?Number(m):void 0,h=n?Q(n):null,f=h===null?null:h===0?"K":h,I=n?e.jsxs("span",{children:["Graduation Year (",e.jsxs(w,{type:"secondary",children:["Grade: ",f]}),")"]}):"Graduation Year";return e.jsx(c.Item,{name:"graduationYear",label:I,children:e.jsx(v,{type:"number",placeholder:"Enter graduation year"})})})()})]}):null}}),e.jsx(c.Item,{style:{marginBottom:0,textAlign:"right"},children:e.jsxs(A,{children:[e.jsx(j,{onClick:()=>{N(!1),x.resetFields()},children:"Cancel"}),e.jsx(j,{type:"primary",htmlType:"submit",children:l?"Update":"Add Family Member"})]})})]})}),e.jsx(T,{title:"Manage Family",open:le,onCancel:()=>k(!1),onOk:async()=>{try{if(!E){d.error({content:"Please select a primary family member"});return}const{familiesService:a}=await z(async()=>{const{familiesService:i}=await import("./firebaseFamilies-CHrcTgng.js");return{familiesService:i}},__vite__mapDeps([0,1,2,3,4,5,6,7]));await a.updateFamily(p.id,{name:X,primaryPersonId:E}),d.success({content:"Family updated successfully"}),k(!1),await Z()}catch{d.error({content:"Failed to update family"})}},width:500,children:p&&e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:16},children:[e.jsx("label",{style:{display:"block",marginBottom:8,fontWeight:500},children:"Family Name"}),e.jsx(v,{value:X,onChange:a=>J(a.target.value),placeholder:"Enter family name"})]}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsx("label",{style:{display:"block",marginBottom:8,fontWeight:500},children:"Primary Family Member"}),e.jsx(s,{style:{width:"100%"},value:E,onChange:a=>q(a),placeholder:"Select primary member",options:O.filter(a=>a.roles?.includes("parent")||a.roles?.includes("guardian")).map(a=>({label:`${a.firstName} ${a.lastName}`,value:a.id}))})]})]})})]})}export{Je as default};
