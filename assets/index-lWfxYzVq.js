const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/RegistrationHelp-sSbIHfqD.js","assets/vendor-router-Ck4ZuSP9.js","assets/vendor-react-Ck9bq5u-.js","assets/vendor-antd-CieyQibU.js","assets/firebaseSports-DK6SYh6x.js","assets/vendor-firebase-BzUsRx-X.js","assets/slugify-IzZIKjBC.js","assets/season-wVjdxr9p.js","assets/vendor-redux-BbD-gcRX.js","assets/CartDrawer-BABbjCy8.js","assets/firebaseProgramRegistrations-CcV5GOOA.js","assets/firebaseSeasons-BgcPTcUq.js","assets/season-CjhZh6iC.js","assets/firebasePrograms-DQfL_YhU.js","assets/firebaseTeams-DYGNnM-E.js","assets/firebaseDiscounts-BpMLRc1-.js","assets/paymentPlans-v28zbRiz.js","assets/Dashboard-BLMhr33r.js","assets/analyticsClient-cghBTDXY.js","assets/firebaseAnnouncements-nWIjlOxu.js","assets/Dashboard-D1keEC3S.css","assets/Teams-BRgmp5F7.js","assets/AdminPageHeader-BidreVSQ.js","assets/Sports-BWmRkura.js","assets/TeamChat-CsGqatTB.js","assets/Admin-DhuFp7ik.js","assets/Announcements-BCKFIzl-.js","assets/Announcements-CeOkkOHk.css","assets/People-oHNuwdLB.js","assets/firebaseFiles-ka_SnfIb.js","assets/firebasePeople-B5ZBKo1U.js","assets/firebaseFamilies-CHrcTgng.js","assets/storageService-BGD7Twul.js","assets/age-BJnAeRxZ.js","assets/prefs-BrreBWug.js","assets/Family-D2iuuxP5.js","assets/ProfileSettings-DxlQSgpU.js","assets/PaymentMethods-DVl691nE.js","assets/firebasePaymentMethods-CJsgpCPD.js","assets/Registrations-BvWUold3.js","assets/Seasons-D00Qs252.js","assets/SeasonEditor-B8zJWRm3.js","assets/SeasonDetail-DN_2z39j.js","assets/Programs-DBfJfZWs.js","assets/ProgramDetail-Dr153zvD.js","assets/Register-Bha_xe8Q.js","assets/ProgramTeams-CDOrIUsU.js","assets/AuditLogs-Bo_4C0BF.js","assets/Registration-B4u6KS0k.js","assets/RegistrationConfirmation-CqrocdpW.js","assets/Schedules-C_PxXIJt.js","assets/Settings-DB_0WI0r.js","assets/NotFound-m6TOxyZx.js","assets/Analytics-DtMMZsvr.js","assets/AdminRegistrations-DbO-2bq0.js","assets/AdminPayments-GLK6ZZP0.js","assets/PaymentPlans-BSRexnTx.js","assets/Discounts-BUmUltMv.js","assets/SeasonDiscounts-UTDc2vKu.js","assets/ProgramTemplates-WJK7xiAy.js","assets/EventsView-D3vg8B6l.js","assets/RegistrationsView-CVVa6g8I.js","assets/firebaseRosters-BGWxAYEL.js","assets/RostersView-DxJWF6id.js","assets/AdminPagesView-C5b-k8op.js"])))=>i.map(i=>d[i]);
import{b as Ut}from"./vendor-react-Ck9bq5u-.js";import{O as tt,r as u,u as X,c as rt,N as w,L as st,B as $t,d as Vt,e as g,R as Ft}from"./vendor-router-Ck4ZuSP9.js";import{t as zt,B as T,a as Bt,R as Ee,D as Gt,b as W,c as qt,M as Se,S as re,d as Wt,e as se,T as Ie,f as at,g as nt,h as H,i as Ht,j as Jt,k as Yt,l as Kt,m as Xt,n as Qt,o as Zt,p as er,q as Re,r as Ae,s as tr,u as rr,v as sr,w as ar,L as nr,x as me,y as or,z as ir,A as lr,C as cr,E as dr,F as ge,G as L,H as ot,I as V,J as it,K as de,N as lt,O as ct,P as ur,Q as I,U as mr}from"./vendor-antd-CieyQibU.js";import{c as N,u as Q,a as D,b as gr,d as Z,e as pr,P as hr}from"./vendor-redux-BbD-gcRX.js";import{_ as fr,C as yr,r as Te,a as xr,g as wr,b as vr,c as pe,d as jr,i as dt,p as br,u as _r,F as Er,e as Sr,f as Ir,h as Rr,j as Ar,s as Tr,k as kr,G as Pr,l as Cr,m as Lr,n as R,o as _,q as k,t as G,v as Dr,w as Or,x as ut,y as Nr,z as he,A as Mr,B as Ur,D as $r}from"./vendor-firebase-BzUsRx-X.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function s(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(n){if(n.ep)return;n.ep=!0;const o=s(n);fetch(n.href,o)}})();var r=Ut();const Vr="type.googleapis.com/google.protobuf.Int64Value",Fr="type.googleapis.com/google.protobuf.UInt64Value";function mt(e,t){const s={};for(const a in e)e.hasOwnProperty(a)&&(s[a]=t(e[a]));return s}function J(e){if(e==null)return null;if(e instanceof Number&&(e=e.valueOf()),typeof e=="number"&&isFinite(e)||e===!0||e===!1||Object.prototype.toString.call(e)==="[object String]")return e;if(e instanceof Date)return e.toISOString();if(Array.isArray(e))return e.map(t=>J(t));if(typeof e=="function"||typeof e=="object")return mt(e,t=>J(t));throw new Error("Data cannot be encoded in JSON: "+e)}function F(e){if(e==null)return e;if(e["@type"])switch(e["@type"]){case Vr:case Fr:{const t=Number(e.value);if(isNaN(t))throw new Error("Data cannot be decoded from JSON: "+e);return t}default:throw new Error("Data cannot be decoded from JSON: "+e)}return Array.isArray(e)?e.map(t=>F(t)):typeof e=="function"||typeof e=="object"?mt(e,t=>F(t)):e}const fe="functions";const ke={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class A extends Er{constructor(t,s,a){super(`${fe}/${t}`,s||""),this.details=a,Object.setPrototypeOf(this,A.prototype)}}function zr(e){if(e>=200&&e<300)return"ok";switch(e){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function Y(e,t){let s=zr(e),a=s,n;try{const o=t&&t.error;if(o){const i=o.status;if(typeof i=="string"){if(!ke[i])return new A("internal","internal");s=ke[i],a=i}const l=o.message;typeof l=="string"&&(a=l),n=o.details,n!==void 0&&(n=F(n))}}catch{}return s==="ok"?null:new A(s,a,n)}class Br{constructor(t,s,a,n){this.app=t,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,xr(t)&&t.settings.appCheckToken&&(this.serverAppAppCheckToken=t.settings.appCheckToken),this.auth=s.getImmediate({optional:!0}),this.messaging=a.getImmediate({optional:!0}),this.auth||s.get().then(o=>this.auth=o,()=>{}),this.messaging||a.get().then(o=>this.messaging=o,()=>{}),this.appCheck||n?.get().then(o=>this.appCheck=o,()=>{})}async getAuthToken(){if(this.auth)try{return(await this.auth.getToken())?.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(t){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const s=t?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return s.error?null:s.token}return null}async getContext(t){const s=await this.getAuthToken(),a=await this.getMessagingToken(),n=await this.getAppCheckToken(t);return{authToken:s,messagingToken:a,appCheckToken:n}}}const ue="us-central1",Gr=/^data: (.*?)(?:\n|$)/;function qr(e){let t=null;return{promise:new Promise((s,a)=>{t=setTimeout(()=>{a(new A("deadline-exceeded","deadline-exceeded"))},e)}),cancel:()=>{t&&clearTimeout(t)}}}class Wr{constructor(t,s,a,n,o=ue,i=(...l)=>fetch(...l)){this.app=t,this.fetchImpl=i,this.emulatorOrigin=null,this.contextProvider=new Br(t,s,a,n),this.cancelAllRequests=new Promise(l=>{this.deleteService=()=>Promise.resolve(l())});try{const l=new URL(o);this.customDomain=l.origin+(l.pathname==="/"?"":l.pathname),this.region=ue}catch{this.customDomain=null,this.region=o}}_delete(){return this.deleteService()}_url(t){const s=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${s}/${this.region}/${t}`:this.customDomain!==null?`${this.customDomain}/${t}`:`https://${this.region}-${s}.cloudfunctions.net/${t}`}}function Hr(e,t,s){const a=dt(t);e.emulatorOrigin=`http${a?"s":""}://${t}:${s}`,a&&(br(e.emulatorOrigin+"/backends"),_r("Functions",!0))}function Jr(e,t,s){const a=n=>Kr(e,t,n,{});return a.stream=(n,o)=>Qr(e,t,n,o),a}function gt(e){return e.emulatorOrigin&&dt(e.emulatorOrigin)?"include":void 0}async function Yr(e,t,s,a,n){s["Content-Type"]="application/json";let o;try{o=await a(e,{method:"POST",body:JSON.stringify(t),headers:s,credentials:gt(n)})}catch{return{status:0,json:null}}let i=null;try{i=await o.json()}catch{}return{status:o.status,json:i}}async function pt(e,t){const s={},a=await e.contextProvider.getContext(t.limitedUseAppCheckTokens);return a.authToken&&(s.Authorization="Bearer "+a.authToken),a.messagingToken&&(s["Firebase-Instance-ID-Token"]=a.messagingToken),a.appCheckToken!==null&&(s["X-Firebase-AppCheck"]=a.appCheckToken),s}function Kr(e,t,s,a){const n=e._url(t);return Xr(e,n,s,a)}async function Xr(e,t,s,a){s=J(s);const n={data:s},o=await pt(e,a),i=a.timeout||7e4,l=qr(i),c=await Promise.race([Yr(t,n,o,e.fetchImpl,e),l.promise,e.cancelAllRequests]);if(l.cancel(),!c)throw new A("cancelled","Firebase Functions instance was deleted.");const d=Y(c.status,c.json);if(d)throw d;if(!c.json)throw new A("internal","Response is not valid JSON object.");let h=c.json.data;if(typeof h>"u"&&(h=c.json.result),typeof h>"u")throw new A("internal","Response is missing data field.");return{data:F(h)}}function Qr(e,t,s,a){const n=e._url(t);return Zr(e,n,s,a||{})}async function Zr(e,t,s,a){s=J(s);const n={data:s},o=await pt(e,a);o["Content-Type"]="application/json",o.Accept="text/event-stream";let i;try{i=await e.fetchImpl(t,{method:"POST",body:JSON.stringify(n),headers:o,signal:a?.signal,credentials:gt(e)})}catch(p){if(p instanceof Error&&p.name==="AbortError"){const j=new A("cancelled","Request was cancelled.");return{data:Promise.reject(j),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(j)}}}}}}const f=Y(0,null);return{data:Promise.reject(f),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(f)}}}}}}let l,c;const d=new Promise((p,f)=>{l=p,c=f});a?.signal?.addEventListener("abort",()=>{const p=new A("cancelled","Request was cancelled.");c(p)});const h=i.body.getReader(),x=es(h,l,c,a?.signal);return{stream:{[Symbol.asyncIterator](){const p=x.getReader();return{async next(){const{value:f,done:j}=await p.read();return{value:f,done:j}},async return(){return await p.cancel(),{done:!0,value:void 0}}}}},data:d}}function es(e,t,s,a){const n=(i,l)=>{const c=i.match(Gr);if(!c)return;const d=c[1];try{const h=JSON.parse(d);if("result"in h){t(F(h.result));return}if("message"in h){l.enqueue(F(h.message));return}if("error"in h){const x=Y(0,h);l.error(x),s(x);return}}catch(h){if(h instanceof A){l.error(h),s(h);return}}},o=new TextDecoder;return new ReadableStream({start(i){let l="";return c();async function c(){if(a?.aborted){const d=new A("cancelled","Request was cancelled");return i.error(d),s(d),Promise.resolve()}try{const{value:d,done:h}=await e.read();if(h){l.trim()&&n(l.trim(),i),i.close();return}if(a?.aborted){const p=new A("cancelled","Request was cancelled");i.error(p),s(p),await e.cancel();return}l+=o.decode(d,{stream:!0});const x=l.split(`
`);l=x.pop()||"";for(const p of x)p.trim()&&n(p.trim(),i);return c()}catch(d){const h=d instanceof A?d:Y(0,null);i.error(h),s(h)}}},cancel(){return e.cancel()}})}const Pe="@firebase/functions",Ce="0.13.1";const ts="auth-internal",rs="app-check-internal",ss="messaging-internal";function as(e){const t=(s,{instanceIdentifier:a})=>{const n=s.getProvider("app").getImmediate(),o=s.getProvider(ts),i=s.getProvider(ss),l=s.getProvider(rs);return new Wr(n,o,i,l,a)};fr(new yr(fe,t,"PUBLIC").setMultipleInstances(!0)),Te(Pe,Ce,e),Te(Pe,Ce,"esm2020")}function ns(e=wr(),t=ue){const a=vr(pe(e),fe).getImmediate({identifier:t}),n=jr("functions");return n&&os(a,...n),a}function os(e,t,s){Hr(pe(e),t,s)}function rn(e,t,s){return Jr(pe(e),t)}as();const ht={apiKey:"AIzaSyBbqsdCjwkUvtWlN8y2Lfn0GPBVpLfVL6s",authDomain:"wgys-ls.firebaseapp.com",projectId:"wgys-ls",databaseURL:"https://wgys-ls-default-rtdb.firebaseio.com",storageBucket:"wgys-ls.firebasestorage.app",messagingSenderId:"115058670356",appId:"1:115058670356:web:f4e216241b8b534b74e001"},is=["apiKey","authDomain","projectId","databaseURL","storageBucket","messagingSenderId","appId"],ae=is.filter(e=>!ht[e]);ae.length>0&&(console.error("âŒ Missing Firebase credentials:",ae),console.error("ðŸ“ Add these to your .env.local file:"),ae.forEach(e=>{console.error(` VITE_FIREBASE_${e.toUpperCase()}=your_value`)}));const ee=Sr(ht),O=Ir(ee),b=Rr(ee),ls=Ar(ee),cs=ns(ee);Tr(O,kr).catch(e=>{const t=(e?.code||"Unknown error").replace(/[\r\n]/g,"");console.error("Failed to set persistence:",t)});const sn=Object.freeze(Object.defineProperty({__proto__:null,auth:O,db:b,functions:cs,storage:ls},Symbol.toStringTag,{value:"Module"})),ds={user:null,isAuthenticated:!1,loading:!0,error:null,role:"user",memberSinceYear:null},ft=N({name:"auth",initialState:ds,reducers:{setUser:(e,t)=>{t.payload.user?(e.user={uid:t.payload.user.uid,email:t.payload.user.email,displayName:t.payload.user.displayName,photoURL:t.payload.user.photoURL,createdAt:t.payload.createdAt},e.isAuthenticated=!0,e.memberSinceYear=t.payload.createdAt?new Date(t.payload.createdAt).getFullYear():null):(e.user=null,e.isAuthenticated=!1,e.memberSinceYear=null),e.role=t.payload.role||"user",e.loading=!1},logout:e=>{e.user=null,e.isAuthenticated=!1,e.role="user",e.memberSinceYear=null,e.loading=!1},setLoading:(e,t)=>{e.loading=t.payload},setError:(e,t)=>{e.error=t.payload}}}),{setUser:$,logout:us,setLoading:ms,setError:an}=ft.actions,gs=ft.reducer,{darkAlgorithm:ps,defaultAlgorithm:hs}=zt,K={token:{colorPrimary:"#1890ff",borderRadius:8,borderRadiusLG:12,borderRadiusSM:6,fontSize:14,fontSizeLG:16,fontSizeSM:12,fontFamily:'system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',padding:16,paddingLG:24,paddingSM:8,paddingXS:4,motionDurationSlow:"0.3s",motionDurationMid:"0.2s",motionDurationFast:"0.1s"},components:{Layout:{headerHeight:64},Menu:{itemBorderRadius:8,itemMarginBlock:4,itemMarginInline:16},Card:{headerBg:"transparent"},Button:{borderRadius:8},Input:{borderRadius:8},Table:{borderRadius:8}}},fs={...K,algorithm:ps,token:{...K.token,colorPrimary:"#1890ff"}},ys={...K,algorithm:hs,token:{...K.token,colorPrimary:"#1890ff"}},xs="modulepreload",ws=function(e){return"/"+e},Le={},y=function(t,s,a){let n=Promise.resolve();if(s&&s.length>0){let c=function(d){return Promise.all(d.map(h=>Promise.resolve(h).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),l=i?.nonce||i?.getAttribute("nonce");n=c(s.map(d=>{if(d=ws(d),d in Le)return;Le[d]=!0;const h=d.endsWith(".css"),x=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${x}`))return;const p=document.createElement("link");if(p.rel=h?"stylesheet":xs,h||(p.as="script"),p.crossOrigin="",p.href=d,l&&p.setAttribute("nonce",l),document.head.appendChild(p),h)return new Promise((f,j)=>{p.addEventListener("load",f),p.addEventListener("error",()=>j(new Error(`Unable to preload CSS for ${d}`)))})}))}function o(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return n.then(i=>{for(const l of i||[])l.status==="rejected"&&o(l.reason);return t().catch(o)})};function vs(...e){try{if((typeof localStorage<"u"?localStorage.getItem("wgys.debugLogging"):null)!=="1")return;console&&console.error&&console.error(...e)}catch{}}function js(...e){try{if((typeof localStorage<"u"?localStorage.getItem("wgys.infoLogging"):null)!=="1")return;console&&console.info?console.info(...e):console&&console.log&&console.log(...e)}catch{}}const m={error:vs,info:js};var bs={VITE_FIREBASE_API_KEY:"AIzaSyBbqsdCjwkUvtWlN8y2Lfn0GPBVpLfVL6s",VITE_FIREBASE_AUTH_DOMAIN:"wgys-ls.firebaseapp.com",VITE_FIREBASE_DATABASE_URL:"https://wgys-ls-default-rtdb.firebaseio.com",VITE_FIREBASE_PROJECT_ID:"wgys-ls",VITE_FIREBASE_STORAGE_BUCKET:"wgys-ls.firebasestorage.app",VITE_FIREBASE_MESSAGING_SENDER_ID:"115058670356",VITE_FIREBASE_APP_ID:"1:115058670356:web:f4e216241b8b534b74e001",VITE_FIREBASE_MEASUREMENT_ID:"G-CK303BGJZG",VITE_FIREBASE_GA4_PROPERTY_ID:"514640984",VITE_METRICS_URL:"https://metricsviews-k5dtqbkowq-uc.a.run.app",VITE_STRIPE_PUBLISHABLE_KEY:"pk_test_51SgMi5RRcLrgksKktRKy3R8g1Yq2kqXuyReFggphxCbAelY93pGI7EhbKtWQYV1Aua94iinJLNdIxxINHZgrbwzC005HqJJNLp",VITE_GA4_API_SECRET:"VGj-Csa0SO-9kX0_BQ64hA"},De={};function B(e){try{if(typeof process<"u"&&De[e])return De[e]}catch{}try{const t=bs||globalThis.__vite_env__;if(t&&t[e])return t[e]}catch(t){m.error("Error accessing process.env for",e,t)}}let Oe=!1;function _s(e){if(Oe||!e)return;window.dataLayer=window.dataLayer||[];function t(...a){window.dataLayer?.push(a)}window.gtag=t,t("js",new Date),t("config",e,{send_page_view:!1,debug_mode:!0,transport_type:"beacon"});const s=document.createElement("script");s.async=!0,s.src=`https://www.googletagmanager.com/gtag/js?id=${e}`,s.onload=()=>{m.info("[ga] gtag script loaded successfully"),m.info("[ga] window.gtag is now:",typeof window.gtag),m.info("[ga] dataLayer after script load:",window.dataLayer)},s.onerror=a=>{m.error("[ga] Failed to load gtag script - likely blocked by ad blocker or privacy settings",a)},document.head.appendChild(s),m.info("[ga] gtag script element created and appended"),Oe=!0}function Es(){const e=B("VITE_FIREBASE_MEASUREMENT_ID");m.info("[ga] resolved measurementId",e),e&&(_s(e),m.info("[ga] gtag initialization started"),B("VITE_ENV")!=="production"&&setTimeout(()=>{window.gtag?window.gtag("event","app_initialized",{debug_mode:!0}):m.info("[ga] window.gtag not available after 1 second")},1e3))}function Ss(e){if(!window.gtag)return;m.info("[ga] trackPageView",e.page_path),window.gtag("event","page_view",e),B("VITE_GA4_API_SECRET")&&Ps(e)}function Is(){return document.cookie.match(/_ga=GA\d\.\d\.(\d+\.\d+)/)?.[1]}const Rs=1800*1e3,Ne="ga_session_id",Me="ga_session_number",Ue="ga_session_start",$e="ga_last_event_ts";function yt(){return Date.now()}function As(){const e=yt(),t=localStorage.getItem(Ne),s=Number(localStorage.getItem(Ue)||"0");let a=t?Number(t):0,n=s,o=Number(localStorage.getItem(Me)||"0"),i=!1;return(!a||!n||e-n>Rs)&&(a=Math.floor(e/1e3),n=e,o=o+1||1,localStorage.setItem(Ne,String(a)),localStorage.setItem(Me,String(o)),localStorage.setItem(Ue,String(n)),i=!0),{sessionId:a,sessionNumber:o,sessionStart:n,isNew:i}}function Ts(){const e=yt(),t=Number(localStorage.getItem($e)||"0");let s=t?e-t:0;return(!s||s<100)&&(s=100),s>6e4&&(s=6e4),localStorage.setItem($e,String(e)),s}async function ks(e,t,s,a){const{sessionId:n,sessionNumber:o,isNew:i}=As(),l=Is()||`${Math.floor(Math.random()*1e10)}.${Date.now()}`,c=Ts(),d={...a,session_id:n,session_number:o,engagement_time_msec:c},h=[];i&&h.push({name:"session_start",params:{session_id:n,session_number:o}}),h.push({name:s,params:d});const x={client_id:l,non_personalized_ads:!1,events:h},p=`https://www.google-analytics.com/mp/collect?measurement_id=${encodeURIComponent(e)}&api_secret=${encodeURIComponent(t)}`;if(navigator.sendBeacon){const f=navigator.sendBeacon(p,JSON.stringify(x));m.info("[ga][mp] sendBeacon:",f?"queued":"failed")}else try{const f=await fetch(p,{method:"POST",body:JSON.stringify(x)});m.info("[ga][mp] fetch status:",f.status)}catch(f){m.info("[ga][mp] fetch failed",f)}}async function Ps(e){const t=B("VITE_FIREBASE_MEASUREMENT_ID"),s=B("VITE_GA4_API_SECRET");!t||!s||await ks(t,s,"page_view",e)}function Cs(e){window.gtag&&window.gtag("set","user_properties",e)}function Ls(){return r.jsx("div",{className:"auth-layout",children:r.jsx(tt,{})})}const Ds={isDarkMode:!0},xt=N({name:"theme",initialState:Ds,reducers:{toggleTheme:e=>{e.isDarkMode=!e.isDarkMode},setTheme:(e,t)=>{e.isDarkMode=t.payload}}}),{toggleTheme:nn,setTheme:wt}=xt.actions,Os=xt.reducer,Ns=new Pr,Ms=async(e,t,s)=>{try{const n=(await Dr(O,e,t)).user;await Or(n,{displayName:s}),await n.reload(),await k(_(b,`users/${n.uid}`),{uid:n.uid,email:e,displayName:s,role:"user",createdAt:new Date().toISOString()});const o=s.split(" "),i=_(b,"people"),l=G(i);return await k(l,{firstName:o[0]||s,lastName:o.slice(1).join(" ")||"",email:e,userId:n.uid,hasAccount:!0,roles:[],source:"signup",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),createdBy:n.uid,isActive:!0}),n}catch(a){throw new Error(a.message||"Failed to sign up")}},Us=async(e,t)=>{try{return await Cr(O,e,t)}catch(s){throw new Error(s.message||"Failed to sign in")}},vt=async()=>{try{const t=(await Lr(O,Ns)).user;if(!(await R(_(b,`users/${t.uid}`))).exists()){await k(_(b,`users/${t.uid}`),{uid:t.uid,email:t.email,displayName:t.displayName||"User",photoURL:t.photoURL||null,role:"user",createdAt:new Date().toISOString()});const a=t.displayName||"User",n=a.split(" "),o=_(b,"people"),i=G(o);await k(i,{firstName:n[0]||a,lastName:n.slice(1).join(" ")||"",email:t.email,photoURL:t.photoURL||null,userId:t.uid,hasAccount:!0,roles:[],source:"signup",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),createdBy:t.uid,isActive:!0})}return t}catch(e){throw new Error(e.message||"Failed to sign in with Google")}},$s=async()=>{try{await O.signOut()}catch(e){throw new Error(e.message||"Failed to sign out")}},Vs="/assets/wgys-C3fSYLlJ.webp",Fs=u.lazy(()=>y(()=>import("./RegistrationHelp-sSbIHfqD.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8])));function zs(){const e=Q(),t=X(),s=D(v=>v.auth.user),a=D(v=>v.auth.role),n=D(v=>v.theme.isDarkMode),o=D(v=>v.cart?.items?.length||0),[i,l]=u.useState(!1),[c,d]=u.useState(null),h=async()=>{try{await $s(),e(us()),t("/signin")}catch(v){m.error("Sign out failed:",v)}},x=[{key:"profile",icon:r.jsx(W,{}),label:"My Profile",onClick:()=>t("/profile")},{key:"family",icon:r.jsx(nt,{}),label:"My Family",onClick:()=>t("/my-family")},{key:"payment-methods",icon:r.jsx(Ee,{}),label:"My Payment Methods",onClick:()=>t("/payment-methods")},{key:"my-registrations",icon:r.jsx(H,{}),label:"My Registrations",onClick:()=>t("/my-registrations")},{key:"registration-help",icon:r.jsx(H,{}),label:"Registration Help",onClick:()=>t("/registration-help")},{key:"theme",icon:r.jsx(Ht,{}),label:n?"Light Mode":"Dark Mode",onClick:async()=>{const v=n?"light":"dark";e(wt(!n));try{if(s?.uid){const C=_(b,`users/${s.uid}/preferences`);await ut(C,{theme:v})}}catch(C){m.error("Failed to persist theme preference to RTDB",C)}try{localStorage.setItem("wgys.pref.theme",v),localStorage.setItem("wgys.theme",v)}catch(C){m.error("Failed to cache theme preference locally",C)}}},{type:"divider"},{key:"signout",icon:r.jsx(Jt,{}),label:"Sign Out",onClick:h}],[p,f]=u.useState(!1),[j,S]=u.useState("iphone-12"),[P,Ot]=u.useState("portrait"),te={"iphone-se":{label:"iPhone SE",w:375,h:667},"iphone-12":{label:"iPhone 12/13",w:390,h:844},"pixel-4":{label:"Pixel 4",w:393,h:851},ipad:{label:"iPad Mini",w:768,h:1024}},ve=typeof window<"u"?window.location.href:"/",[Nt,je]=u.useState(!1),Mt=()=>f(!0),be=()=>f(!1);return u.useEffect(()=>{let v=!0;return i&&!c&&y(()=>import("./CartDrawer-BABbjCy8.js"),__vite__mapDeps([9,8,1,2,10,5,11,12,13,6,14,15,16,3])).then(C=>{v&&d(()=>C.default)}).catch(C=>{m.error("Failed to load CartDrawer",C)}),()=>{v=!1}},[i,c]),r.jsx("header",{className:"header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("div",{className:"header-left",style:{display:"flex",alignItems:"center",gap:"12px"},children:r.jsx("img",{src:Vs,alt:"West Georgia Youth Sports, Inc.",style:{height:"40px",width:"auto",cursor:"pointer"},role:"button",tabIndex:0,onClick:()=>t("/"),onKeyDown:v=>{(v.key==="Enter"||v.key===" ")&&t("/")}})}),r.jsxs("div",{className:"header-right",style:{display:"flex",alignItems:"center",gap:12},children:[r.jsx(T,{type:"text",onClick:()=>l(!0),style:{fontSize:14},children:r.jsx(Bt,{count:o,offset:[0,0],children:r.jsx(Ee,{style:{fontSize:18}})})}),r.jsx(Gt,{menu:{items:x},trigger:["click"],placement:"bottomRight",children:r.jsxs(T,{type:"text",className:"user-profile-btn",style:{fontSize:"12px",fontWeight:400,opacity:.8,display:"flex",alignItems:"center",gap:"4px"},children:[r.jsx(W,{}),s?.email?.split("@")[0]||"User",r.jsx(qt,{style:{fontSize:"10px"}})]})}),(a==="admin"||a==="owner")&&r.jsx(T,{type:"text",onClick:Mt,style:{fontSize:12,marginLeft:8},children:"Mobile Preview"}),r.jsxs(Se,{title:"Mobile Preview",open:p,onCancel:be,footer:null,width:900,style:{display:"flex",flexDirection:"column",gap:12},children:[r.jsxs(re,{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs(re,{children:[r.jsx(Wt,{value:j,onChange:v=>S(v),options:Object.keys(te).map(v=>({value:v,label:te[v].label}))}),r.jsxs(se.Group,{value:P,onChange:v=>Ot(v.target.value),children:[r.jsx(se.Button,{value:"portrait",children:"Portrait"}),r.jsx(se.Button,{value:"landscape",children:"Landscape"})]})]}),r.jsxs(re,{children:[r.jsx(Ie,{title:"Open preview in a new window",children:r.jsx(T,{type:"default",onClick:()=>window.open(ve,"_blank"),children:"Open"})}),r.jsx(T,{type:"primary",onClick:be,children:"Close"})]})]}),r.jsx("div",{style:{display:"flex",justifyContent:"center"},children:(()=>{const v=te[j],C=P==="portrait"?v.w:v.h,_e=P==="portrait"?v.h:v.w;return r.jsx("div",{className:"mobile-preview-frame",style:{width:C+20,height:_e+60},children:r.jsx("iframe",{title:"Mobile preview",src:ve,style:{width:C,height:_e,border:"1px solid #ddd",borderRadius:12,boxShadow:"0 8px 24px rgba(0,0,0,0.12)"}})})})()})]}),r.jsx(Ie,{title:"Registration Help",children:r.jsx(T,{type:"text",onClick:()=>je(!0),style:{fontSize:14},children:r.jsx(at,{style:{fontSize:18}})})}),r.jsx(Se,{title:"Registration Help",open:Nt,onCancel:()=>je(!1),footer:null,width:700,children:r.jsx(u.Suspense,{fallback:r.jsx("div",{style:{padding:24},children:"Loading help..."}),children:r.jsx(Fs,{compact:!0})})})]}),i&&(c?r.jsx(c,{open:i,onClose:()=>l(!1)}):r.jsx("div",{style:{padding:16},children:"Loading cart..."}))]})})}const Ve=[{key:"/admin/dashboard",label:"Dashboard",icon:r.jsx(Yt,{})},{key:"/admin/seasons",label:"Seasons",icon:r.jsx(Kt,{})},{key:"/admin/sports",label:"Sports",icon:r.jsx(Xt,{})},{key:"/admin/program-templates",label:"Program Templates",icon:r.jsx(H,{})},{key:"/admin/programs",label:"Programs",icon:r.jsx(Qt,{})},{key:"/admin/teams",label:"Teams",icon:r.jsx(nt,{})},{key:"/admin/people",label:"People",icon:r.jsx(Zt,{})},{key:"/admin/settings",label:"Settings",icon:r.jsx(er,{})},{key:"/admin/payment-plans",label:"Payment Plans",icon:r.jsx(Re,{})},{key:"/admin/discounts",label:"Discounts",icon:r.jsx(Ae,{})},{key:"/profile",label:"My Profile",icon:r.jsx(W,{})},{key:"/my-family",label:"My Family",icon:r.jsx(Ae,{})},{key:"/payment-methods",label:"My Payment Methods",icon:r.jsx(Re,{})},{key:"/my-registrations",label:"My Registrations",icon:r.jsx(H,{})},{key:"/register",label:"Register",icon:r.jsx(tr,{})},{key:"/registration-help",label:"Registration Help",icon:r.jsx(at,{})},{key:"/announcements",label:"Announcements",icon:r.jsx(rr,{})},{key:"/schedules",label:"Schedules",icon:r.jsx(sr,{})},{key:"/admin/audit",label:"Audit Logs",icon:r.jsx(ar,{})}],Bs=e=>e.auth.role,Gs=new Set(["/profile","/my-family","/payment-methods","/my-registrations","/register","/registration-help","/announcements","/schedules"]),qs=new Set(["/admin/dashboard","/admin/seasons","/admin/discounts","/admin/sports","/admin/program-templates","/admin/audit","/admin/programs","/admin/teams","/admin/people","/admin/settings","/admin/payment-plans"]),Ws=e=>e.ui.showMyMenuItems,Hs=gr([Bs,Ws],(e,t)=>{const s=e==="admin"||e==="owner",a=Ve.filter(o=>Gs.has(o.key)).filter(o=>t?!0:!(typeof o.label=="string"&&o.label.startsWith("My "))).map(o=>({key:o.key,icon:o.icon,label:o.label})),n=Ve.filter(o=>qs.has(o.key)).map(o=>({key:o.key,icon:o.icon,label:o.label}));return[...a,...s?[{key:"divider",type:"divider"},...n]:[]]}),ye="/assets/wgys-logo-small-C4uYKZeZ.png",Js="/assets/wgys-logo-FoBeL3_t.png",{Sider:Ys}=nr,{Title:on}=me;function Ks({onCollapse:e}){const[t,s]=u.useState(!1),[a,n]=u.useState(!1),o=rt(),i=X(),l=D(Hs);u.useEffect(()=>{document.documentElement.style.setProperty("--sidebar-width",t?"48px":"200px"),document.documentElement.style.setProperty("--sidebar-collapsed-width","48px")},[t]);const c=({key:d})=>{i(d),n(!1)};return r.jsxs(r.Fragment,{children:[r.jsx(T,{className:"sidebar-mobile-toggle",type:"text",icon:r.jsx(or,{}),onClick:()=>{n(!0)},style:{position:"fixed",top:16,left:16,zIndex:1001,display:"none"}}),a&&r.jsx("div",{className:"sidebar-overlay",onClick:()=>{n(!1)},style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.5)",zIndex:999,display:"none"}}),r.jsxs(Ys,{width:"auto",collapsedWidth:48,collapsed:t,className:`custom-sidebar ${a?"mobile-open":""}`,style:{position:"fixed",left:0,top:0,height:"100vh",zIndex:1e3,minWidth:t?"48px":"auto"},children:[r.jsxs("div",{className:"sidebar-header",style:{padding:"24px",display:"flex",justifyContent:t?"center":"space-between",alignItems:"center"},children:[r.jsx("img",{src:t?ye:Js,alt:"WGYS Logo",style:{height:t?"24px":"94px",width:"auto",cursor:"pointer"},role:"button",tabIndex:0,onClick:()=>i("/"),onKeyDown:d=>{(d.key==="Enter"||d.key===" ")&&i("/")}}),r.jsxs("div",{style:{display:"flex",gap:"8px"},children:[r.jsx(T,{type:"text",icon:t?r.jsx(ir,{}):r.jsx(lr,{}),onClick:()=>{const d=!t;s(d),e?.(d)},style:{fontSize:"16px"}}),r.jsx(T,{className:"sidebar-mobile-close",type:"text",icon:r.jsx(cr,{}),onClick:()=>{n(!1)},style:{display:"none"}})]})]}),r.jsx(dr,{mode:"inline",selectedKeys:[o.pathname],onClick:c,items:l,style:{border:"none",flex:1,paddingTop:"24px"}})]})]})}function Xs(){const[e,t]=u.useState(!1);return r.jsxs("div",{className:"main-layout",children:[r.jsx(Ks,{onCollapse:t}),r.jsxs("div",{className:`main-content ${e?"collapsed":""}`,children:[r.jsx(zs,{}),r.jsx("main",{className:"page-content",children:r.jsx(tt,{})})]})]})}function E({isAuthenticated:e,requiredRole:t,children:s}){const{role:a}=D(n=>n.auth);if(!e)return r.jsx(w,{to:"/signin",replace:!0});if(t){if(t==="admin"&&a!=="admin"&&a!=="owner")return r.jsx(w,{to:"/admin/dashboard",replace:!0});if(t!=="admin"&&a!==t)return r.jsx(w,{to:"/admin/dashboard",replace:!0})}return r.jsx(r.Fragment,{children:s})}const{Title:Qs,Text:Fe}=me;function Zs(){const{message:e}=ge.useApp(),[t,s]=u.useState(!1),a=X(),n=Q(),[o]=L.useForm(),i=async c=>{s(!0);try{const d=await Us(c.email,c.password);n($({user:d.user})),a("/admin/dashboard")}catch(d){e.error({content:d.message||"Failed to sign in"})}finally{s(!1)}},l=async()=>{s(!0);try{const c=await vt();n($({user:c})),a("/admin/dashboard")}catch(c){e.error({content:c.message||"Failed to sign in with Google"})}finally{s(!1)}};return r.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"},children:r.jsxs(ot,{style:{width:400,maxWidth:"100%"},variant:"borderless",children:[r.jsxs("div",{style:{textAlign:"center",marginBottom:32},children:[r.jsx("img",{src:ye,alt:"WGYS Logo",style:{width:80,height:80,marginBottom:16}}),r.jsx(Qs,{level:2,style:{margin:0,fontFamily:'Impact, "Arial Black", sans-serif',fontWeight:900,letterSpacing:"1px"},children:"WEST GEORGIA YOUTH SPORTS, INC."}),r.jsx(Fe,{type:"secondary",children:"Sign in to your account"})]}),r.jsxs(L,{form:o,onFinish:i,layout:"vertical",size:"large",children:[r.jsx(L.Item,{name:"email",rules:[{required:!0,message:"Please enter your email"},{type:"email",message:"Please enter a valid email"}],children:r.jsx(V,{prefix:r.jsx(it,{}),placeholder:"Email address",disabled:t})}),r.jsx(L.Item,{name:"password",rules:[{required:!0,message:"Please enter your password"}],children:r.jsx(V.Password,{prefix:r.jsx(de,{}),placeholder:"Password",disabled:t,autoComplete:"current-password"})}),r.jsx(L.Item,{children:r.jsx(T,{type:"primary",htmlType:"submit",block:!0,loading:t,children:"Sign In"})})]}),r.jsx(lt,{children:"OR"}),r.jsx(T,{icon:r.jsx(ct,{}),onClick:l,block:!0,loading:t,children:"Sign in with Google"}),r.jsx("div",{style:{textAlign:"center",marginTop:24},children:r.jsxs(Fe,{type:"secondary",children:["Don't have an account? ",r.jsx(st,{to:"/signup",children:"Sign up"})]})})]})})}const{Title:ze,Text:Be}=me;function ea(){const{message:e}=ge.useApp(),[t,s]=u.useState(!1),a=X(),n=Q(),[o]=L.useForm(),i=async c=>{s(!0);try{const d=await Ms(c.email,c.password,c.displayName);n($({user:d})),a("/admin/dashboard")}catch(d){e.error({content:d.message||"Failed to create account"})}finally{s(!1)}},l=async()=>{s(!0);try{const c=await vt();n($({user:c})),a("/admin/dashboard")}catch(c){e.error({content:c.message||"Failed to sign up with Google"})}finally{s(!1)}};return r.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"},children:r.jsxs(ot,{style:{width:400,maxWidth:"100%"},variant:"borderless",children:[r.jsxs("div",{style:{textAlign:"center",marginBottom:32},children:[r.jsx("img",{src:ye,alt:"WGYS Logo",style:{width:80,height:80,marginBottom:16}}),r.jsx(ze,{level:2,style:{margin:0,fontFamily:'Impact, "Arial Black", sans-serif',fontWeight:900,letterSpacing:"1px"},children:"WEST GEORGIA YOUTH SPORTS, INC."}),r.jsx(ze,{level:3,style:{margin:"8px 0 0 0"},children:"Create Account"}),r.jsx(Be,{type:"secondary",children:"Join West Georgia Youth Sports"})]}),r.jsxs(L,{form:o,onFinish:i,layout:"vertical",size:"large",children:[r.jsx(L.Item,{name:"displayName",rules:[{required:!0,message:"Please enter your full name"}],children:r.jsx(V,{prefix:r.jsx(W,{}),placeholder:"Full name",disabled:t})}),r.jsx(L.Item,{name:"email",rules:[{required:!0,message:"Please enter your email"},{type:"email",message:"Please enter a valid email"}],children:r.jsx(V,{prefix:r.jsx(it,{}),placeholder:"Email address",disabled:t})}),r.jsx(L.Item,{name:"password",rules:[{required:!0,message:"Please enter your password"},{min:6,message:"Password must be at least 6 characters"}],children:r.jsx(V.Password,{prefix:r.jsx(de,{}),placeholder:"Password",disabled:t,autoComplete:"new-password"})}),r.jsx(L.Item,{name:"confirmPassword",dependencies:["password"],rules:[{required:!0,message:"Please confirm your password"},({getFieldValue:c})=>({validator(d,h){return!h||c("password")===h?Promise.resolve():Promise.reject(new Error("Passwords do not match"))}})],children:r.jsx(V.Password,{prefix:r.jsx(de,{}),placeholder:"Confirm password",disabled:t,autoComplete:"new-password"})}),r.jsx(L.Item,{children:r.jsx(T,{type:"primary",htmlType:"submit",block:!0,loading:t,children:"Create Account"})})]}),r.jsx(lt,{children:"OR"}),r.jsx(T,{icon:r.jsx(ct,{}),onClick:l,block:!0,loading:t,children:"Sign up with Google"}),r.jsx("div",{style:{textAlign:"center",marginTop:24},children:r.jsxs(Be,{type:"secondary",children:["Already have an account? ",r.jsx(st,{to:"/signin",children:"Sign in"})]})})]})})}const Ge=u.lazy(()=>y(()=>import("./Dashboard-BLMhr33r.js"),__vite__mapDeps([17,1,2,8,3,14,5,18,13,6,12,19,10,20]))),ta=u.lazy(()=>y(()=>import("./Teams-BRgmp5F7.js"),__vite__mapDeps([21,1,2,8,22,3,14,5,13,6,11,12]))),ra=u.lazy(()=>y(()=>import("./Sports-BWmRkura.js"),__vite__mapDeps([23,1,2,22,3,4,5,6,8]))),sa=u.lazy(()=>y(()=>import("./TeamChat-CsGqatTB.js"),__vite__mapDeps([24,1,2,8,5,3,14]))),aa=u.lazy(()=>y(()=>import("./Admin-DhuFp7ik.js"),__vite__mapDeps([25,2,1,3,8,5]))),na=u.lazy(()=>y(()=>import("./Announcements-BCKFIzl-.js"),__vite__mapDeps([26,1,2,8,19,5,3,22,27]))),oa=u.lazy(()=>y(()=>import("./People-oHNuwdLB.js"),__vite__mapDeps([28,1,2,8,5,29,30,31,3,32,33,34,22]))),ia=u.lazy(()=>y(()=>import("./Family-D2iuuxP5.js"),__vite__mapDeps([35,1,2,8,30,5,32,3,29,33]))),la=u.lazy(()=>y(()=>import("./ProfileSettings-DxlQSgpU.js"),__vite__mapDeps([36,1,2,8,30,5,3]))),ca=u.lazy(()=>y(()=>import("./PaymentMethods-DVl691nE.js"),__vite__mapDeps([37,1,2,8,38,5,3]))),da=u.lazy(()=>y(()=>import("./Registrations-BvWUold3.js"),__vite__mapDeps([39,1,2,8,30,5,10,14,13,6,3]))),ua=u.lazy(()=>y(()=>import("./Seasons-D00Qs252.js"),__vite__mapDeps([40,1,2,5,8,22,3,11,12,13,6,14,41,34]))),ma=u.lazy(()=>y(()=>import("./SeasonDetail-DN_2z39j.js"),__vite__mapDeps([42,1,2,11,5,12,13,6,14,8,41,3]))),ga=u.lazy(()=>y(()=>import("./Programs-DBfJfZWs.js"),__vite__mapDeps([43,1,2,8,13,5,6,11,12,14,3,7,22]))),qe=u.lazy(()=>y(()=>import("./ProgramDetail-Dr153zvD.js"),__vite__mapDeps([44,1,2,8,13,5,6,11,12,14,10,3,45,32,7]))),pa=u.lazy(()=>y(()=>import("./ProgramTeams-CDOrIUsU.js"),__vite__mapDeps([46,1,2,8,22,3,13,5,6,11,12,14,10]))),ha=u.lazy(()=>y(()=>import("./AuditLogs-Bo_4C0BF.js"),__vite__mapDeps([47,1,2,8,3,22,5]))),fa=u.lazy(()=>y(()=>import("./RegistrationHelp-sSbIHfqD.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]))),We=u.lazy(()=>y(()=>import("./Registration-B4u6KS0k.js"),__vite__mapDeps([48,1,2,8,3,32,5,33,7,4,6,13,10,11,12,14,30,38,45]))),ya=u.lazy(()=>y(()=>import("./RegistrationConfirmation-CqrocdpW.js"),__vite__mapDeps([49,1,2,10,5,13,6,30,38,3,8]))),xa=u.lazy(()=>y(()=>import("./Schedules-C_PxXIJt.js"),__vite__mapDeps([50,2,1,3,8,5]))),wa=u.lazy(()=>y(()=>import("./Settings-DB_0WI0r.js"),__vite__mapDeps([51,2,1,3,8,5]))),va=u.lazy(()=>y(()=>import("./NotFound-m6TOxyZx.js"),__vite__mapDeps([52,2,1,3,8,5]))),ja=u.lazy(()=>y(()=>import("./Analytics-DtMMZsvr.js"),__vite__mapDeps([53,1,2,8,18,3,5]))),ba=u.lazy(()=>y(()=>import("./AdminRegistrations-DbO-2bq0.js"),__vite__mapDeps([54,1,2,8,3,5]))),_a=u.lazy(()=>y(()=>import("./AdminPayments-GLK6ZZP0.js"),__vite__mapDeps([55,1,2,8,13,5,6,3]))),Ea=u.lazy(()=>y(()=>import("./PaymentPlans-BSRexnTx.js"),__vite__mapDeps([56,1,2,22,3,16,5,11,12,13,6,14,8]))),Sa=u.lazy(()=>y(()=>import("./Discounts-BUmUltMv.js"),__vite__mapDeps([57,1,2,15,5,11,12,13,6,14,22,3,8]))),Ia=u.lazy(()=>y(()=>import("./SeasonDiscounts-UTDc2vKu.js"),__vite__mapDeps([58,1,2,22,3,11,5,12,13,6,14,15,8]))),Ra=u.lazy(()=>y(()=>import("./ProgramTemplates-WJK7xiAy.js"),__vite__mapDeps([59,1,2,8,13,5,6,11,12,14,4,3,22]))),He=u.lazy(()=>y(()=>import("./EventsView-D3vg8B6l.js"),__vite__mapDeps([60,1,2,8,3,5]))),Je=u.lazy(()=>y(()=>import("./RegistrationsView-CVVa6g8I.js"),__vite__mapDeps([61,1,2,8,62,5,3]))),Ye=u.lazy(()=>y(()=>import("./RostersView-DxJWF6id.js"),__vite__mapDeps([63,1,2,62,5,3,8]))),Ke=u.lazy(()=>y(()=>import("./AdminPagesView-C5b-k8op.js"),__vite__mapDeps([64,1,2,8,5,3]))),Xe=()=>r.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-300",children:"Loading..."})]})});function Aa(){const{isAuthenticated:e,loading:t,role:s}=D(n=>n.auth),a=()=>{const n=rt();return u.useEffect(()=>{Ss({page_path:n.pathname+n.search,page_title:document.title,page_location:window.location.href})},[n]),null};return t?r.jsx(Xe,{}):r.jsx($t,{children:r.jsxs(u.Suspense,{fallback:r.jsx(Xe,{}),children:[r.jsx(a,{}),r.jsxs(Vt,{children:[r.jsxs(g,{element:r.jsx(Ls,{}),children:[r.jsx(g,{path:"/signin",element:e?r.jsx(w,{to:"/admin/dashboard",replace:!0}):r.jsx(Zs,{})}),r.jsx(g,{path:"/signup",element:e?r.jsx(w,{to:"/admin/dashboard",replace:!0}):r.jsx(ea,{})})]}),r.jsxs(g,{element:r.jsx(Xs,{}),children:[r.jsx(g,{path:"/",element:e?r.jsx(Ge,{}):r.jsx(w,{to:"/signin",replace:!0})}),r.jsx(g,{path:"/dashboard",element:r.jsx(w,{to:"/admin/dashboard",replace:!0})}),r.jsx(g,{path:"/admin/dashboard",element:e?r.jsx(Ge,{}):r.jsx(w,{to:"/signin",replace:!0})}),r.jsx(g,{path:"/teams",element:r.jsx(w,{to:"/admin/teams",replace:!0})}),r.jsx(g,{path:"/teams/:teamId/chat",element:r.jsx(w,{to:"/admin/teams/:teamId/chat",replace:!0})}),r.jsx(g,{path:"/admin/teams",element:r.jsx(E,{isAuthenticated:e,requiredRole:"admin",children:r.jsx(ta,{})})}),r.jsx(g,{path:"/admin/teams/:teamId/chat",element:r.jsx(E,{isAuthenticated:e,requiredRole:"admin",children:r.jsx(sa,{})})}),r.jsx(g,{path:"/announcements",element:e?r.jsx(na,{}):r.jsx(w,{to:"/signin",replace:!0})}),r.jsx(g,{path:"/people",element:r.jsx(w,{to:"/admin/people",replace:!0})}),r.jsx(g,{path:"/admin/people",element:r.jsx(E,{isAuthenticated:e,requiredRole:"admin",children:r.jsx(oa,{})})}),r.jsx(g,{path:"/programs",element:r.jsx(w,{to:"/admin/programs",replace:!0})}),r.jsx(g,{path:"/programs/:programId",element:e?r.jsx(qe,{}):r.jsx(w,{to:"/signin",replace:!0})}),r.jsx(g,{path:"/admin/seasons",element:r.jsx(E,{isAuthenticated:e,requiredRole:"admin",children:r.jsx(ua,{})})}),r.jsx(g,{path:"/admin/seasons/:seasonId",element:r.jsx(E,{isAuthenticated:e,requiredRole:"admin",children:r.jsx(ma,{})})}),r.jsx(g,{path:"/admin/programs",element:r.jsx(E,{isAuthenticated:e,requiredRole:"admin",children:r.jsx(ga,{})})}),r.jsx(g,{path:"/admin/programs/:programId",element:r.jsx(E,{isAuthenticated:e,requiredRole:"admin",children:r.jsx(qe,{})})}),r.jsx(g,{path:"/admin/programs/:programId/teams",element:r.jsx(E,{isAuthenticated:e,requiredRole:"admin",children:r.jsx(pa,{})})}),r.jsx(g,{path:"/schedules",element:e?r.jsx(xa,{}):r.jsx(w,{to:"/signin",replace:!0})}),r.jsx(g,{path:"/registration-help",element:e?r.jsx(fa,{}):r.jsx(w,{to:"/signin",replace:!0})}),r.jsx(g,{path:"/register",element:e?r.jsx(We,{}):r.jsx(w,{to:"/signin",replace:!0})}),r.jsx(g,{path:"/register/:programId",element:e?r.jsx(We,{}):r.jsx(w,{to:"/signin",replace:!0})}),r.jsx(g,{path:"/register/confirmation/:id",element:e?r.jsx(ya,{}):r.jsx(w,{to:"/signin",replace:!0})}),r.jsx(g,{path:"/my-family",element:e?r.jsx(ia,{}):r.jsx(w,{to:"/signin",replace:!0})}),r.jsx(g,{path:"/profile",element:e?r.jsx(la,{}):r.jsx(w,{to:"/signin",replace:!0})}),r.jsx(g,{path:"/payment-methods",element:e?r.jsx(ca,{}):r.jsx(w,{to:"/signin",replace:!0})}),r.jsx(g,{path:"/my-registrations",element:e?r.jsx(da,{}):r.jsx(w,{to:"/signin",replace:!0})}),r.jsx(g,{path:"/settings",element:r.jsx(w,{to:"/admin/settings",replace:!0})}),r.jsx(g,{path:"/admin/settings",element:r.jsx(E,{isAuthenticated:e,requiredRole:"admin",children:r.jsx(wa,{})})}),r.jsx(g,{path:"/events",element:e?r.jsx(He,{isAdmin:s==="admin"}):r.jsx(w,{to:"/signin",replace:!0})}),r.jsx(g,{path:"/events/:teamId",element:e?r.jsx(He,{isAdmin:s==="admin"}):r.jsx(w,{to:"/signin",replace:!0})}),r.jsx(g,{path:"/registrations",element:e?r.jsx(Je,{isAdmin:s==="admin"}):r.jsx(w,{to:"/signin",replace:!0})}),r.jsx(g,{path:"/registrations/:teamId",element:e?r.jsx(Je,{isAdmin:s==="admin"}):r.jsx(w,{to:"/signin",replace:!0})}),r.jsx(g,{path:"/rosters",element:e?r.jsx(Ye,{isAdmin:s==="admin"}):r.jsx(w,{to:"/signin",replace:!0})}),r.jsx(g,{path:"/rosters/:teamId",element:e?r.jsx(Ye,{isAdmin:s==="admin"}):r.jsx(w,{to:"/signin",replace:!0})}),r.jsx(g,{path:"/admin-pages",element:e?r.jsx(Ke,{isAdmin:s==="admin"}):r.jsx(w,{to:"/signin",replace:!0})}),r.jsx(g,{path:"/admin-pages/:page",element:e?r.jsx(Ke,{isAdmin:s==="admin"}):r.jsx(w,{to:"/signin",replace:!0})}),r.jsx(g,{path:"/admin",element:r.jsx(E,{isAuthenticated:e,requiredRole:"admin",children:r.jsx(aa,{})})}),r.jsx(g,{path:"/admin/analytics",element:r.jsx(E,{isAuthenticated:e,requiredRole:"admin",children:r.jsx(ja,{})})}),r.jsx(g,{path:"/admin/registrations",element:r.jsx(E,{isAuthenticated:e,requiredRole:"admin",children:r.jsx(ba,{})})}),r.jsx(g,{path:"/admin/payments",element:r.jsx(E,{isAuthenticated:e,requiredRole:"admin",children:r.jsx(_a,{})})}),r.jsx(g,{path:"/admin/payment-plans",element:r.jsx(E,{isAuthenticated:e,requiredRole:"admin",children:r.jsx(Ea,{})})}),r.jsx(g,{path:"/admin/discounts",element:r.jsx(E,{isAuthenticated:e,requiredRole:"admin",children:r.jsx(Sa,{})})}),r.jsx(g,{path:"/admin/season-discounts",element:r.jsx(E,{isAuthenticated:e,requiredRole:"admin",children:r.jsx(Ia,{})})}),r.jsx(g,{path:"/admin/sports",element:r.jsx(E,{isAuthenticated:e,requiredRole:"admin",children:r.jsx(ra,{})})}),r.jsx(g,{path:"/admin/audit",element:r.jsx(E,{isAuthenticated:e,requiredRole:"admin",children:r.jsx(ha,{})})}),r.jsx(g,{path:"/admin/program-templates",element:r.jsx(E,{isAuthenticated:e,requiredRole:"admin",children:r.jsx(Ra,{})})})]}),r.jsx(g,{path:"*",element:r.jsx(va,{})})]})]})})}const Ta={websiteViewsRange:30,customRange:null,showMyMenuItems:!0,debugLogging:!1},xe=N({name:"ui",initialState:Ta,reducers:{setWebsiteViewsRange(e,t){e.websiteViewsRange=t.payload,e.customRange=null},setWebsiteCustomRange(e,t){e.customRange=t.payload,t.payload&&(e.websiteViewsRange=0)},setShowMyMenuItems(e,t){e.showMyMenuItems=t.payload},setDebugLogging(e,t){e.debugLogging=t.payload}}}),{setWebsiteViewsRange:ln,setWebsiteCustomRange:cn}=xe.actions,{setShowMyMenuItems:ka,setDebugLogging:Pa}=xe.actions,Ca=xe.reducer;function La(){const[e,t]=u.useState(null),s=Q(),a=D(l=>l.auth.loading),n=D(l=>l.theme.isDarkMode),o=D(l=>l.auth.user),i=D(l=>l.auth.role);return u.useEffect(()=>{document.documentElement.setAttribute("data-theme",n?"dark":"light"),document.body.style.backgroundColor=n?"#141414":"#ffffff",document.body.style.color=n?"#ffffff":"#000000"},[n]),u.useEffect(()=>{const l=new AbortController,c=setTimeout(()=>l.abort(),3e3);let d=!1;return(async()=>{try{const x=await fetch("https://ipapi.co/json/",{signal:l.signal});if(!x.ok)throw new Error(`geo lookup failed ${x.status}`);const f=((await x.json()).country_code||"").toUpperCase(),S=["US","CA"].includes(f);d||t(S)}catch(x){if(x&&x.name==="AbortError")return;m.error("Geo check failed, default allow",x),d||t(!0)}})(),()=>{d=!0,l.abort(),clearTimeout(c)}},[]),u.useEffect(()=>{e===!1&&(async()=>{try{await O.signOut()}catch(l){m.error("signOut after geo block failed",l)}})()},[e]),u.useEffect(()=>{const l=Nr(O,async c=>{try{if(c){let d="User",h="user";try{const p=_(b,`users/${c.uid}`),f=await R(p);if(f.exists()){const j=f.val();d=j.displayName||"User",h=j.role||"user"}}catch(p){m.error("Database read failed, using Firebase displayName:",p),d=c.displayName||"User"}const x={uid:c.uid,email:c.email,displayName:d,photoURL:c.photoURL};s($({user:x,role:h,createdAt:c.metadata.creationTime?new Date(c.metadata.creationTime).getTime():void 0}));try{const p={};try{const f=localStorage.getItem("wgys.showMyMenuItems");(f==="0"||f==="1")&&(p.showMyMenuItems=f==="1")}catch(f){m.error("reading localStorage wgys.showMyMenuItems failed",f)}try{const f=localStorage.getItem("theme");(f==="dark"||f==="light")&&(p.theme=f)}catch(f){m.error("reading localStorage theme failed",f)}if(Object.keys(p).length>0){const f=_(b,`users/${c.uid}/preferences`);await ut(f,p);try{localStorage.removeItem("wgys.showMyMenuItems")}catch(j){m.error("removing localStorage wgys.showMyMenuItems failed",j)}try{localStorage.removeItem("theme")}catch(j){m.error("removing localStorage theme failed",j)}}}catch(p){m.error("Preference migration to RTDB failed",p)}try{const p=_(b,`users/${c.uid}/preferences`),f=await R(p);if(f.exists()){const j=f.val();if(j.theme){s(wt(j.theme==="dark"));try{localStorage.setItem("wgys.theme",j.theme)}catch(S){m.error("failed to cache theme locally",S)}}if(typeof j.showMyMenuItems<"u"){s(ka(!!j.showMyMenuItems));try{localStorage.setItem("wgys.showMyMenuItems",j.showMyMenuItems?"1":"0")}catch(S){m.error("failed to cache showMyMenuItems locally",S)}}if(typeof j.debugLogging<"u"){try{localStorage.setItem("wgys.debugLogging",j.debugLogging?"1":"0")}catch(S){m.error("failed to cache debugLogging locally",S)}try{s(Pa(!!j.debugLogging))}catch(S){m.error("failed to set debugLogging in store",S)}}try{Object.keys(j).forEach(S=>{try{const P=j[S];P===null||typeof P=="string"||typeof P=="number"||typeof P=="boolean"?localStorage.setItem(`wgys.pref.${S}`,String(P)):localStorage.setItem(`wgys.pref.${S}`,JSON.stringify(P))}catch(P){m.error(`failed to cache preference ${S} locally`,P)}})}catch(S){m.error("failed to iterate preferences for caching",S)}}}catch(p){m.error("Failed to load user preferences from RTDB",p)}}else s($({user:null,role:"user"}))}catch(d){m.error("Auth error:",d),s($({user:null,role:"user"}))}finally{s(ms(!1))}});return()=>{l()}},[s]),u.useEffect(()=>{o&&Cs({role:i,user_id:o.uid})},[i,o]),a||e===null?r.jsx("div",{className:"loading-screen",children:"Loading..."}):e===!1?r.jsxs("div",{className:"loading-screen",style:{textAlign:"center",padding:"48px"},children:[r.jsx("h2",{children:"Access not available in your region"}),r.jsx("p",{style:{marginTop:"12px",color:"#888"},children:"This site is restricted to North America (US/CA)."})]}):r.jsx(ur,{theme:n?fs:ys,children:r.jsx(ge,{children:r.jsx(Aa,{})})})}const Da={messages:{global:[]},loading:{},error:{}},jt=N({name:"chat",initialState:Da,reducers:{setLoading:(e,t)=>{const s=t.payload.teamId||"global";e.loading[s]=t.payload.loading},setMessages:(e,t)=>{const s=t.payload.teamId||"global",a=t.payload.messages||[],n={};a.forEach(i=>{n[i.id]=i});const o=Object.values(n).sort((i,l)=>new Date(i.timestamp).getTime()-new Date(l.timestamp).getTime());e.messages[s]=o},addMessage:(e,t)=>{const s=t.payload.teamId||"global";e.messages[s]||(e.messages[s]=[]),e.messages[s].some(n=>n.id===t.payload.message.id)||(e.messages[s].push(t.payload.message),e.messages[s].sort((n,o)=>new Date(n.timestamp).getTime()-new Date(o.timestamp).getTime()))},deleteMessage:(e,t)=>{const s=t.payload.teamId||"global";e.messages[s]=(e.messages[s]||[]).filter(a=>a.id!==t.payload.id)},setError:(e,t)=>{const s=t.payload.teamId||"global";e.error[s]=t.payload.error}}}),{setLoading:dn,setMessages:un,addMessage:mn,deleteMessage:gn,setError:pn}=jt.actions,Oa=jt.reducer,bt={async getTeamEvents(e){try{const t=_(b,"events"),s=await R(t);if(!s.exists())return[];const a=[];return s.forEach(n=>{const o={id:n.key,...n.val()};o.teamId===e&&a.push(o)}),a.sort((n,o)=>new Date(o.date).getTime()-new Date(n.date).getTime())}catch(t){throw console.error("âŒ Error fetching team events:",t),t}},async getAllEvents(){try{const e=_(b,"events"),t=await R(e);if(!t.exists())return[];const s=[];return t.forEach(a=>{const n={id:a.key,...a.val()};s.push(n)}),s.sort((a,n)=>new Date(n.date).getTime()-new Date(a.date).getTime())}catch(e){throw console.error("âŒ Error fetching all events:",e),e}},async createEvent(e,t,s,a,n,o){try{const i=_(b,"events"),l=G(i),c={teamId:e,title:t,type:s,date:a,location:n,description:o,createdAt:new Date().toISOString()};return await k(l,c),{id:l.key,...c}}catch(i){throw console.error("âŒ Error creating event:",i),i}},async updateEvent(e,t){try{const s=_(b,`events/${e}`),a=await R(s);a.exists()&&await k(s,{...a.val(),...t,updatedAt:new Date().toISOString()})}catch(s){throw console.error("âŒ Error updating event:",s),s}},async deleteEvent(e){try{const t=_(b,`events/${e}`);await he(t)}catch(t){throw console.error("âŒ Error deleting event:",t),t}}},Na={events:[],loading:!1,error:null},ne=Z("events/fetchTeamEvents",async e=>await bt.getTeamEvents(e)),oe=Z("events/fetchAllEvents",async()=>await bt.getAllEvents()),_t=N({name:"events",initialState:Na,reducers:{setEvents:(e,t)=>{e.events=t.payload},addEvent:(e,t)=>{e.events.push(t.payload)},updateEvent:(e,t)=>{const s=e.events.findIndex(a=>a.id===t.payload.id);s!==-1&&(e.events[s]=t.payload)},removeEvent:(e,t)=>{e.events=e.events.filter(s=>s.id!==t.payload)},clearError:e=>{e.error=null}},extraReducers:e=>{e.addCase(ne.pending,t=>{t.loading=!0,t.error=null}).addCase(ne.fulfilled,(t,s)=>{t.loading=!1,t.events=s.payload}).addCase(ne.rejected,(t,s)=>{t.loading=!1,t.error=s.error.message||"Failed to fetch events"}).addCase(oe.pending,t=>{t.loading=!0,t.error=null}).addCase(oe.fulfilled,(t,s)=>{t.loading=!1,t.events=s.payload}).addCase(oe.rejected,(t,s)=>{t.loading=!1,t.error=s.error.message||"Failed to fetch events"})}}),{setEvents:hn,addEvent:fn,updateEvent:yn,removeEvent:xn,clearError:wn}=_t.actions,Ma=_t.reducer,ie="auditLogs",U={async log(e){try{const t=new Date().toISOString(),s=G(_(b,ie)),a=O.currentUser,n={...e,actorId:e.actorId??a?.uid??null,actorEmail:e.actorEmail??a?.email??null,timestamp:t},o=i=>{if(i===void 0||i===null)return null;if(Array.isArray(i))return i.map(o);if(typeof i=="object"){const l={};for(const[c,d]of Object.entries(i))d!==void 0&&(l[c]=o(d));return l}return i};if(n.details!==void 0)try{n.details=o(n.details)}catch(i){m.info("Error sanitizing audit log details, falling back to stringification",i),n.details=String(n.details)}return await k(s,n),s.key}catch(t){return console.error("Error writing audit entry: ",t||"unknown error"),null}},async getLogs(e=500){try{const t=_(b,ie),s=Mr(t,Ur("timestamp"),$r(e)),a=await R(s);if(!a.exists())return[];const n=a.val();return Object.entries(n).map(([o,i])=>({id:o,...i}))}catch(t){return console.error("Error fetching audit logs:",t),[]}},async deleteLog(e){try{return e?(await he(_(b,`${ie}/${e}`)),!0):!1}catch(t){return console.error("Error deleting audit log:",t),!1}},async logBulk(e,t,s,a){return this.log({action:e,entityType:t,entityId:null,details:{ids:s,...a}})},async logDelete(e,t,s,a){try{return await this.log({action:`${e}.deleted`,entityType:e,entityId:t??null,actorId:a??void 0,details:{before:s??null}})}catch(n){return console.error(`Error writing delete audit entry for ${e}.deleted:`,n||"unknown error"),null}}},Et=[{value:"cart",label:"Cart"},{value:"pending",label:"Pending"},{value:"confirmed",label:"Confirmed"},{value:"cancelled",label:"Cancelled"},{value:"waitlist",label:"Waitlist"}];Et.map(e=>e.value);Object.fromEntries(Et.map(e=>[e.value,e.value]));const St=[{value:"full",label:"Full"},{value:"plan",label:"Plan"}];St.map(e=>e.value);const vn=Object.fromEntries(St.map(e=>[e.value,e.value])),It=[{value:"weekly",label:"Weekly"},{value:"biweekly",label:"Biweekly"},{value:"monthly",label:"Monthly"}];It.map(e=>e.value);Object.fromEntries(It.map(e=>[e.value,e.value]));const Rt=[{value:"short_answer",label:"Short Answer"},{value:"paragraph",label:"Paragraph"},{value:"dropdown",label:"Dropdown"},{value:"checkboxes",label:"Checkboxes"},{value:"file_upload",label:"File Upload"},{value:"numeric",label:"Numeric"},{value:"jersey_number",label:"Jersey Number"},{value:"waiver",label:"Waiver"}],jn=Rt.map(e=>e.value);Object.fromEntries(Rt.map(e=>[e.value,e.value]));const we=[{value:"sport",label:"Sport"},{value:"lesson",label:"Lesson"},{value:"training",label:"Training"},{value:"tryout",label:"Tryout"},{value:"camp",label:"Camp"},{value:"recreation",label:"Recreation"},{value:"select",label:"Select"}];we.map(e=>e.value);Object.fromEntries(we.map(e=>[e.value,e.value]));const Ua=Object.fromEntries(we.map(e=>[e.value,e.label]));function bn(e){return e?Ua[e]??e.charAt(0).toUpperCase()+e.slice(1):"-"}const At=[{value:"any",label:"Any"},{value:"male",label:"Male"},{value:"female",label:"Female"}];At.map(e=>e.value);Object.fromEntries(At.map(e=>[e.value,e.value]));const $a=[{value:"4U",label:"4U"},{value:"5U",label:"5U"},{value:"6U",label:"6U"},{value:"7U",label:"7U"},{value:"8U",label:"8U"},{value:"9U",label:"9U"},{value:"10U",label:"10U"},{value:"11U",label:"11U"},{value:"12U",label:"12U"},{value:"13U",label:"13U"},{value:"14U",label:"14U"},{value:"15U",label:"15U"},{value:"16U",label:"16U"},{value:"17U",label:"17U"},{value:"18U",label:"18U"}];$a.map(e=>e.value);var M=(e=>(e.Cart="cart",e.Program="program",e.ProgramTemplate="programTemplate",e.Sport="sport",e.Team="team",e.Season="season",e.Person="person",e.Family="family",e.File="file",e.SeasonProgram="seasonProgram",e.TeamAssignment="teamAssignment",e.PaymentPlan="paymentPlan",e.PaymentMethod="paymentMethod",e.Other="other",e.Discount="discount",e.User="user",e))(M||{});const Tt={async getTeamRegistrations(e){try{const t=_(b,"teamAssignments"),s=await R(t);if(!s.exists())return[];const a=[];return s.forEach(n=>{const o={id:n.key,...n.val()};o.teamId===e&&a.push(o)}),a.sort((n,o)=>new Date(o.createdAt).getTime()-new Date(n.createdAt).getTime())}catch(t){throw m.error("âŒ Error fetching team assignments:",t),t}},async getAllRegistrations(){try{const e=_(b,"teamAssignments"),t=await R(e);if(!t.exists())return[];const s=[];return t.forEach(a=>{const n={id:a.key,...a.val()};s.push(n)}),s.sort((a,n)=>new Date(n.createdAt).getTime()-new Date(a.createdAt).getTime())}catch(e){throw m.error("âŒ Error fetching all team assignments:",e),e}},async createRegistration(e,t,s,a,n,o,i,l,c){try{const d=_(b,"teamAssignments"),h=G(d),x={teamId:e,playerName:t,playerAge:s,playerPosition:a,parentName:n,parentEmail:o,phoneNumber:i,fee:l,paymentMethod:c,status:"pending",createdAt:new Date().toISOString()};await k(h,x);try{await U.log({action:"registration.created",entityType:M.TeamAssignment,entityId:h.key,details:x})}catch(p){m.error("Error auditing registration.created:",p)}return{id:h.key,...x}}catch(d){throw m.error("âŒ Error creating registration:",d),d}},async updateRegistration(e,t){try{const s=_(b,`registrations/${e}`),a=await R(s);if(a.exists()){await k(s,{...a.val(),...t,updatedAt:new Date().toISOString()});try{await U.log({action:"registration.updated",entityType:M.TeamAssignment,entityId:e,details:t})}catch(n){m.error("Error auditing registration.updated:",n)}}}catch(s){throw m.error("âŒ Error updating registration:",s),s}},async approveRegistration(e,t){try{const s=_(b,`registrations/${e}`),a=await R(s);if(a.exists()){await k(s,{...a.val(),status:"approved",rosterPlayerId:t,updatedAt:new Date().toISOString()});try{await U.log({action:"registration.approved",entityType:M.TeamAssignment,entityId:e,details:{rosterPlayerId:t}})}catch(n){m.error("Error auditing registration.approved:",n)}}}catch(s){throw m.error("âŒ Error approving registration:",s),s}},async markAsPaid(e){try{const t=_(b,`registrations/${e}`),s=await R(t);if(s.exists()){await k(t,{...s.val(),status:"paid",updatedAt:new Date().toISOString()});try{await U.log({action:"registration.paid",entityType:M.TeamAssignment,entityId:e})}catch(a){m.error("Error auditing registration.paid:",a)}}}catch(t){throw m.error("âŒ Error marking registration as paid:",t),t}},async deleteRegistration(e){try{const t=_(b,`registrations/${e}`);await he(t);try{await U.log({action:"registration.deleted",entityType:M.TeamAssignment,entityId:e})}catch(s){m.error("Error auditing registration.deleted:",s)}}catch(t){throw m.error("âŒ Error deleting registration:",t),t}},async getRegistrationsByStatus(e,t){try{const s=_(b,"teamAssignments"),a=await R(s);if(!a.exists())return[];const n=[];return a.forEach(o=>{const i={id:o.key,...o.val()};i.teamId===e&&i.status===t&&n.push(i)}),n.sort((o,i)=>new Date(i.createdAt).getTime()-new Date(o.createdAt).getTime())}catch(s){throw m.error("âŒ Error fetching team assignments by status:",s),s}}},Va={registrations:[],loading:!1,error:null},le=Z("registrations/fetchTeamRegistrations",async e=>await Tt.getTeamRegistrations(e)),ce=Z("registrations/fetchAllRegistrations",async()=>await Tt.getAllRegistrations()),kt=N({name:"registrations",initialState:Va,reducers:{setRegistrations:(e,t)=>{e.registrations=t.payload},addRegistration:(e,t)=>{e.registrations.push(t.payload)},updateRegistration:(e,t)=>{const s=e.registrations.findIndex(a=>a.id===t.payload.id);s!==-1&&(e.registrations[s]=t.payload)},removeRegistration:(e,t)=>{e.registrations=e.registrations.filter(s=>s.id!==t.payload)},clearError:e=>{e.error=null}},extraReducers:e=>{e.addCase(le.pending,t=>{t.loading=!0,t.error=null}).addCase(le.fulfilled,(t,s)=>{t.loading=!1,t.registrations=s.payload}).addCase(le.rejected,(t,s)=>{t.loading=!1,t.error=s.error.message||"Failed to fetch registrations"}).addCase(ce.pending,t=>{t.loading=!0,t.error=null}).addCase(ce.fulfilled,(t,s)=>{t.loading=!1,t.registrations=s.payload}).addCase(ce.rejected,(t,s)=>{t.loading=!1,t.error=s.error.message||"Failed to fetch registrations"})}}),{setRegistrations:_n,addRegistration:En,updateRegistration:Sn,removeRegistration:In,clearError:Rn}=kt.actions,Fa=kt.reducer,za={teams:[],loading:!1,error:null},Pt=N({name:"teams",initialState:za,reducers:{setLoading:(e,t)=>{e.loading=t.payload},setTeams:(e,t)=>{e.teams=t.payload},addTeam:(e,t)=>{e.teams.push(t.payload)},updateTeam:(e,t)=>{const s=e.teams.findIndex(a=>a.id===t.payload.id);s!==-1&&(e.teams[s]=t.payload)},deleteTeam:(e,t)=>{e.teams=e.teams.filter(s=>s.id!==t.payload)},setError:(e,t)=>{e.error=t.payload}}}),{setLoading:An,setTeams:Tn,addTeam:kn,updateTeam:Pn,deleteTeam:Cn,setError:Ln}=Pt.actions,Ba=Pt.reducer,Ga={announcements:[],loading:!1,error:null},Ct=N({name:"announcements",initialState:Ga,reducers:{setLoading:(e,t)=>{e.loading=t.payload},setAnnouncements:(e,t)=>{e.announcements=t.payload},addAnnouncement:(e,t)=>{e.announcements.unshift(t.payload)},updateAnnouncement:(e,t)=>{const s=e.announcements.findIndex(a=>a.id===t.payload.id);s!==-1&&(e.announcements[s]=t.payload)},deleteAnnouncement:(e,t)=>{e.announcements=e.announcements.filter(s=>s.id!==t.payload)},incrementViews:(e,t)=>{const s=e.announcements.find(a=>a.id===t.payload);s&&(s.views+=1)},setError:(e,t)=>{e.error=t.payload}}}),{setLoading:Dn,setAnnouncements:On,addAnnouncement:Nn,updateAnnouncement:Mn,deleteAnnouncement:Un,incrementViews:$n,setError:Vn}=Ct.actions,qa=Ct.reducer,Lt="wgys_cart_v1",Wa=()=>{try{const e=localStorage.getItem(Lt);return e?JSON.parse(e):[]}catch(e){return m.error("Error loading cart from localStorage",e),[]}},q=e=>{try{localStorage.setItem(Lt,JSON.stringify(e))}catch(t){m.error("Error saving cart to localStorage",t)}},Ha={items:Wa()},Dt=N({name:"cart",initialState:Ha,reducers:{addItem:(e,t)=>{e.items.push(t.payload),q(e.items)},removeItem:(e,t)=>{e.items=e.items.filter(s=>s.id!==t.payload),q(e.items)},clearCart:e=>{e.items=[],q(e.items)},setItems:(e,t)=>{e.items=t.payload,q(e.items)}}}),{addItem:Fn,removeItem:zn,clearCart:Bn,setItems:Ja}=Dt.actions,Ya=Dt.reducer,Qe={async saveCart(e,t){try{const s=new Date().toISOString(),a=_(b,`carts/${e}`);await k(a,{userId:e,items:t,updatedAt:s});try{await U.log({action:"cart.saved",entityType:M.Cart,entityId:e,details:{itemsCount:t?.length||0}})}catch(o){console.error("Error auditing cart.save:",o)}return!0}catch(s){return console.error("Error saving cart to database:",s),!1}},async getCart(e){try{const t=await R(_(b,`carts/${e}`));return t.exists()?t.val().items||[]:null}catch(t){return console.error("Error fetching cart from database:",t),null}},async clearCart(e){try{await k(_(b,`carts/${e}`),null);try{await U.log({action:"cart.cleared",entityType:M.Cart,entityId:e,details:{}})}catch(t){console.error("Error auditing cart.clear:",t)}return!0}catch(t){return console.error("Error clearing cart in database:",t),!1}}},z=pr({reducer:{announcements:qa,auth:gs,chat:Oa,events:Ma,registrations:Fa,cart:Ya,teams:Ba,theme:Os,ui:Ca},middleware:e=>e({serializableCheck:{ignoredActions:["auth/setUser"],ignoredPaths:["auth.user"]}})});let Ze=null,et=JSON.stringify(z.getState().cart.items);z.subscribe(()=>{const e=z.getState(),t=e.auth.user?.uid||null;t&&t!==Ze&&(async()=>{try{const a=await Qe.getCart(t);a&&Array.isArray(a)&&a.length>0&&z.dispatch(Ja(a))}catch(a){m.error("Error loading server cart on login",a)}})();const s=JSON.stringify(e.cart.items);t&&s!==et&&(async()=>{try{await Qe.saveCart(t,e.cart.items)}catch(a){m.error("Error saving cart to server",a)}})(),Ze=t,et=s});const Ka=({children:e})=>{const[t,s]=I.useMessage();return u.useEffect(()=>{const a={success:I.success,error:I.error,info:I.info,warning:I.warning,open:I.open};try{I.success=(...n)=>t.success.apply(t,n),I.error=(...n)=>t.error.apply(t,n),I.info=(...n)=>t.info.apply(t,n),I.warning=(...n)=>t.warning.apply(t,n),I.open=(...n)=>t.open.apply(t,n)}catch(n){console.error("Failed to override message methods",n)}return()=>{try{I.success=a.success,I.error=a.error,I.info=a.info,I.warning=a.warning,I.open=a.open}catch(n){m.error("Failed to notify via Antd message methods",n)}}},[t]),r.jsxs(r.Fragment,{children:[s,e]})};Es();mr.createRoot(document.getElementById("root")).render(r.jsx(Ft.StrictMode,{children:r.jsx(hr,{store:z,children:r.jsx(Ka,{children:r.jsx(La,{})})})}));export{M as A,cs as B,Fn as C,zn as D,ls as E,bn as F,ne as G,bt as H,le as I,vn as J,Bn as K,sn as L,we as P,jn as Q,y as _,An as a,Ln as b,kn as c,Cn as d,b as e,un as f,mn as g,gn as h,Dn as i,r as j,On as k,m as l,Vn as m,Nn as n,Un as o,O as p,U as q,Tt as r,Tn as s,nn as t,$ as u,wt as v,ka as w,Pa as x,B as y,rn as z};
