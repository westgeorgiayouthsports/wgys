import{o as a,H as l,n as i,z as d,q as m,t as f}from"./vendor-firebase-BzUsRx-X.js";import{e as c}from"./index-lWfxYzVq.js";const A={async getAnnouncements(t){try{const n=a(c,"announcements"),e=await i(n);if(!e.exists())return[];const r=[];return e.forEach(o=>{const s={id:o.key,...o.val()};t?(s.userId===t||s.status==="published")&&r.push(s):s.status==="published"&&r.push(s)}),r.sort((o,s)=>new Date(s.createdAt).getTime()-new Date(o.createdAt).getTime())}catch(n){throw console.error("Error fetching announcements:",n),n}},async createAnnouncement(t,n,e,r,o=!0,s=!0){try{const u=a(c,"announcements"),h=f(u),w={title:e,content:r,userId:t,userEmail:n,authorEmail:n,status:"draft",createdAt:new Date().toISOString(),views:0,showOnFeed:o,allowComments:s};return await m(h,w),{id:h.key,...w}}catch(u){throw console.error("Error creating announcement:",u),u}},async updateAnnouncement(t,n){try{const e=a(c,`announcements/${t}`),r=await i(e);r.exists()&&await m(e,{...r.val(),...n})}catch(e){throw console.error("Error updating announcement:",e),e}},async publishAnnouncement(t){try{const n=a(c,`announcements/${t}`),e=await i(n);e.exists()&&await m(n,{...e.val(),status:"published",publishedAt:new Date().toISOString()})}catch(n){throw console.error("Error publishing announcement:",n),n}},async deleteAnnouncement(t){try{const n=a(c,`announcements/${t}`);await d(n)}catch(n){throw console.error("Error deleting announcement:",n),n}},async getAllPublishedAnnouncements(){try{const t=a(c,"announcements"),n=await i(t);if(!n.exists())return[];const e=[];return n.forEach(r=>{const o={id:r.key,...r.val()};o.status==="published"&&e.push(o)}),e.sort((r,o)=>{const s=new Date(r.publishedAt||r.createdAt).getTime();return new Date(o.publishedAt||o.createdAt).getTime()-s})}catch(t){throw console.error("Error fetching published announcements:",t),t}},async incrementViews(t){try{const n=a(c,`announcements/${t}/views`);await l(n,e=>(e||0)+1)}catch(n){throw console.error("Error incrementing views:",n),n}}};export{A as a};
