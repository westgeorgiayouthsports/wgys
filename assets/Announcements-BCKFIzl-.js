import{j as S,l as ge,e as To,i as Eo,k as Ot,m as sc,n as lc,o as ac}from"./index-lWfxYzVq.js";import{r as P,b as Oo,R as We}from"./vendor-router-Ck4ZuSP9.js";import{a as gn,u as cc}from"./vendor-redux-BbD-gcRX.js";import{a as At}from"./firebaseAnnouncements-nWIjlOxu.js";import{H as Re,S as Rt,x as bn,I as ol,W as sl,X as zt,ak as cr,B as Ne,C as uc,ae as dc,Q as Un,F as fc,aj as ll,ai as hc,b as gc,N as pc,af as Jr,$ as Jn,a2 as mc,a0 as _c,Y as yc,ah as xc}from"./vendor-antd-CieyQibU.js";import{o as Ao,n as Sc,t as Cc,q as vc}from"./vendor-firebase-BzUsRx-X.js";import{A as bc}from"./AdminPageHeader-BidreVSQ.js";import"./vendor-react-Ck9bq5u-.js";function E(n,...e){const t=new URL("https://lexical.dev/docs/error"),r=new URLSearchParams;r.append("code",n);for(const i of e)r.append("v",i);throw t.search=r.toString(),Error(`Minified Lexical error #${n}; visit ${t.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function al(n,...e){const t=new URL("https://lexical.dev/docs/error"),r=new URLSearchParams;r.append("code",n);for(const i of e)r.append("v",i);t.search=r.toString(),console.warn(`Minified Lexical warning #${n}; visit ${t.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}const be=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,wc=be&&"documentMode"in document?document.documentMode:null,Se=be&&/Mac|iPod|iPhone|iPad/.test(navigator.platform),gt=be&&/^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent),ur=!(!be||!("InputEvent"in window)||wc)&&"getTargetRanges"in new window.InputEvent("input"),wn=be&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),Yt=be&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,kc=be&&/Android/.test(navigator.userAgent),cl=be&&/^(?=.*Chrome).*/i.test(navigator.userAgent),Mo=be&&kc&&cl,kn=be&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&Se&&!cl;function ul(...n){const e=[];for(const t of n)if(t&&typeof t=="string")for(const[r]of t.matchAll(/\S+/g))e.push(r);return e}const Nc=0,Tc=1,Ec=2,dl=128,Oc=1,Ac=2,Mc=3,Dc=4,Fc=5,Lc=6,Tr=wn||Yt||kn?" ":"​",et=`

`,Pc=gt?" ":Tr,pt={bold:1,capitalize:1024,code:16,highlight:dl,italic:2,lowercase:256,strikethrough:4,subscript:32,superscript:64,underline:8,uppercase:512},$c={directionless:1,unmergeable:2},Do={center:2,end:6,justify:4,left:1,right:3,start:5},Ic={[Ac]:"center",[Lc]:"end",[Dc]:"justify",[Oc]:"left",[Mc]:"right",[Fc]:"start"},Rc={normal:0,segmented:2,token:1},zc={[Nc]:"normal",[Ec]:"segmented",[Tc]:"token"},Fo="$config";function fl(n,e,t,r,i,o){let s=n.getFirstChild();for(;s!==null;){const l=s.__key;s.__parent===e&&(v(s)&&fl(s,l,t,r,i,o),t.has(l)||o.delete(l),i.push(l)),s=s.getNextSibling()}}let fi=!1,Bi=0;function jc(n){Bi=n.timeStamp}function Hr(n,e,t){const r=n.nodeName==="BR",i=e.__lexicalLineBreak;return i&&(n===i||r&&n.previousSibling===i)||r&&Fr(n,t)!==void 0}function Wc(n,e,t){const r=ve(xe(t));let i=null,o=null;r!==null&&r.anchorNode===n&&(i=r.anchorOffset,o=r.focusOffset);const s=n.nodeValue;s!==null&&oo(e,s,i,o,!1)}function Bc(n,e,t){if(A(n)){const r=n.anchor.getNode();if(r.is(t)&&n.format!==r.getFormat())return!1}return Je(e)&&t.isAttached()}function Kc(n,e,t,r){for(let i=n;i&&!Vu(i);i=In(i)){const o=Fr(i,e);if(o!==void 0){const s=ne(o,t);if(s)return W(s)||!J(i)?void 0:[i,s]}else if(i===r)return[r,ha(t)]}}function hl(n,e,t){fi=!0;const r=performance.now()-Bi>100;try{me(n,()=>{const i=F()||(function(d){return d.getEditorState().read(()=>{const g=F();return g!==null?g.clone():null})})(n),o=new Map,s=n.getRootElement(),l=n._editorState,a=n._blockCursorElement;let c=!1,u="";for(let d=0;d<e.length;d++){const g=e[d],h=g.type,p=g.target,m=Kc(p,n,l,s);if(!m)continue;const[x,y]=m;if(h==="characterData")r&&M(y)&&Je(p)&&Bc(i,p,y)&&Wc(p,y,n);else if(h==="childList"){c=!0;const C=g.addedNodes;for(let b=0;b<C.length;b++){const N=C[b],w=da(N),_=N.parentNode;if(_!=null&&N!==a&&w===null&&!Hr(N,_,n)){if(gt){const O=(J(N)?N.innerText:null)||N.nodeValue;O&&(u+=O)}_.removeChild(N)}}const k=g.removedNodes,T=k.length;if(T>0){let b=0;for(let N=0;N<T;N++){const w=k[N];(Hr(w,p,n)||a===w)&&(p.appendChild(w),b++)}T!==b&&o.set(x,y)}}}if(o.size>0)for(const[d,g]of o)g.reconcileObservedMutation(d,n);const f=t.takeRecords();if(f.length>0){for(let d=0;d<f.length;d++){const g=f[d],h=g.addedNodes,p=g.target;for(let m=0;m<h.length;m++){const x=h[m],y=x.parentNode;y==null||x.nodeName!=="BR"||Hr(x,p,n)||y.removeChild(x)}}t.takeRecords()}i!==null&&(c&&fe(i),gt&&_a(n)&&i.insertRawText(u))})}finally{fi=!1}}function gl(n){const e=n._observer;e!==null&&hl(n,e.takeRecords(),e)}function pl(n){(function(e){Bi===0&&xe(e).addEventListener("textInput",jc,!0)})(n),n._observer=new MutationObserver((e,t)=>{hl(n,e,t)})}function Uc(n){const e=new Map,t=new Set;for(let r=typeof n=="function"?n:n.replace;r.prototype&&r.prototype.getType!==void 0;r=Object.getPrototypeOf(r)){const{ownNodeConfig:i}=$r(r);if(i&&i.stateConfigs)for(const o of i.stateConfigs){let s;"stateConfig"in o?(s=o.stateConfig,o.flat&&t.add(s.key)):s=o,e.set(s.key,s)}}return{flatKeys:t,sharedConfigMap:e}}let Jc=class ml{node;knownState;unknownState;sharedNodeState;size;constructor(e,t,r=void 0,i=new Map,o=void 0){this.node=e,this.sharedNodeState=t,this.unknownState=r,this.knownState=i;const{sharedConfigMap:s}=this.sharedNodeState,l=o!==void 0?o:(function(a,c,u){let f=u.size;if(c)for(const d in c){const g=a.get(d);g&&u.has(g)||f++}return f})(s,r,i);this.size=l}getValue(e){const t=this.knownState.get(e);if(t!==void 0)return t;this.sharedNodeState.sharedConfigMap.set(e.key,e);let r=e.defaultValue;if(this.unknownState&&e.key in this.unknownState){const i=this.unknownState[e.key];i!==void 0&&(r=e.parse(i)),this.updateFromKnown(e,r)}return r}getInternalState(){return[this.unknownState,this.knownState]}toJSON(){const e={...this.unknownState},t={};for(const[r,i]of this.knownState)r.isEqual(i,r.defaultValue)?delete e[r.key]:e[r.key]=r.unparse(i);for(const r of this.sharedNodeState.flatKeys)r in e&&(t[r]=e[r],delete e[r]);return Lo(e)&&(t.$=e),t}getWritable(e){if(this.node===e)return this;const{sharedNodeState:t,unknownState:r}=this,i=new Map(this.knownState);return new ml(e,t,(function(o,s,l){let a;if(l)for(const[c,u]of Object.entries(l)){const f=o.get(c);f?s.has(f)||s.set(f,f.parse(u)):(a=a||{},a[c]=u)}return a})(t.sharedConfigMap,i,r),i,this.size)}updateFromKnown(e,t){const r=e.key;this.sharedNodeState.sharedConfigMap.set(r,e);const{knownState:i,unknownState:o}=this;i.has(e)||o&&r in o||(o&&(delete o[r],this.unknownState=Lo(o)),this.size++),i.set(e,t)}updateFromUnknown(e,t){const r=this.sharedNodeState.sharedConfigMap.get(e);r?this.updateFromKnown(r,r.parse(t)):(this.unknownState=this.unknownState||{},e in this.unknownState||this.size++,this.unknownState[e]=t)}updateFromJSON(e){const{knownState:t}=this;for(const r of t.keys())t.set(r,r.defaultValue);if(this.size=t.size,this.unknownState=void 0,e)for(const[r,i]of Object.entries(e))this.updateFromUnknown(r,i)}};function Hc(n){const e=n.getWritable(),t=e.__state?e.__state.getWritable(e):new Jc(e,_l(e));return e.__state=t,t}function _l(n){return n.__state?n.__state.sharedNodeState:aa(Pr(),n.getType()).sharedNodeState}function Lo(n){if(n)for(const e in n)return n}function Po(n,e,t){for(const[r,i]of e.knownState){if(n.has(r.key))continue;n.add(r.key);const o=t?t.getValue(r):r.defaultValue;if(o!==i&&!r.isEqual(o,i))return!0}return!1}function $o(n,e,t){const{unknownState:r}=e,i=t?t.unknownState:void 0;if(r){for(const[o,s]of Object.entries(r))if(!n.has(o)&&(n.add(o),s!==(i?i[o]:void 0)))return!0}return!1}function Io(n,e){const t=n.__state;return t&&t.node===n?t.getWritable(e):t}function Ro(n,e){const t=n.__mode,r=n.__format,i=n.__style,o=e.__mode,s=e.__format,l=e.__style,a=n.__state,c=e.__state;return(t===null||t===o)&&(r===null||r===s)&&(i===null||i===l)&&(n.__state===null||a===c||(function(u,f){if(u===f)return!0;if(u&&f&&u.size!==f.size)return!1;const d=new Set;return!(u&&Po(d,u,f)||f&&Po(d,f,u)||u&&$o(d,u,f)||f&&$o(d,f,u))})(a,c))}function zo(n,e){const t=n.mergeWithSibling(e),r=H()._normalizedNodes;return r.add(n.__key),r.add(e.__key),t}function jo(n){let e,t,r=n;if(r.__text!==""||!r.isSimpleText()||r.isUnmergeable()){for(;(e=r.getPreviousSibling())!==null&&M(e)&&e.isSimpleText()&&!e.isUnmergeable();){if(e.__text!==""){if(Ro(e,r)){r=zo(e,r);break}break}e.remove()}for(;(t=r.getNextSibling())!==null&&M(t)&&t.isSimpleText()&&!t.isUnmergeable();){if(t.__text!==""){if(Ro(r,t)){r=zo(r,t);break}break}t.remove()}}else r.remove()}function dr(n){return Wo(n.anchor),Wo(n.focus),n}function Wo(n){for(;n.type==="element";){const e=n.getNode(),t=n.offset;let r,i;if(t===e.getChildrenSize()?(r=e.getChildAtIndex(t-1),i=!0):(r=e.getChildAtIndex(t),i=!1),M(r)){n.set(r.__key,i?r.getTextContentSize():0,"text",!0);break}if(!v(r))break;n.set(r.__key,i?r.getChildrenSize():0,"element",!0)}}let mt,se,Nn,Er,hi,gi,_t,Ce,pi,Tn,X="",we=null,ke="",ze="",Pt=!1,fr=!1;function hr(n,e){const t=_t.get(n);if(e!==null){const r=xi(n);r.parentNode===e&&e.removeChild(r)}if(Ce.has(n)||se._keyToDOMMap.delete(n),v(t)){const r=pr(t,_t);mi(r,0,r.length-1,null)}t!==void 0&&so(Tn,Nn,Er,t,"destroyed")}function mi(n,e,t,r){let i=e;for(;i<=t;++i){const o=n[i];o!==void 0&&hr(o,r)}}function ot(n,e){n.setProperty("text-align",e)}const Vc="40px";function yl(n,e){const t=mt.theme.indent;if(typeof t=="string"){const i=n.classList.contains(t);e>0&&!i?n.classList.add(t):e<1&&i&&n.classList.remove(t)}const r=getComputedStyle(n).getPropertyValue("--lexical-indent-base-value")||Vc;n.style.setProperty("padding-inline-start",e===0?"":`calc(${e} * ${r})`)}function xl(n,e){const t=n.style;e===0?ot(t,""):e===1?ot(t,"left"):e===2?ot(t,"center"):e===3?ot(t,"right"):e===4?ot(t,"justify"):e===5?ot(t,"start"):e===6&&ot(t,"end")}function _i(n,e){const t=(function(r){const i=r.__dir;if(i!==null)return i;if(G(r))return null;const o=r.getParentOrThrow();return G(o)&&o.__dir===null?"auto":null})(e);t!==null?n.dir=t:n.removeAttribute("dir")}function gr(n,e){const t=Ce.get(n);t===void 0&&E(60);const r=t.createDOM(mt,se);if((function(i,o,s){const l=s._keyToDOMMap;(function(a,c,u){const f=`__lexicalKey_${c._key}`;a[f]=u})(o,s,i),l.set(i,o)})(n,r,se),M(t)?r.setAttribute("data-lexical-text","true"):W(t)&&r.setAttribute("data-lexical-decorator","true"),v(t)){const i=t.__indent,o=t.__size;if(_i(r,t),i!==0&&yl(r,i),o!==0){const l=o-1;yi(pr(t,Ce),t,0,l,t.getDOMSlot(r))}const s=t.__format;s!==0&&xl(r,s),t.isInline()||Sl(null,t,r),Lr(t)&&(X+=et,ze+=et)}else{const i=t.getTextContent();if(W(t)){const o=t.decorate(se,mt);o!==null&&Cl(n,o),r.contentEditable="false"}X+=i,ze+=i}return e!==null&&e.insertChild(r),so(Tn,Nn,Er,t,"created"),r}function yi(n,e,t,r,i){const o=X;X="";let s=t;for(;s<=r;++s){gr(n[s],i);const l=Ce.get(n[s]);l!==null&&M(l)&&(we===null&&(we=l.getFormat()),ke===""&&(ke=l.getStyle()))}Lr(e)&&(X+=et),i.element.__lexicalTextContent=X,X=o+X}function Bo(n,e){if(n){const t=n.__last;if(t){const r=e.get(t);if(r)return ut(r)?"line-break":W(r)&&r.isInline()?"decorator":null}return"empty"}return null}function Sl(n,e,t){const r=Bo(n,_t),i=Bo(e,Ce);r!==i&&e.getDOMSlot(t).setManagedLineBreak(i)}function qc(n,e,t){var r;we=null,ke="",(function(i,o,s){const l=X,a=i.__size,c=o.__size;X="";const u=s.element;if(a===1&&c===1){const f=i.__first,d=o.__first;if(f===d)pn(f,u);else{const h=xi(f),p=gr(d,null);try{u.replaceChild(p,h)}catch(m){if(typeof m=="object"&&m!=null){const x=`${m.toString()} Parent: ${u.tagName}, new child: {tag: ${p.tagName} key: ${d}}, old child: {tag: ${h.tagName}, key: ${f}}.`;throw new Error(x)}throw m}hr(f,null)}const g=Ce.get(d);M(g)&&(we===null&&(we=g.getFormat()),ke===""&&(ke=g.getStyle()))}else{const f=pr(i,_t),d=pr(o,Ce);if(f.length!==a&&E(227),d.length!==c&&E(228),a===0)c!==0&&yi(d,o,0,c-1,s);else if(c===0){if(a!==0){const g=s.after==null&&s.before==null&&s.element.__lexicalLineBreak==null;mi(f,0,a-1,g?null:u),g&&(u.textContent="")}}else(function(g,h,p,m,x,y){const C=m-1,k=x-1;let T,b,N=y.getFirstChild(),w=0,_=0;for(;w<=C&&_<=k;){const R=h[w],$=p[_];if(R===$)N=Vr(pn($,y.element)),w++,_++;else{T===void 0&&(T=new Set(h)),b===void 0&&(b=new Set(p));const q=b.has(R),ie=T.has($);if(q)if(ie){const he=xt(se,$);he===N?N=Vr(pn($,y.element)):(y.withBefore(N).insertChild(he),pn($,y.element)),w++,_++}else gr($,y.withBefore(N)),_++;else N=Vr(xi(R)),hr(R,y.element),w++}const z=Ce.get($);z!==null&&M(z)&&(we===null&&(we=z.getFormat()),ke===""&&(ke=z.getStyle()))}const O=w>C,L=_>k;if(O&&!L){const R=p[k+1],$=R===void 0?null:se.getElementByKey(R);yi(p,g,_,k,y.withBefore($))}else L&&!O&&mi(h,w,C,y.element)})(o,f,d,a,c,s)}Lr(o)&&(X+=et),u.__lexicalTextContent=X,X=l+X})(n,e,e.getDOMSlot(t)),r=e,we==null||we===r.__textFormat||fr||r.setTextFormat(we),(function(i){ke===""||ke===i.__textStyle||fr||i.setTextStyle(ke)})(e)}function pr(n,e){const t=[];let r=n.__first;for(;r!==null;){const i=e.get(r);i===void 0&&E(101),t.push(r),r=i.__next}return t}function pn(n,e){const t=_t.get(n);let r=Ce.get(n);t!==void 0&&r!==void 0||E(61);const i=Pt||gi.has(n)||hi.has(n),o=xt(se,n);if(t===r&&!i){if(v(t)){const s=o.__lexicalTextContent;s!==void 0&&(X+=s,ze+=s)}else{const s=t.getTextContent();ze+=s,X+=s}return o}if(t!==r&&i&&so(Tn,Nn,Er,r,"updated"),r.updateDOM(t,o,mt)){const s=gr(n,null);return e===null&&E(62),e.replaceChild(s,o),hr(n,null),s}if(v(t)&&v(r)){const s=r.__indent;(Pt||s!==t.__indent)&&yl(o,s);const l=r.__format;if((Pt||l!==t.__format)&&xl(o,l),i&&(qc(t,r,o),G(r)||r.isInline()||Sl(t,r,o)),Lr(r)&&(X+=et,ze+=et),(Pt||r.__dir!==t.__dir)&&(_i(o,r),G(r)&&!Pt))for(const a of r.getChildren())v(a)&&_i(xt(se,a.getKey()),a)}else{const s=r.getTextContent();if(W(r)){const l=r.decorate(se,mt);l!==null&&Cl(n,l)}X+=s,ze+=s}if(!fr&&G(r)&&r.__cachedText!==ze){const s=r.getWritable();s.__cachedText=ze,r=s}return o}function Cl(n,e){let t=se._pendingDecorators;const r=se._decorators;if(t===null){if(r[n]===e)return;t=fa(se)}t[n]=e}function Vr(n){let e=n.nextSibling;return e!==null&&e===se._blockCursorElement&&(e=e.nextSibling),e}function Yc(n,e,t,r,i,o){X="",ze="",Pt=r===2,se=t,mt=t._config,Nn=t._nodes,Er=se._listeners.mutation,hi=i,gi=o,_t=n._nodeMap,Ce=e._nodeMap,fr=e._readOnly,pi=new Map(t._keyToDOMMap);const s=new Map;return Tn=s,pn("root",null),se=void 0,Nn=void 0,hi=void 0,gi=void 0,_t=void 0,Ce=void 0,mt=void 0,pi=void 0,Tn=void 0,s}function xi(n){const e=pi.get(n);return e===void 0&&E(75,n),e}function I(n){return{type:n}}const vl=I("SELECTION_CHANGE_COMMAND"),Gc=I("SELECTION_INSERT_CLIPBOARD_NODES_COMMAND"),bl=I("CLICK_COMMAND"),at=I("DELETE_CHARACTER_COMMAND"),Bt=I("INSERT_LINE_BREAK_COMMAND"),mr=I("INSERT_PARAGRAPH_COMMAND"),Kt=I("CONTROLLED_TEXT_INSERTION_COMMAND"),Ki=I("PASTE_COMMAND"),Si=I("REMOVE_TEXT_COMMAND"),En=I("DELETE_WORD_COMMAND"),On=I("DELETE_LINE_COMMAND"),Be=I("FORMAT_TEXT_COMMAND"),Ui=I("UNDO_COMMAND"),Ji=I("REDO_COMMAND"),Xc=I("KEYDOWN_COMMAND"),wl=I("KEY_ARROW_RIGHT_COMMAND"),Qc=I("MOVE_TO_END"),kl=I("KEY_ARROW_LEFT_COMMAND"),Zc=I("MOVE_TO_START"),Nl=I("KEY_ARROW_UP_COMMAND"),Tl=I("KEY_ARROW_DOWN_COMMAND"),_r=I("KEY_ENTER_COMMAND"),El=I("KEY_SPACE_COMMAND"),Ol=I("KEY_BACKSPACE_COMMAND"),Al=I("KEY_ESCAPE_COMMAND"),Ml=I("KEY_DELETE_COMMAND"),Dl=I("KEY_TAB_COMMAND"),eu=I("INSERT_TAB_COMMAND"),tu=I("INDENT_CONTENT_COMMAND"),Ko=I("OUTDENT_CONTENT_COMMAND"),Fl=I("DROP_COMMAND"),nu=I("FORMAT_ELEMENT_COMMAND"),Ll=I("DRAGSTART_COMMAND"),Pl=I("DRAGOVER_COMMAND"),ru=I("DRAGEND_COMMAND"),Or=I("COPY_COMMAND"),Hi=I("CUT_COMMAND"),Ci=I("SELECT_ALL_COMMAND"),iu=I("CLEAR_EDITOR_COMMAND"),ou=I("CLEAR_HISTORY_COMMAND"),Hn=I("CAN_REDO_COMMAND"),Vn=I("CAN_UNDO_COMMAND"),su=I("FOCUS_COMMAND"),lu=I("BLUR_COMMAND"),au=I("KEY_MODIFIER_COMMAND"),Le=Object.freeze({}),vi=[["keydown",function(n,e){if(_n=n.timeStamp,$l=n.key,!e.isComposing()&&!D(e,Xc,n)&&n.key!=null){if(qr&&_s(n))return me(e,()=>{qn(e,Yr)}),qr=!1,void(Yr="");if((function(t){return K(t,"ArrowRight",{shiftKey:"any"})})(n))D(e,wl,n);else if((function(t){return K(t,"ArrowRight",$e)})(n))D(e,Qc,n);else if((function(t){return K(t,"ArrowLeft",{shiftKey:"any"})})(n))D(e,kl,n);else if((function(t){return K(t,"ArrowLeft",$e)})(n))D(e,Zc,n);else if((function(t){return K(t,"ArrowUp",{altKey:"any",shiftKey:"any"})})(n))D(e,Nl,n);else if((function(t){return K(t,"ArrowDown",{altKey:"any",shiftKey:"any"})})(n))D(e,Tl,n);else if((function(t){return K(t,"Enter",{altKey:"any",ctrlKey:"any",metaKey:"any",shiftKey:!0})})(n))yn=!0,D(e,_r,n);else if((function(t){return t.key===" "})(n))D(e,El,n);else if((function(t){return Se&&K(t,"o",{ctrlKey:!0})})(n))n.preventDefault(),yn=!0,D(e,Bt,!0);else if((function(t){return K(t,"Enter",{altKey:"any",ctrlKey:"any",metaKey:"any"})})(n))yn=!1,D(e,_r,n);else if((function(t){return K(t,"Backspace",{shiftKey:"any"})||Se&&K(t,"h",{ctrlKey:!0})})(n))_s(n)?D(e,Ol,n):(n.preventDefault(),D(e,at,!0));else if((function(t){return t.key==="Escape"})(n))D(e,Al,n);else if((function(t){return K(t,"Delete",{})||Se&&K(t,"d",{ctrlKey:!0})})(n))(function(t){return t.key==="Delete"})(n)?D(e,Ml,n):(n.preventDefault(),D(e,at,!1));else if((function(t){return K(t,"Backspace",ms)})(n))n.preventDefault(),D(e,En,!0);else if((function(t){return K(t,"Delete",ms)})(n))n.preventDefault(),D(e,En,!1);else if((function(t){return Se&&K(t,"Backspace",{metaKey:!0})})(n))n.preventDefault(),D(e,On,!0);else if((function(t){return Se&&(K(t,"Delete",{metaKey:!0})||K(t,"k",{ctrlKey:!0}))})(n))n.preventDefault(),D(e,On,!1);else if((function(t){return K(t,"b",$e)})(n))n.preventDefault(),D(e,Be,"bold");else if((function(t){return K(t,"u",$e)})(n))n.preventDefault(),D(e,Be,"underline");else if((function(t){return K(t,"i",$e)})(n))n.preventDefault(),D(e,Be,"italic");else if((function(t){return K(t,"Tab",{shiftKey:"any"})})(n))D(e,Dl,n);else if((function(t){return K(t,"z",$e)})(n))n.preventDefault(),D(e,Ui,void 0);else if((function(t){return Se?K(t,"z",{metaKey:!0,shiftKey:!0}):K(t,"y",{ctrlKey:!0})||K(t,"z",{ctrlKey:!0,shiftKey:!0})})(n))n.preventDefault(),D(e,Ji,void 0);else{const t=e._editorState._selection;t===null||A(t)?ys(n)&&(n.preventDefault(),D(e,Ci,n)):(function(r){return K(r,"c",$e)})(n)?(n.preventDefault(),D(e,Or,n)):(function(r){return K(r,"x",$e)})(n)?(n.preventDefault(),D(e,Hi,n)):ys(n)&&(n.preventDefault(),D(e,Ci,n))}(function(t){return t.ctrlKey||t.shiftKey||t.altKey||t.metaKey})(n)&&D(e,au,n)}}],["pointerdown",function(n,e){const t=n.target,r=n.pointerType;on(t)&&r!=="touch"&&r!=="pen"&&n.button===0&&me(e,()=>{hs(t)||(ki=!0)})}],["compositionstart",function(n,e){me(e,()=>{const t=F();if(A(t)&&!e.isComposing()){const r=t.anchor,i=t.anchor.getNode();re(r.key),(n.timeStamp<_n+30||r.type==="element"||!t.isCollapsed()||i.getFormat()!==t.format||M(i)&&i.getStyle()!==t.style)&&D(e,Kt,Pc)}})}],["compositionend",function(n,e){gt?cn=!0:Yt||!wn&&!kn?me(e,()=>{qn(e,n.data)}):(qr=!0,Yr=n.data)}],["input",function(n,e){n.stopPropagation(),me(e,()=>{if(J(n.target)&&hs(n.target))return;const t=F(),r=n.data,i=Wl(n);if(r!=null&&A(t)&&zl(t,i,r,n.timeStamp,!1)){cn&&(qn(e,r),cn=!1);const o=t.anchor.getNode(),s=ve(xe(e));if(s===null)return;const l=t.isBackward(),a=l?t.anchor.offset:t.focus.offset,c=l?t.focus.offset:t.anchor.offset;ur&&!t.isCollapsed()&&M(o)&&s.anchorNode!==null&&o.getTextContent().slice(0,a)+r+o.getTextContent().slice(a+c)===ma(s.anchorNode)||D(e,Kt,r);const u=r.length;gt&&u>1&&n.inputType==="insertCompositionText"&&!e.isComposing()&&(t.anchor.offset-=u),wn||Yt||kn||!e.isComposing()||(_n=0,re(null))}else io(!1,e,r!==null?r:void 0),cn&&(qn(e,r||void 0),cn=!1);(function(){oe();const o=H();gl(o)})()},{event:n}),$t=null}],["click",function(n,e){me(e,()=>{const t=F(),r=ve(xe(e)),i=tn();if(r){if(A(t)){const o=t.anchor,s=o.getNode();if(o.type==="element"&&o.offset===0&&t.isCollapsed()&&!G(s)&&V().getChildrenSize()===1&&s.getTopLevelElementOrThrow().isEmpty()&&i!==null&&t.is(i))r.removeAllRanges(),t.dirty=!0;else if(n.detail===3&&!t.isCollapsed()&&s!==t.focus.getNode()){const l=ht(s,a=>v(a)&&!a.isInline());v(l)&&l.select(0)}}else if(n.pointerType==="touch"||n.pointerType==="pen"){const o=r.anchorNode;(J(o)||Je(o))&&fe(qi(i,r,e,n))}}D(e,bl,n)})}],["cut",Le],["copy",Le],["dragstart",Le],["dragover",Le],["dragend",Le],["paste",Le],["focus",Le],["blur",Le],["drop",Le]];ur&&vi.push(["beforeinput",(n,e)=>(function(t,r){const i=t.inputType,o=Wl(t);i==="deleteCompositionText"||gt&&_a(r)||i!=="insertCompositionText"&&me(r,()=>{const s=F();if(i==="deleteContentBackward"){if(s===null){const g=tn();if(!A(g))return;fe(g.clone())}if(A(s)){const g=s.anchor.key===s.focus.key;if(l=t.timeStamp,$l==="MediaLast"&&l<_n+30&&r.isComposing()&&g){if(re(null),_n=0,setTimeout(()=>{me(r,()=>{re(null)})},30),A(s)){const h=s.anchor.getNode();h.markDirty(),M(h)||E(142),jl(s,h)}}else{re(null),t.preventDefault();const h=s.anchor.getNode(),p=h.getTextContent(),m=h.canInsertTextAfter(),x=s.anchor.offset===0&&s.focus.offset===p.length;let y=Mo&&g&&!x&&m;if(y&&s.isCollapsed()&&(y=!W(Mi(s.anchor,!0))),!y){D(r,at,!0);const C=F();Mo&&A(C)&&C.isCollapsed()&&(st=C,setTimeout(()=>st=null))}}return}}var l;if(!A(s))return;const a=t.data;$t!==null&&io(!1,r,$t),s.dirty&&$t===null||!s.isCollapsed()||G(s.anchor.getNode())||o===null||s.applyDOMRange(o),$t=null;const c=s.anchor,u=s.focus,f=c.getNode(),d=u.getNode();if(i!=="insertText"&&i!=="insertTranspose")switch(t.preventDefault(),i){case"insertFromYank":case"insertFromDrop":case"insertReplacementText":D(r,Kt,t);break;case"insertFromComposition":re(null),D(r,Kt,t);break;case"insertLineBreak":re(null),D(r,Bt,!1);break;case"insertParagraph":re(null),yn&&!Yt?(yn=!1,D(r,Bt,!1)):D(r,mr,void 0);break;case"insertFromPaste":case"insertFromPasteAsQuotation":D(r,Ki,t);break;case"deleteByComposition":(function(g,h){return g!==h||v(g)||v(h)||!dt(g)||!dt(h)})(f,d)&&D(r,Si,t);break;case"deleteByDrag":case"deleteByCut":D(r,Si,t);break;case"deleteContent":D(r,at,!1);break;case"deleteWordBackward":D(r,En,!0);break;case"deleteWordForward":D(r,En,!1);break;case"deleteHardLineBackward":case"deleteSoftLineBackward":D(r,On,!0);break;case"deleteContentForward":case"deleteHardLineForward":case"deleteSoftLineForward":D(r,On,!1);break;case"formatStrikeThrough":D(r,Be,"strikethrough");break;case"formatBold":D(r,Be,"bold");break;case"formatItalic":D(r,Be,"italic");break;case"formatUnderline":D(r,Be,"underline");break;case"historyUndo":D(r,Ui,void 0);break;case"historyRedo":D(r,Ji,void 0)}else{if(a===`
`)t.preventDefault(),D(r,Bt,!1);else if(a===et)t.preventDefault(),D(r,mr,void 0);else if(a==null&&t.dataTransfer){const g=t.dataTransfer.getData("text/plain");t.preventDefault(),s.insertRawText(g)}else a!=null&&zl(s,o,a,t.timeStamp,!0)?(t.preventDefault(),D(r,Kt,a)):$t=a;Il=t.timeStamp}})})(n,e)]);let _n=0,$l=null,Il=0,$t=null;const bi=new WeakMap,yr=new WeakMap;let wi=!1,ki=!1,yn=!1,cn=!1,qr=!1,Yr="",st=null,Rl=[0,"",0,"root",0];function zl(n,e,t,r,i){const o=n.anchor,s=n.focus,l=o.getNode(),a=H(),c=ve(xe(a)),u=c!==null?c.anchorNode:null,f=o.key,d=a.getElementByKey(f),g=t.length;return f!==s.key||!M(l)||(!i&&(!ur||Il<r+50)||l.isDirty()&&g<2||ga(t))&&o.offset!==s.offset&&!l.isComposing()||Ie(l)||l.isDirty()&&g>1||(i||!ur)&&d!==null&&!l.isComposing()&&u!==Xt(d)||c!==null&&e!==null&&(!e.collapsed||e.startContainer!==c.anchorNode||e.startOffset!==c.anchorOffset)||l.getFormat()!==n.format||l.getStyle()!==n.style||(function(h,p){if(p.isSegmented())return!0;if(!h.isCollapsed())return!1;const m=h.anchor.offset,x=p.getParentOrThrow(),y=dt(p);return m===0?!p.canInsertTextBefore()||!x.canInsertTextBefore()&&!p.isComposing()||y||(function(C){const k=C.getPreviousSibling();return(M(k)||v(k)&&k.isInline())&&!k.canInsertTextAfter()})(p):m===p.getTextContentSize()&&(!p.canInsertTextAfter()||!x.canInsertTextAfter()&&!p.isComposing()||y)})(n,l)}function Uo(n,e){return Je(n)&&n.nodeValue!==null&&e!==0&&e!==n.nodeValue.length}function Jo(n,e,t){const{anchorNode:r,anchorOffset:i,focusNode:o,focusOffset:s}=n;wi&&(wi=!1,Uo(r,i)&&Uo(o,s)&&!st)||me(e,()=>{if(!t)return void fe(null);if(!$n(e,r,o))return;let l=F();if(st&&A(l)&&l.isCollapsed()){const a=l.anchor,c=st.anchor;(a.key===c.key&&a.offset===c.offset+1||a.offset===1&&c.getNode().is(a.getNode().getPreviousSibling()))&&(l=st.clone(),fe(l))}if(st=null,A(l)){const a=l.anchor,c=a.getNode();if(l.isCollapsed()){n.type==="Range"&&n.anchorNode===n.focusNode&&(l.dirty=!0);const u=xe(e).event,f=u?u.timeStamp:performance.now(),[d,g,h,p,m]=Rl,x=V(),y=e.isComposing()===!1&&x.getTextContent()==="";if(f<m+200&&a.offset===h&&a.key===p)ir(l,d,g);else if(a.type==="text")M(c)||E(141),jl(l,c);else if(a.type==="element"&&!y){v(c)||E(259);const C=a.getNode();C.isEmpty()?(function(k,T){const b=T.getTextFormat(),N=T.getTextStyle();ir(k,b,N)})(l,C):ir(l,0,"")}}else{const u=a.key,f=l.focus.key,d=l.getNodes(),g=d.length,h=l.isBackward(),p=h?s:i,m=h?i:s,x=h?f:u,y=h?u:f;let C=2047,k=!1;for(let T=0;T<g;T++){const b=d[T],N=b.getTextContentSize();if(M(b)&&N!==0&&!(T===0&&b.__key===x&&p===N||T===g-1&&b.__key===y&&m===0)&&(k=!0,C&=b.getFormat(),C===0))break}l.format=k?C:0}}D(e,vl,void 0)})}function ir(n,e,t){n.format===e&&n.style===t||(n.format=e,n.style=t,n.dirty=!0)}function jl(n,e){ir(n,e.getFormat(),e.getStyle())}function Wl(n){if(!n.getTargetRanges)return null;const e=n.getTargetRanges();return e.length===0?null:e[0]}function qn(n,e){const t=n._compositionKey;if(re(null),t!==null&&e!=null){if(e===""){const r=ne(t),i=Xt(n.getElementByKey(t));return void(i!==null&&i.nodeValue!==null&&M(r)&&oo(r,i.nodeValue,null,null,!0))}if(e[e.length-1]===`
`){const r=F();if(A(r)){const i=r.focus;return r.anchor.set(i.key,i.offset,i.type),void D(n,_r,null)}}}io(!0,n,e)}function Bl(n){let e=n.__lexicalEventHandles;return e===void 0&&(e=[],n.__lexicalEventHandles=e),e}const Ut=new Map;function Kl(n){const e=Ku(n.target);if(e===null)return;const t=ca(e.anchorNode);if(t===null)return;ki&&(ki=!1,me(t,()=>{const a=tn(),c=e.anchorNode;(J(c)||Je(c))&&fe(qi(a,e,t,n))}));const r=ro(t),i=r[r.length-1],o=i._key,s=Ut.get(o),l=s||i;l!==t&&Jo(e,l,!1),Jo(e,t,!0),t!==i?Ut.set(o,t):s&&Ut.delete(o)}function Ho(n){n._lexicalHandled=!0}function Vo(n){return n._lexicalHandled===!0}function cu(n){const e=bi.get(n);if(e===void 0)return;const t=yr.get(e);if(t===void 0)return;const r=t-1;r>=0||E(164),bi.delete(n),yr.set(e,r),r===0&&e.removeEventListener("selectionchange",Kl);const i=Dr(n);no(i)?((function(s){if(s._parentEditor!==null){const l=ro(s),a=l[l.length-1]._key;Ut.get(a)===s&&Ut.delete(a)}else Ut.delete(s._key)})(i),n.__lexicalEditor=null):i&&E(198);const o=Bl(n);for(let s=0;s<o.length;s++)o[s]();n.__lexicalEventHandles=[]}function Ni(n,e,t){oe();const r=n.__key,i=n.getParent();if(i===null)return;const o=(function(l){const a=F();if(!A(a)||!v(l))return a;const{anchor:c,focus:u}=a,f=c.getNode(),d=u.getNode();return Di(f,l)&&c.set(l.__key,0,"element"),Di(d,l)&&u.set(l.__key,0,"element"),a})(n);let s=!1;if(A(o)&&e){const l=o.anchor,a=o.focus;l.key===r&&(Cr(l,n,i,n.getPreviousSibling(),n.getNextSibling()),s=!0),a.key===r&&(Cr(a,n,i,n.getPreviousSibling(),n.getNextSibling()),s=!0)}else pe(o)&&e&&n.isSelected()&&n.selectPrevious();if(A(o)&&e&&!s){const l=n.getIndexWithinParent();ft(n),Sr(o,i,l,-1)}else ft(n);t||He(i)||i.canBeEmpty()||!i.isEmpty()||Ni(i,e),e&&o&&G(i)&&i.isEmpty()&&i.selectEnd()}const Ul=Symbol.for("ephemeral");function xr(n){return n[Ul]||!1}class Oe{__type;__key;__parent;__prev;__next;__state;static getType(){const{ownNodeType:e}=$r(this);return e===void 0&&E(64,this.name),e}static clone(e){E(65,this.name)}$config(){return{}}config(e,t){const r=t.extends||Object.getPrototypeOf(this.constructor);return Object.assign(t,{extends:r,type:e}),{[e]:t}}afterCloneFrom(e){this.__key===e.__key?(this.__parent=e.__parent,this.__next=e.__next,this.__prev=e.__prev,this.__state=e.__state):e.__state&&(this.__state=e.__state.getWritable(this))}static importDOM;constructor(e){this.__type=this.constructor.getType(),this.__parent=null,this.__prev=null,this.__next=null,Object.defineProperty(this,"__state",{configurable:!0,enumerable:!1,value:void 0,writable:!0}),Pu(this,e)}getType(){return this.__type}isInline(){E(137,this.constructor.name)}isAttached(){let e=this.__key;for(;e!==null;){if(e==="root")return!0;const t=ne(e);if(t===null)break;e=t.__parent}return!1}isSelected(e){const t=e||F();if(t==null)return!1;const r=t.getNodes().some(i=>i.__key===this.__key);if(M(this))return r;if(A(t)&&t.anchor.type==="element"&&t.focus.type==="element"){if(t.isCollapsed())return!1;const i=this.getParent();if(W(this)&&this.isInline()&&i){const o=t.isBackward()?t.focus:t.anchor;if(i.is(o.getNode())&&o.offset===i.getChildrenSize()&&this.is(i.getLastChild()))return!1}}return r}getKey(){return this.__key}getIndexWithinParent(){const e=this.getParent();if(e===null)return-1;let t=e.getFirstChild(),r=0;for(;t!==null;){if(this.is(t))return r;r++,t=t.getNextSibling()}return-1}getParent(){const e=this.getLatest().__parent;return e===null?null:ne(e)}getParentOrThrow(){const e=this.getParent();return e===null&&E(66,this.__key),e}getTopLevelElement(){let e=this;for(;e!==null;){const t=e.getParent();if(He(t))return v(e)||e===this&&W(e)||E(194),e;e=t}return null}getTopLevelElementOrThrow(){const e=this.getTopLevelElement();return e===null&&E(67,this.__key),e}getParents(){const e=[];let t=this.getParent();for(;t!==null;)e.push(t),t=t.getParent();return e}getParentKeys(){const e=[];let t=this.getParent();for(;t!==null;)e.push(t.__key),t=t.getParent();return e}getPreviousSibling(){const e=this.getLatest().__prev;return e===null?null:ne(e)}getPreviousSiblings(){const e=[],t=this.getParent();if(t===null)return e;let r=t.getFirstChild();for(;r!==null&&!r.is(this);)e.push(r),r=r.getNextSibling();return e}getNextSibling(){const e=this.getLatest().__next;return e===null?null:ne(e)}getNextSiblings(){const e=[];let t=this.getNextSibling();for(;t!==null;)e.push(t),t=t.getNextSibling();return e}getCommonAncestor(e){const t=v(this)?this:this.getParent(),r=v(e)?e:e.getParent(),i=t&&r?sr(t,r):null;return i?i.commonAncestor:null}is(e){return e!=null&&this.__key===e.__key}isBefore(e){const t=sr(this,e);return t!==null&&(t.type==="descendant"||(t.type==="branch"?va(t)===-1:(t.type!=="same"&&t.type!=="ancestor"&&E(279),!1)))}isParentOf(e){const t=sr(this,e);return t!==null&&t.type==="ancestor"}getNodesBetween(e){const t=this.isBefore(e),r=[],i=new Set;let o=this;for(;o!==null;){const s=o.__key;if(i.has(s)||(i.add(s),r.push(o)),o===e)break;const l=v(o)?t?o.getFirstChild():o.getLastChild():null;if(l!==null){o=l;continue}const a=t?o.getNextSibling():o.getPreviousSibling();if(a!==null){o=a;continue}const c=o.getParentOrThrow();if(i.has(c.__key)||r.push(c),c===e)break;let u=null,f=c;do{if(f===null&&E(68),u=t?f.getNextSibling():f.getPreviousSibling(),f=f.getParent(),f===null)break;u!==null||i.has(f.__key)||r.push(f)}while(u===null);o=u}return t||r.reverse(),r}isDirty(){const e=H()._dirtyLeaves;return e!==null&&e.has(this.__key)}getLatest(){if(xr(this))return this;const e=ne(this.__key);return e===null&&E(113),e}getWritable(){if(xr(this))return this;oe();const e=it(),t=H(),r=e._nodeMap,i=this.__key,o=this.getLatest(),s=t._cloneNotNeeded,l=F();if(l!==null&&l.setCachedNodes(null),s.has(i))return br(o),o;const a=Sa(o);return s.add(i),br(a),r.set(i,a),a}getTextContent(){return""}getTextContentSize(){return this.getTextContent().length}createDOM(e,t){E(70)}updateDOM(e,t,r){E(71)}exportDOM(e){return{element:this.createDOM(e._config,e)}}exportJSON(){const e=this.__state?this.__state.toJSON():void 0;return{type:this.__type,version:1,...e}}static importJSON(e){E(18,this.name)}updateFromJSON(e){return(function(t,r){const i=t.getWritable(),o=r.$;let s=o;for(const l of _l(i).flatKeys)l in r&&(s!==void 0&&s!==o||(s={...o}),s[l]=r[l]);return(i.__state||s)&&Hc(t).updateFromJSON(s),i})(this,e)}static transform(){return null}remove(e){Ni(this,!0,e)}replace(e,t){oe();let r=F();r!==null&&(r=r.clone()),ti(this,e);const i=this.getLatest(),o=this.__key,s=e.__key,l=e.getWritable(),a=this.getParentOrThrow().getWritable(),c=a.__size;ft(l);const u=i.getPreviousSibling(),f=i.getNextSibling(),d=i.__prev,g=i.__next,h=i.__parent;if(Ni(i,!1,!0),u===null?a.__first=s:u.getWritable().__next=s,l.__prev=d,f===null?a.__last=s:f.getWritable().__prev=s,l.__next=g,l.__parent=h,a.__size=c,t&&(v(this)&&v(l)||E(139),this.getChildren().forEach(p=>{l.append(p)})),A(r)){fe(r);const p=r.anchor,m=r.focus;p.key===o&&Xo(p,l),m.key===o&&Xo(m,l)}return Ge()===o&&re(s),l}insertAfter(e,t=!0){oe(),ti(this,e);const r=this.getWritable(),i=e.getWritable(),o=i.getParent(),s=F();let l=!1,a=!1;if(o!==null){const g=e.getIndexWithinParent();if(ft(i),A(s)){const h=o.__key,p=s.anchor,m=s.focus;l=p.type==="element"&&p.key===h&&p.offset===g+1,a=m.type==="element"&&m.key===h&&m.offset===g+1}}const c=this.getNextSibling(),u=this.getParentOrThrow().getWritable(),f=i.__key,d=r.__next;if(c===null?u.__last=f:c.getWritable().__prev=f,u.__size++,r.__next=f,i.__next=d,i.__prev=r.__key,i.__parent=r.__parent,t&&A(s)){const g=this.getIndexWithinParent();Sr(s,u,g+1);const h=u.__key;l&&s.anchor.set(h,g+2,"element"),a&&s.focus.set(h,g+2,"element")}return e}insertBefore(e,t=!0){oe(),ti(this,e);const r=this.getWritable(),i=e.getWritable(),o=i.__key;ft(i);const s=this.getPreviousSibling(),l=this.getParentOrThrow().getWritable(),a=r.__prev,c=this.getIndexWithinParent();s===null?l.__first=o:s.getWritable().__next=o,l.__size++,r.__prev=o,i.__prev=a,i.__next=r.__key,i.__parent=r.__parent;const u=F();return t&&A(u)&&Sr(u,this.getParentOrThrow(),c),e}isParentRequired(){return!1}createParentElementNode(){return Q()}selectStart(){return this.selectPrevious()}selectEnd(){return this.selectNext(0,0)}selectPrevious(e,t){oe();const r=this.getPreviousSibling(),i=this.getParentOrThrow();if(r===null)return i.select(0,0);if(v(r))return r.select();if(!M(r)){const o=r.getIndexWithinParent()+1;return i.select(o,o)}return r.select(e,t)}selectNext(e,t){oe();const r=this.getNextSibling(),i=this.getParentOrThrow();if(r===null)return i.select();if(v(r))return r.select(0,0);if(!M(r)){const o=r.getIndexWithinParent();return i.select(o,o)}return r.select(e,t)}markDirty(){this.getWritable()}reconcileObservedMutation(e,t){this.markDirty()}}const Ti="historic",uu="history-push",ct="history-merge",du="paste",fu="collaboration",hu="skip-scroll-into-view",gu="skip-dom-selection",pu="skip-selection-focus";class Zt extends Oe{static getType(){return"linebreak"}static clone(e){return new Zt(e.__key)}constructor(e){super(e)}getTextContent(){return`
`}createDOM(){return document.createElement("br")}updateDOM(){return!1}isInline(){return!0}static importDOM(){return{br:e=>(function(t){const r=t.parentElement;if(r!==null&&wr(r)){const i=r.firstChild;if(i===t||i.nextSibling===t&&Yn(i)){const o=r.lastChild;if(o===t||o.previousSibling===t&&Yn(o))return!0}}return!1})(e)||(function(t){const r=t.parentElement;if(r!==null&&wr(r)){const i=r.firstChild;if(i===t||i.nextSibling===t&&Yn(i))return!1;const o=r.lastChild;if(o===t||o.previousSibling===t&&Yn(o))return!0}return!1})(e)?null:{conversion:mu,priority:0}}}static importJSON(e){return yt().updateFromJSON(e)}}function mu(n){return{node:yt()}}function yt(){return ye(new Zt)}function ut(n){return n instanceof Zt}function Yn(n){return Je(n)&&/^( |\t|\r?\n)+$/.test(n.textContent||"")}function Gr(n,e){return 16&e?"code":e&dl?"mark":32&e?"sub":64&e?"sup":null}function Xr(n,e){return 1&e?"strong":2&e?"em":"span"}function Jl(n,e,t,r,i){const o=r.classList;let s=Jt(i,"base");s!==void 0&&o.add(...s),s=Jt(i,"underlineStrikethrough");let l=!1;const a=8&e&&4&e;s!==void 0&&(8&t&&4&t?(l=!0,a||o.add(...s)):a&&o.remove(...s));for(const c in pt){const u=pt[c];if(s=Jt(i,c),s!==void 0)if(t&u){if(l&&(c==="underline"||c==="strikethrough")){e&u&&o.remove(...s);continue}((e&u)===0||a&&c==="underline"||c==="strikethrough")&&o.add(...s)}else e&u&&o.remove(...s)}}function Hl(n,e,t){const r=e.firstChild,i=t.isComposing(),o=n+(i?Tr:"");if(r==null)e.textContent=o;else{const s=r.nodeValue;if(s!==o)if(i||gt){const[l,a,c]=(function(u,f){const d=u.length,g=f.length;let h=0,p=0;for(;h<d&&h<g&&u[h]===f[h];)h++;for(;p+h<d&&p+h<g&&u[d-p-1]===f[g-p-1];)p++;return[h,d-h-p,f.slice(h,g-p)]})(s,o);a!==0&&r.deleteData(l,a),r.insertData(l,c)}else r.nodeValue=o}}function qo(n,e,t,r,i,o){Hl(i,n,e);const s=o.theme.text;s!==void 0&&Jl(0,0,r,n,s)}function Gn(n,e){const t=document.createElement(e);return t.appendChild(n),t}class kt extends Oe{__text;__format;__style;__mode;__detail;static getType(){return"text"}static clone(e){return new kt(e.__text,e.__key)}afterCloneFrom(e){super.afterCloneFrom(e),this.__text=e.__text,this.__format=e.__format,this.__style=e.__style,this.__mode=e.__mode,this.__detail=e.__detail}constructor(e="",t){super(t),this.__text=e,this.__format=0,this.__style="",this.__mode=0,this.__detail=0}getFormat(){return this.getLatest().__format}getDetail(){return this.getLatest().__detail}getMode(){const e=this.getLatest();return zc[e.__mode]}getStyle(){return this.getLatest().__style}isToken(){return this.getLatest().__mode===1}isComposing(){return this.__key===Ge()}isSegmented(){return this.getLatest().__mode===2}isDirectionless(){return!!(1&this.getLatest().__detail)}isUnmergeable(){return!!(2&this.getLatest().__detail)}hasFormat(e){const t=pt[e];return(this.getFormat()&t)!==0}isSimpleText(){return this.__type==="text"&&this.__mode===0}getTextContent(){return this.getLatest().__text}getFormatFlags(e,t){return vr(this.getLatest().__format,e,t)}canHaveFormat(){return!0}isInline(){return!0}createDOM(e,t){const r=this.__format,i=Gr(0,r),o=Xr(0,r),s=i===null?o:i,l=document.createElement(s);let a=l;this.hasFormat("code")&&l.setAttribute("spellcheck","false"),i!==null&&(a=document.createElement(o),l.appendChild(a)),qo(a,this,0,r,this.__text,e);const c=this.__style;return c!==""&&(l.style.cssText=c),l}updateDOM(e,t,r){const i=this.__text,o=e.__format,s=this.__format,l=Gr(0,o),a=Gr(0,s),c=Xr(0,o),u=Xr(0,s);if((l===null?c:l)!==(a===null?u:a))return!0;if(l===a&&c!==u){const p=t.firstChild;p==null&&E(48);const m=document.createElement(u);return qo(m,this,0,s,i,r),t.replaceChild(m,p),!1}let f=t;a!==null&&l!==null&&(f=t.firstChild,f==null&&E(49)),Hl(i,f,this);const d=r.theme.text;d!==void 0&&o!==s&&Jl(0,o,s,f,d);const g=e.__style,h=this.__style;return g!==h&&(t.style.cssText=h),!1}static importDOM(){return{"#text":()=>({conversion:Su,priority:0}),b:()=>({conversion:yu,priority:0}),code:()=>({conversion:Pe,priority:0}),em:()=>({conversion:Pe,priority:0}),i:()=>({conversion:Pe,priority:0}),mark:()=>({conversion:Pe,priority:0}),s:()=>({conversion:Pe,priority:0}),span:()=>({conversion:_u,priority:0}),strong:()=>({conversion:Pe,priority:0}),sub:()=>({conversion:Pe,priority:0}),sup:()=>({conversion:Pe,priority:0}),u:()=>({conversion:Pe,priority:0})}}static importJSON(e){return Z().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setTextContent(e.text).setFormat(e.format).setDetail(e.detail).setMode(e.mode).setStyle(e.style)}exportDOM(e){let{element:t}=super.exportDOM(e);return J(t)||E(132),t.style.whiteSpace="pre-wrap",this.hasFormat("lowercase")?t.style.textTransform="lowercase":this.hasFormat("uppercase")?t.style.textTransform="uppercase":this.hasFormat("capitalize")&&(t.style.textTransform="capitalize"),this.hasFormat("bold")&&(t=Gn(t,"b")),this.hasFormat("italic")&&(t=Gn(t,"i")),this.hasFormat("strikethrough")&&(t=Gn(t,"s")),this.hasFormat("underline")&&(t=Gn(t,"u")),{element:t}}exportJSON(){return{detail:this.getDetail(),format:this.getFormat(),mode:this.getMode(),style:this.getStyle(),text:this.getTextContent(),...super.exportJSON()}}selectionTransform(e,t){}setFormat(e){const t=this.getWritable();return t.__format=typeof e=="string"?pt[e]:e,t}setDetail(e){const t=this.getWritable();return t.__detail=typeof e=="string"?$c[e]:e,t}setStyle(e){const t=this.getWritable();return t.__style=e,t}toggleFormat(e){const t=vr(this.getFormat(),e,null);return this.setFormat(t)}toggleDirectionless(){const e=this.getWritable();return e.__detail^=1,e}toggleUnmergeable(){const e=this.getWritable();return e.__detail^=2,e}setMode(e){const t=Rc[e];if(this.__mode===t)return this;const r=this.getWritable();return r.__mode=t,r}setTextContent(e){if(this.__text===e)return this;const t=this.getWritable();return t.__text=e,t}select(e,t){oe();let r=e,i=t;const o=F(),s=this.getTextContent(),l=this.__key;if(typeof s=="string"){const a=s.length;r===void 0&&(r=a),i===void 0&&(i=a)}else r=0,i=0;if(!A(o))return Gl(l,r,l,i,"text","text");{const a=Ge();a!==o.anchor.key&&a!==o.focus.key||re(l),o.setTextNodeRange(this,r,this,i)}return o}selectStart(){return this.select(0,0)}selectEnd(){const e=this.getTextContentSize();return this.select(e,e)}spliceText(e,t,r,i){const o=this.getWritable(),s=o.__text,l=r.length;let a=e;a<0&&(a=l+a,a<0&&(a=0));const c=F();if(i&&A(c)){const f=e+l;c.setTextNodeRange(o,f,o,f)}const u=s.slice(0,a)+r+s.slice(a+t);return o.__text=u,o}canInsertTextBefore(){return!0}canInsertTextAfter(){return!0}splitText(...e){oe();const t=this.getLatest(),r=t.getTextContent();if(r==="")return[];const i=t.__key,o=Ge(),s=r.length;e.sort((w,_)=>w-_),e.push(s);const l=[],a=e.length;for(let w=0,_=0;w<s&&_<=a;_++){const O=e[_];O>w&&(l.push(r.slice(w,O)),w=O)}const c=l.length;if(c===1)return[t];const u=l[0],f=t.getParent();let d;const g=t.getFormat(),h=t.getStyle(),p=t.__detail;let m=!1,x=null,y=null;const C=F();if(A(C)){const[w,_]=C.isBackward()?[C.focus,C.anchor]:[C.anchor,C.focus];w.type==="text"&&w.key===i&&(x=w),_.type==="text"&&_.key===i&&(y=_)}t.isSegmented()?(d=Z(u),d.__format=g,d.__style=h,d.__detail=p,d.__state=Io(t,d),m=!0):d=t.setTextContent(u);const k=[d];for(let w=1;w<c;w++){const _=Z(l[w]);_.__format=g,_.__style=h,_.__detail=p,_.__state=Io(t,_);const O=_.__key;o===i&&re(O),k.push(_)}const T=x?x.offset:null,b=y?y.offset:null;let N=0;for(const w of k){if(!x&&!y)break;const _=N+w.getTextContentSize();if(x!==null&&T!==null&&T<=_&&T>=N&&(x.set(w.getKey(),T-N,"text"),T<_&&(x=null)),y!==null&&b!==null&&b<=_&&b>=N){y.set(w.getKey(),b-N,"text");break}N=_}if(f!==null){(function(O){const L=O.getPreviousSibling(),R=O.getNextSibling();L!==null&&br(L),R!==null&&br(R)})(this);const w=f.getWritable(),_=this.getIndexWithinParent();m?(w.splice(_,0,k),this.remove()):w.splice(_,1,k),A(C)&&Sr(C,f,_,c-1)}return k}mergeWithSibling(e){const t=e===this.getPreviousSibling();t||e===this.getNextSibling()||E(50);const r=this.__key,i=e.__key,o=this.__text,s=o.length;Ge()===i&&re(r);const l=F();if(A(l)){const f=l.anchor,d=l.focus;f!==null&&f.key===i&&is(f,t,r,e,s),d!==null&&d.key===i&&is(d,t,r,e,s)}const a=e.__text,c=t?a+o:o+a;this.setTextContent(c);const u=this.getWritable();return e.remove(),u}isTextEntity(){return!1}}function _u(n){return{forChild:Vi(n.style),node:null}}function yu(n){const e=n,t=e.style.fontWeight==="normal";return{forChild:Vi(e.style,t?void 0:"bold"),node:null}}const Yo=new WeakMap;function xu(n){if(!J(n))return!1;if(n.nodeName==="PRE")return!0;const e=n.style.whiteSpace;return typeof e=="string"&&e.startsWith("pre")}function Su(n){const e=n;n.parentElement===null&&E(129);let t=e.textContent||"";if((function(r){let i,o=r.parentNode;const s=[r];for(;o!==null&&(i=Yo.get(o))===void 0&&!xu(o);)s.push(o),o=o.parentNode;const l=i===void 0?o:i;for(let a=0;a<s.length;a++)Yo.set(s[a],l);return l})(e)!==null){const r=t.split(/(\r?\n|\t)/),i=[],o=r.length;for(let s=0;s<o;s++){const l=r[s];l===`
`||l===`\r
`?i.push(yt()):l==="	"?i.push(Fn()):l!==""&&i.push(Z(l))}return{node:i}}if(t=t.replace(/\r/g,"").replace(/[ \t\n]+/g," "),t==="")return{node:null};if(t[0]===" "){let r=e,i=!0;for(;r!==null&&(r=Go(r,!1))!==null;){const o=r.textContent||"";if(o.length>0){/[ \t\n]$/.test(o)&&(t=t.slice(1)),i=!1;break}}i&&(t=t.slice(1))}if(t[t.length-1]===" "){let r=e,i=!0;for(;r!==null&&(r=Go(r,!0))!==null;)if((r.textContent||"").replace(/^( |\t|\r?\n)+/,"").length>0){i=!1;break}i&&(t=t.slice(0,t.length-1))}return t===""?{node:null}:{node:Z(t)}}function Go(n,e){let t=n;for(;;){let r;for(;(r=e?t.nextSibling:t.previousSibling)===null;){const o=t.parentElement;if(o===null)return null;t=o}if(t=r,J(t)){const o=t.style.display;if(o===""&&!Pi(t)||o!==""&&!o.startsWith("inline"))return null}let i=t;for(;(i=e?t.firstChild:t.lastChild)!==null;)t=i;if(Je(t))return t;if(t.nodeName==="BR")return null}}const Cu={code:"code",em:"italic",i:"italic",mark:"highlight",s:"strikethrough",strong:"bold",sub:"subscript",sup:"superscript",u:"underline"};function Pe(n){const e=Cu[n.nodeName.toLowerCase()];return e===void 0?{node:null}:{forChild:Vi(n.style,e),node:null}}function Z(n=""){return ye(new kt(n))}function M(n){return n instanceof kt}function Vi(n,e){const t=n.fontWeight,r=n.textDecoration.split(" "),i=t==="700"||t==="bold",o=r.includes("line-through"),s=n.fontStyle==="italic",l=r.includes("underline"),a=n.verticalAlign;return c=>(M(c)&&(i&&!c.hasFormat("bold")&&c.toggleFormat("bold"),o&&!c.hasFormat("strikethrough")&&c.toggleFormat("strikethrough"),s&&!c.hasFormat("italic")&&c.toggleFormat("italic"),l&&!c.hasFormat("underline")&&c.toggleFormat("underline"),a!=="sub"||c.hasFormat("subscript")||c.toggleFormat("subscript"),a!=="super"||c.hasFormat("superscript")||c.toggleFormat("superscript"),e&&!c.hasFormat(e)&&c.toggleFormat(e)),c)}class en extends kt{static getType(){return"tab"}static clone(e){return new en(e.__key)}constructor(e){super("	",e),this.__detail=2}static importDOM(){return null}createDOM(e){const t=super.createDOM(e),r=Jt(e.theme,"tab");return r!==void 0&&t.classList.add(...r),t}static importJSON(e){return Fn().updateFromJSON(e)}setTextContent(e){return e!=="	"&&e!==""&&al(126),super.setTextContent("	")}spliceText(e,t,r,i){return r===""&&t===0||r==="	"&&t===1||E(286),this}setDetail(e){return e!==2&&E(127),this}setMode(e){return e!=="normal"&&E(128),this}canInsertTextBefore(){return!1}canInsertTextAfter(){return!1}}function Fn(){return ye(new en)}function Vl(n){return n instanceof en}class vu{key;offset;type;_selection;constructor(e,t,r){this._selection=null,this.key=e,this.offset=t,this.type=r}is(e){return this.key===e.key&&this.offset===e.offset&&this.type===e.type}isBefore(e){return this.key===e.key?this.offset<e.offset:Ca(Ee(Ue(this,"next")),Ee(Ue(e,"next")))<0}getNode(){const e=ne(this.key);return e===null&&E(20),e}set(e,t,r,i){const o=this._selection,s=this.key;i&&this.key===e&&this.offset===t&&this.type===r||(this.key=e,this.offset=t,this.type=r,Ln()||(Ge()===s&&re(e),o!==null&&(o.setCachedNodes(null),o.dirty=!0)))}}function Me(n,e,t){return new vu(n,e,t)}function Qr(n,e){let t=e.__key,r=n.offset,i="element";if(M(e)){i="text";const o=e.getTextContentSize();r>o&&(r=o)}else if(!v(e)){const o=e.getNextSibling();if(M(o))t=o.__key,r=0,i="text";else{const s=e.getParent();s&&(t=s.__key,r=e.getIndexWithinParent()+1)}}n.set(t,r,i)}function Xo(n,e){if(v(e)){const t=e.getLastDescendant();v(t)||M(t)?Qr(n,t):Qr(n,e)}else Qr(n,e)}class Ar{_nodes;_cachedNodes;dirty;constructor(e){this._cachedNodes=null,this._nodes=e,this.dirty=!1}getCachedNodes(){return this._cachedNodes}setCachedNodes(e){this._cachedNodes=e}is(e){if(!pe(e))return!1;const t=this._nodes,r=e._nodes;return t.size===r.size&&Array.from(t).every(i=>r.has(i))}isCollapsed(){return!1}isBackward(){return!1}getStartEndPoints(){return null}add(e){this.dirty=!0,this._nodes.add(e),this._cachedNodes=null}delete(e){this.dirty=!0,this._nodes.delete(e),this._cachedNodes=null}clear(){this.dirty=!0,this._nodes.clear(),this._cachedNodes=null}has(e){return this._nodes.has(e)}clone(){return new Ar(new Set(this._nodes))}extract(){return this.getNodes()}insertRawText(e){}insertText(){}insertNodes(e){const t=this.getNodes(),r=t.length,i=t[r-1];let o;if(M(i))o=i.select();else{const s=i.getIndexWithinParent()+1;o=i.getParentOrThrow().select(s,s)}o.insertNodes(e);for(let s=0;s<r;s++)t[s].remove()}getNodes(){const e=this._cachedNodes;if(e!==null)return e;const t=this._nodes,r=[];for(const i of t){const o=ne(i);o!==null&&r.push(o)}return Ln()||(this._cachedNodes=r),r}getTextContent(){const e=this.getNodes();let t="";for(let r=0;r<e.length;r++)t+=e[r].getTextContent();return t}deleteNodes(){const e=this.getNodes();if((F()||tn())===this&&e[0]){const t=le(e[0],"next");nd(nt(t,t))}for(const t of e)t.remove()}}function A(n){return n instanceof Nt}class Nt{format;style;anchor;focus;_cachedNodes;dirty;constructor(e,t,r,i){this.anchor=e,this.focus=t,e._selection=this,t._selection=this,this._cachedNodes=null,this.format=r,this.style=i,this.dirty=!1}getCachedNodes(){return this._cachedNodes}setCachedNodes(e){this._cachedNodes=e}is(e){return!!A(e)&&this.anchor.is(e.anchor)&&this.focus.is(e.focus)&&this.format===e.format&&this.style===e.style}isCollapsed(){return this.anchor.is(this.focus)}getNodes(){const e=this._cachedNodes;if(e!==null)return e;const t=(function(r){const i=[],[o,s]=r.getTextSlices();o&&i.push(o.caret.origin);const l=new Set,a=new Set;for(const c of r)if(Ae(c)){const{origin:u}=c;i.length===0?l.add(u):(a.add(u),i.push(u))}else{const{origin:u}=c;v(u)&&a.has(u)||i.push(u)}if(s&&i.push(s.caret.origin),vt(r.focus)&&v(r.focus.origin)&&r.focus.getNodeAtCaret()===null)for(let c=De(r.focus.origin,"previous");Ae(c)&&l.has(c.origin)&&!c.origin.isEmpty()&&c.origin.is(i[i.length-1]);c=fo(c))l.delete(c.origin),i.pop();for(;i.length>1;){const c=i[i.length-1];if(!v(c)||a.has(c)||c.isEmpty()||l.has(c))break;i.pop()}if(i.length===0&&r.isCollapsed()){const c=Ee(r.anchor),u=Ee(r.anchor.getFlipped()),f=g=>Xe(g)?g.origin:g.getNodeAtCaret(),d=f(c)||f(u)||(r.anchor.getNodeAtCaret()?c.origin:u.origin);i.push(d)}return i})(wa(ws(this),"next"));return Ln()||(this._cachedNodes=t),t}setTextNodeRange(e,t,r,i){this.anchor.set(e.__key,t,"text"),this.focus.set(r.__key,i,"text")}getTextContent(){const e=this.getNodes();if(e.length===0)return"";const t=e[0],r=e[e.length-1],i=this.anchor,o=this.focus,s=i.isBefore(o),[l,a]=Ei(this);let c="",u=!0;for(let f=0;f<e.length;f++){const d=e[f];if(v(d)&&!d.isInline())u||(c+=`
`),u=!d.isEmpty();else if(u=!1,M(d)){let g=d.getTextContent();d===t?d===r?i.type==="element"&&o.type==="element"&&o.offset!==i.offset||(g=l<a?g.slice(l,a):g.slice(a,l)):g=s?g.slice(l):g.slice(a):d===r&&(g=s?g.slice(0,a):g.slice(0,l)),c+=g}else!W(d)&&!ut(d)||d===r&&this.isCollapsed()||(c+=d.getTextContent())}return c}applyDOMRange(e){const t=H(),r=t.getEditorState()._selection,i=Yl(e.startContainer,e.startOffset,e.endContainer,e.endOffset,t,r);if(i===null)return;const[o,s]=i;this.anchor.set(o.key,o.offset,o.type,!0),this.focus.set(s.key,s.offset,s.type,!0),dr(this)}clone(){const e=this.anchor,t=this.focus;return new Nt(Me(e.key,e.offset,e.type),Me(t.key,t.offset,t.type),this.format,this.style)}toggleFormat(e){this.format=vr(this.format,e,null),this.dirty=!0}setFormat(e){this.format=e,this.dirty=!0}setStyle(e){this.style=e,this.dirty=!0}hasFormat(e){const t=pt[e];return(this.format&t)!==0}insertRawText(e){const t=e.split(/(\r?\n|\t)/),r=[],i=t.length;for(let o=0;o<i;o++){const s=t[o];s===`
`||s===`\r
`?r.push(yt()):s==="	"?r.push(Fn()):r.push(Z(s))}this.insertNodes(r)}insertText(e){const t=this.anchor,r=this.focus,i=this.format,o=this.style;let s=t,l=r;!this.isCollapsed()&&r.isBefore(t)&&(s=r,l=t),s.type==="element"&&(function(m,x,y,C){const k=m.getNode(),T=k.getChildAtIndex(m.offset),b=Z();if(b.setFormat(y),b.setStyle(C),Qi(T))T.splice(0,0,[b]);else{const N=G(k)?Q().append(b):b;T===null?k.append(N):T.insertBefore(N)}m.is(x)&&x.set(b.__key,0,"text"),m.set(b.__key,0,"text")})(s,l,i,o),l.type==="element"&&Mn(l,Ee(Ue(l,"next")));const a=s.offset;let c=l.offset;const u=this.getNodes(),f=u.length;let d=u[0];M(d)||E(26);const g=d.getTextContent().length,h=d.getParentOrThrow();let p=u[f-1];if(f===1&&l.type==="element"&&(c=g,l.set(s.key,c,"text")),this.isCollapsed()&&a===g&&(Ie(d)||!d.canInsertTextAfter()||!h.canInsertTextAfter()&&d.getNextSibling()===null)){let m=d.getNextSibling();if(M(m)&&m.canInsertTextBefore()&&!Ie(m)||(m=Z(),m.setFormat(i),m.setStyle(o),h.canInsertTextAfter()?d.insertAfter(m):h.insertAfter(m)),m.select(0,0),d=m,e!=="")return void this.insertText(e)}else if(this.isCollapsed()&&a===0&&(Ie(d)||!d.canInsertTextBefore()||!h.canInsertTextBefore()&&d.getPreviousSibling()===null)){let m=d.getPreviousSibling();if(M(m)&&!Ie(m)||(m=Z(),m.setFormat(i),h.canInsertTextBefore()?d.insertBefore(m):h.insertBefore(m)),m.select(),d=m,e!=="")return void this.insertText(e)}else if(d.isSegmented()&&a!==g){const m=Z(d.getTextContent());m.setFormat(i),d.replace(m),d=m}else if(!this.isCollapsed()&&e!==""){const m=p.getParent();if(!h.canInsertTextBefore()||!h.canInsertTextAfter()||v(m)&&(!m.canInsertTextBefore()||!m.canInsertTextAfter()))return this.insertText(""),ql(this.anchor,this.focus,null),void this.insertText(e)}if(f===1){if(dt(d)){const C=Z(e);return C.select(),void d.replace(C)}const m=d.getFormat(),x=d.getStyle();if(a!==c||m===i&&x===o){if(Vl(d)){const C=Z(e);return C.setFormat(i),C.setStyle(o),C.select(),void d.replace(C)}}else{if(d.getTextContent()!==""){const C=Z(e);if(C.setFormat(i),C.setStyle(o),C.select(),a===0)d.insertBefore(C,!1);else{const[k]=d.splitText(a);k.insertAfter(C,!1)}return void(C.isComposing()&&this.anchor.type==="text"&&(this.anchor.offset-=e.length))}d.setFormat(i),d.setStyle(o)}const y=c-a;d=d.spliceText(a,y,e,!0),d.getTextContent()===""?d.remove():this.anchor.type==="text"&&(d.isComposing()?this.anchor.offset-=e.length:(this.format=m,this.style=x))}else{const m=new Set([...d.getParentKeys(),...p.getParentKeys()]),x=v(d)?d:d.getParentOrThrow();let y=v(p)?p:p.getParentOrThrow(),C=p;if(!x.is(y)&&y.isInline())do C=y,y=y.getParentOrThrow();while(y.isInline());if(l.type==="text"&&(c!==0||p.getTextContent()==="")||l.type==="element"&&p.getIndexWithinParent()<c)if(M(p)&&!dt(p)&&c!==p.getTextContentSize()){if(p.isSegmented()){const w=Z(p.getTextContent());p.replace(w),p=w}G(l.getNode())||l.type!=="text"||(p=p.spliceText(0,c,"")),m.add(p.__key)}else{const w=p.getParentOrThrow();w.canBeEmpty()||w.getChildrenSize()!==1?p.remove():w.remove()}else m.add(p.__key);const k=y.getChildren(),T=new Set(u),b=x.is(y),N=x.isInline()&&d.getNextSibling()===null?x:d;for(let w=k.length-1;w>=0;w--){const _=k[w];if(_.is(d)||v(_)&&_.isParentOf(d))break;_.isAttached()&&(!T.has(_)||_.is(C)?b||N.insertAfter(_,!1):_.remove())}if(!b){let w=y,_=null;for(;w!==null;){const O=w.getChildren(),L=O.length;(L===0||O[L-1].is(_))&&(m.delete(w.__key),_=w),w=w.getParent()}}if(dt(d))if(a===g)d.select();else{const w=Z(e);w.select(),d.replace(w)}else d=d.spliceText(a,g-a,e,!0),d.getTextContent()===""?d.remove():d.isComposing()&&this.anchor.type==="text"&&(this.anchor.offset-=e.length);for(let w=1;w<f;w++){const _=u[w],O=_.__key;m.has(O)||_.remove()}}}removeText(){const e=F()===this;lr(this,rd(ws(this))),e&&F()!==this&&fe(this)}formatText(e,t=null){if(this.isCollapsed())return this.toggleFormat(e),void re(null);const r=this.getNodes(),i=[];for(const k of r)M(k)&&i.push(k);const o=k=>{r.forEach(T=>{if(v(T)){const b=T.getFormatFlags(e,k);T.setTextFormat(b)}})},s=i.length;if(s===0)return this.toggleFormat(e),re(null),void o(t);const l=this.anchor,a=this.focus,c=this.isBackward(),u=c?a:l,f=c?l:a;let d=0,g=i[0],h=u.type==="element"?0:u.offset;if(u.type==="text"&&h===g.getTextContentSize()&&(d=1,g=i[1],h=0),g==null)return;const p=g.getFormatFlags(e,t);o(p);const m=s-1;let x=i[m];const y=f.type==="text"?f.offset:x.getTextContentSize();if(g.is(x)){if(h===y)return;if(Ie(g)||h===0&&y===g.getTextContentSize())g.setFormat(p);else{const k=g.splitText(h,y),T=h===0?k[0]:k[1];T.setFormat(p),u.type==="text"&&u.set(T.__key,0,"text"),f.type==="text"&&f.set(T.__key,y-h,"text")}return void(this.format=p)}h===0||Ie(g)||([,g]=g.splitText(h),h=0),g.setFormat(p);const C=x.getFormatFlags(e,p);y>0&&(y===x.getTextContentSize()||Ie(x)||([x]=x.splitText(y)),x.setFormat(C));for(let k=d+1;k<m;k++){const T=i[k],b=T.getFormatFlags(e,C);T.setFormat(b)}u.type==="text"&&u.set(g.__key,h,"text"),f.type==="text"&&f.set(x.__key,y,"text"),this.format=p|C}insertNodes(e){if(e.length===0)return;if(this.isCollapsed()||this.removeText(),this.anchor.key==="root"){this.insertParagraph();const h=F();return A(h)||E(134),h.insertNodes(e)}const t=(this.isBackward()?this.focus:this.anchor).getNode(),r=ht(t,Ye),i=e[e.length-1];if(v(r)&&"__language"in r){if("__language"in e[0])this.insertText(e[0].getTextContent());else{const h=Zr(this);r.splice(h,0,e),i.selectEnd()}return}if(!e.some(h=>(v(h)||W(h))&&!h.isInline())){v(r)||E(211,t.constructor.name,t.getType());const h=Zr(this);return r.splice(h,0,e),void i.selectEnd()}const o=(function(h){const p=Q();let m=null;for(let x=0;x<h.length;x++){const y=h[x],C=ut(y);if(C||W(y)&&y.isInline()||v(y)&&y.isInline()||M(y)||y.isParentRequired()){if(m===null&&(m=y.createParentElementNode(),p.append(m),C))continue;m!==null&&m.append(y)}else p.append(y),m=null}return p})(e),s=o.getLastDescendant(),l=o.getChildren(),a=!v(r)||!r.isEmpty()?this.insertParagraph():null,c=l[l.length-1];let u=l[0];var f;v(f=u)&&Ye(f)&&!f.isEmpty()&&v(r)&&(!r.isEmpty()||r.canMergeWhenEmpty())&&(v(r)||E(211,t.constructor.name,t.getType()),r.append(...u.getChildren()),u=l[1]),u&&(r===null&&E(212,t.constructor.name,t.getType()),(function(h,p){const m=p.getParentOrThrow().getLastChild();let x=p;const y=[p];for(;x!==m;)x.getNextSibling()||E(140),x=x.getNextSibling(),y.push(x);let C=h;for(const k of y)C=C.insertAfter(k)})(r,u));const d=ht(s,Ye);a&&v(d)&&(a.canMergeWhenEmpty()||Ye(c))&&(d.append(...a.getChildren()),a.remove()),v(r)&&r.isEmpty()&&r.remove(),s.selectEnd();const g=v(r)?r.getLastChild():null;ut(g)&&d!==r&&g.remove()}insertParagraph(){if(this.anchor.key==="root"){const s=Q();return V().splice(this.anchor.offset,0,[s]),s.select(),s}const e=Zr(this),t=ht(this.anchor.getNode(),Ye);v(t)||E(213);const r=t.getChildAtIndex(e),i=r?[r,...r.getNextSiblings()]:[],o=t.insertNewAfter(this,!1);return o?(o.append(...i),o.selectStart(),o):null}insertLineBreak(e){const t=yt();if(this.insertNodes([t]),e){const r=t.getParentOrThrow(),i=t.getIndexWithinParent();r.select(i,i)}}extract(){const e=[...this.getNodes()],t=e.length;let r=e[0],i=e[t-1];const[o,s]=Ei(this),l=this.isBackward(),[a,c]=l?[this.focus,this.anchor]:[this.anchor,this.focus],[u,f]=l?[s,o]:[o,s];if(t===0)return[];if(t===1){if(M(r)&&!this.isCollapsed()){const d=r.splitText(u,f),g=u===0?d[0]:d[1];return g?(a.set(g.getKey(),0,"text"),c.set(g.getKey(),g.getTextContentSize(),"text"),[g]):[]}return[r]}if(M(r)&&(u===r.getTextContentSize()?e.shift():u!==0&&([,r]=r.splitText(u),e[0]=r,a.set(r.getKey(),0,"text"))),M(i)){const d=i.getTextContent().length;f===0?e.pop():f!==d&&([i]=i.splitText(f),e[e.length-1]=i,c.set(i.getKey(),i.getTextContentSize(),"text"))}return e}modify(e,t,r){if(os(this,e,t,r))return;const i=e==="move",o=H(),s=ve(xe(o));if(!s)return;const l=o._blockCursorElement,a=o._rootElement,c=this.focus.getNode();if(a===null||l===null||!v(c)||c.isInline()||c.canBeEmpty()||Fi(l,o,a),this.dirty){let u=xt(o,this.anchor.key),f=xt(o,this.focus.key);this.anchor.type==="text"&&(u=Xt(u)),this.focus.type==="text"&&(f=Xt(f)),u&&f&&Zl(s,u,this.anchor.offset,f,this.focus.offset)}if((function(u,f,d,g){u.modify(f,d,g)})(s,e,t?"backward":"forward",r),s.rangeCount>0){const u=s.getRangeAt(0),f=this.anchor.getNode(),d=G(f)?f:Wu(f);if(this.applyDOMRange(u),this.dirty=!0,!i){const g=this.getNodes(),h=[];let p=!1;for(let m=0;m<g.length;m++){const x=g[m];Di(x,d)?h.push(x):p=!0}if(p&&h.length>0)if(t){const m=h[0];v(m)?m.selectStart():m.getParentOrThrow().selectStart()}else{const m=h[h.length-1];v(m)?m.selectEnd():m.getParentOrThrow().selectEnd()}s.anchorNode===u.startContainer&&s.anchorOffset===u.startOffset||(function(m){const x=m.focus,y=m.anchor,C=y.key,k=y.offset,T=y.type;y.set(x.key,x.offset,x.type,!0),x.set(C,k,T,!0)})(this)}}r==="lineboundary"&&os(this,e,t,r,"decorators")}forwardDeletion(e,t,r){if(!r&&(e.type==="element"&&v(t)&&e.offset===t.getChildrenSize()||e.type==="text"&&e.offset===t.getTextContentSize())){const i=t.getParent(),o=t.getNextSibling()||(i===null?null:i.getNextSibling());if(v(o)&&o.isShadowRoot())return!0}return!1}deleteCharacter(e){const t=this.isCollapsed();if(this.isCollapsed()){const r=this.anchor;let i=r.getNode();if(this.forwardDeletion(r,i,e))return;const o=go(Ue(r,e?"previous":"next"));if(o.getTextSlices().every(l=>l===null||l.distance===0)){let l={type:"initial"};for(const a of o.iterNodeCarets("shadowRoot"))if(Ae(a)){if(!a.origin.isInline()){if(a.origin.isShadowRoot()){if(l.type==="merge-block")break;if(v(o.anchor.origin)&&o.anchor.origin.isEmpty()){const c=Ee(a);lr(this,nt(c,c)),o.anchor.origin.remove()}return}l.type!=="merge-next-block"&&l.type!=="merge-block"||(l={block:l.block,caret:a,type:"merge-block"})}}else{if(l.type==="merge-block")break;if(vt(a)){if(v(a.origin)){if(a.origin.isInline()){if(!a.origin.isParentOf(o.anchor.origin))break}else l={block:a.origin,type:"merge-next-block"};continue}if(W(a.origin)){if(!a.origin.isIsolated())if(l.type==="merge-next-block"&&(a.origin.isKeyboardSelectable()||!a.origin.isInline())&&v(o.anchor.origin)&&o.anchor.origin.isEmpty()){o.anchor.origin.remove();const c=Ql();c.add(a.origin.getKey()),fe(c)}else a.origin.remove();return}break}}if(l.type==="merge-block"){const{caret:a,block:c}=l;return lr(this,nt(!a.origin.isEmpty()&&c.isEmpty()?mo(le(c,a.direction)):o.anchor,a)),this.removeText()}}const s=this.focus;if(this.modify("extend",e,"character"),this.isCollapsed()){if(e&&r.offset===0&&Zo(this,r.getNode()))return}else{const l=s.type==="text"?s.getNode():null;if(i=r.type==="text"?r.getNode():null,l!==null&&l.isSegmented()){const a=s.offset,c=l.getTextContentSize();if(l.is(i)||e&&a!==c||!e&&a!==0)return void es(l,e,a)}else if(i!==null&&i.isSegmented()){const a=r.offset,c=i.getTextContentSize();if(i.is(l)||e&&a!==0||!e&&a!==c)return void es(i,e,a)}(function(a,c){const u=a.anchor,f=a.focus,d=u.getNode(),g=f.getNode();if(d===g&&u.type==="text"&&f.type==="text"){const h=u.offset,p=f.offset,m=h<p,x=m?h:p,y=m?p:h,C=y-1;x!==C&&(function(k){return!(ga(k)||bu(k))})(d.getTextContent().slice(x,y))&&(c?f.set(f.key,C,f.type):u.set(u.key,C,u.type))}})(this,e)}}if(this.removeText(),e&&!t&&this.isCollapsed()&&this.anchor.type==="element"&&this.anchor.offset===0){const r=this.anchor.getNode();r.isEmpty()&&G(r.getParent())&&r.getPreviousSibling()===null&&Zo(this,r)}}deleteLine(e){this.isCollapsed()&&this.modify("extend",e,"lineboundary"),this.isCollapsed()?this.deleteCharacter(e):this.removeText()}deleteWord(e){if(this.isCollapsed()){const t=this.anchor,r=t.getNode();if(this.forwardDeletion(t,r,e))return;this.modify("extend",e,"word")}this.removeText()}isBackward(){return this.focus.isBefore(this.anchor)}getStartEndPoints(){return[this.anchor,this.focus]}}function pe(n){return n instanceof Ar}function Qo(n){const e=n.offset;if(n.type==="text")return e;const t=n.getNode();return e===t.getChildrenSize()?t.getTextContent().length:0}function Ei(n){const e=n.getStartEndPoints();if(e===null)return[0,0];const[t,r]=e;return t.type==="element"&&r.type==="element"&&t.key===r.key&&t.offset===r.offset?[0,0]:[Qo(t),Qo(r)]}function Zo(n,e){for(let t=e;t;t=t.getParent()){if(v(t)){if(t.collapseAtStart(n))return!0;if(He(t))break}if(t.getPreviousSibling())break}return!1}const bu=(()=>{try{const n=new RegExp("\\p{Emoji}","u"),e=n.test.bind(n);if(e("❤️")&&e("#️⃣")&&e("👍"))return e}catch{}return()=>!1})();function es(n,e,t){const r=n,i=r.getTextContent().split(/(?=\s)/g),o=i.length;let s=0,l=0;for(let c=0;c<o;c++){const u=c===o-1;if(l=s,s+=i[c].length,e&&s===t||s>t||u){i.splice(c,1),u&&(l=void 0);break}}const a=i.join("").trim();a===""?r.remove():(r.setTextContent(a),r.select(l,l))}function ts(n,e,t,r){let i,o=e;if(J(n)){let s=!1;const l=n.childNodes,a=l.length,c=r._blockCursorElement;o===a&&(s=!0,o=a-1);let u=l[o],f=!1;if(u===c)u=l[o+1],f=!0;else if(c!==null){const d=c.parentNode;n===d&&e>Array.prototype.indexOf.call(d.children,c)&&o--}if(i=jt(u),M(i))o=Qe(i,s?"next":"previous");else{let d=jt(n);if(d===null)return null;if(v(d)){const g=r.getElementByKey(d.getKey());g===null&&E(214),[d,o]=d.getDOMSlot(g).resolveChildIndex(d,g,n,e),v(d)||E(215),s&&o>=d.getChildrenSize()&&(o=Math.max(0,d.getChildrenSize()-1));let p=d.getChildAtIndex(o);if(v(p)&&(function(m,x,y){const C=m.getParent();return y===null||C===null||!C.canBeEmpty()||C!==y.getNode()})(p,0,t)){const m=s?p.getLastDescendant():p.getFirstDescendant();m===null?d=p:(p=m,d=v(p)?p:p.getParentOrThrow()),o=0}M(p)?(i=p,d=null,o=Qe(p,s?"next":"previous")):p!==d&&s&&!f&&(v(d)||E(216),o=Math.min(d.getChildrenSize(),o+1))}else{const g=d.getIndexWithinParent();o=e===0&&W(d)&&jt(n)===d?g:g+1,d=d.getParentOrThrow()}if(v(d))return Me(d.__key,o,"element")}}else i=jt(n);return M(i)?Me(i.__key,Qe(i,o,"clamp"),"text"):null}function ns(n,e,t){const r=n.offset,i=n.getNode();if(r===0){const o=i.getPreviousSibling(),s=i.getParent();if(e){if((t||!e)&&o===null&&v(s)&&s.isInline()){const l=s.getPreviousSibling();M(l)&&n.set(l.__key,l.getTextContent().length,"text")}}else v(o)&&!t&&o.isInline()?n.set(o.__key,o.getChildrenSize(),"element"):M(o)&&n.set(o.__key,o.getTextContent().length,"text")}else if(r===i.getTextContent().length){const o=i.getNextSibling(),s=i.getParent();if(e&&v(o)&&o.isInline())n.set(o.__key,0,"element");else if((t||e)&&o===null&&v(s)&&s.isInline()&&!s.canInsertTextAfter()){const l=s.getNextSibling();M(l)&&n.set(l.__key,0,"text")}}}function ql(n,e,t){if(n.type==="text"&&e.type==="text"){const r=n.isBefore(e),i=n.is(e);ns(n,r,i),ns(e,!r,i),i&&e.set(n.key,n.offset,n.type);const o=H();if(o.isComposing()&&o._compositionKey!==n.key&&A(t)){const s=t.anchor,l=t.focus;n.set(s.key,s.offset,s.type,!0),e.set(l.key,l.offset,l.type,!0)}}}function Yl(n,e,t,r,i,o){if(n===null||t===null||!$n(i,n,t))return null;const s=ts(n,e,A(o)?o.anchor:null,i);if(s===null)return null;const l=ts(t,r,A(o)?o.focus:null,i);if(l===null)return null;if(s.type==="element"&&l.type==="element"){const a=jt(n),c=jt(t);if(W(a)&&W(c))return null}return ql(s,l,o),[s,l]}function Oi(n){return v(n)&&!n.isInline()}function Gl(n,e,t,r,i,o){const s=it(),l=new Nt(Me(n,e,i),Me(t,r,o),0,"");return l.dirty=!0,s._selection=l,l}function Xl(){const n=Me("root",0,"element"),e=Me("root",0,"element");return new Nt(n,e,0,"")}function Ql(){return new Ar(new Set)}function qi(n,e,t,r){const i=t._window;if(i===null)return null;const o=r||i.event,s=o?o.type:void 0,l=s==="selectionchange",a=!fi&&(l||s==="beforeinput"||s==="compositionstart"||s==="compositionend"||s==="click"&&o&&o.detail===3||s==="drop"||s===void 0);let c,u,f,d;if(A(n)&&!a)return n.clone();if(e===null)return null;if(c=e.anchorNode,u=e.focusNode,f=e.anchorOffset,d=e.focusOffset,(l||s===void 0)&&A(n)&&!$n(t,c,u))return n.clone();const g=Yl(c,f,u,d,t,n);if(g===null)return null;const[h,p]=g;return new Nt(h,p,A(n)?n.format:0,A(n)?n.style:"")}function F(){return it()._selection}function tn(){return H()._editorState._selection}function Sr(n,e,t,r=1){const i=n.anchor,o=n.focus,s=i.getNode(),l=o.getNode();if(!e.is(s)&&!e.is(l))return;const a=e.__key;if(n.isCollapsed()){const c=i.offset;if(t<=c&&r>0||t<c&&r<0){const u=Math.max(0,c+r);i.set(a,u,"element"),o.set(a,u,"element"),rs(n)}}else{const c=n.isBackward(),u=c?o:i,f=u.getNode(),d=c?i:o,g=d.getNode();if(e.is(f)){const h=u.offset;(t<=h&&r>0||t<h&&r<0)&&u.set(a,Math.max(0,h+r),"element")}if(e.is(g)){const h=d.offset;(t<=h&&r>0||t<h&&r<0)&&d.set(a,Math.max(0,h+r),"element")}}rs(n)}function rs(n){const e=n.anchor,t=e.offset,r=n.focus,i=r.offset,o=e.getNode(),s=r.getNode();if(n.isCollapsed()){if(!v(o))return;const l=o.getChildrenSize(),a=t>=l,c=a?o.getChildAtIndex(l-1):o.getChildAtIndex(t);if(M(c)){let u=0;a&&(u=c.getTextContentSize()),e.set(c.__key,u,"text"),r.set(c.__key,u,"text")}return}if(v(o)){const l=o.getChildrenSize(),a=t>=l,c=a?o.getChildAtIndex(l-1):o.getChildAtIndex(t);if(M(c)){let u=0;a&&(u=c.getTextContentSize()),e.set(c.__key,u,"text")}}if(v(s)){const l=s.getChildrenSize(),a=i>=l,c=a?s.getChildAtIndex(l-1):s.getChildAtIndex(i);if(M(c)){let u=0;a&&(u=c.getTextContentSize()),r.set(c.__key,u,"text")}}}function Cr(n,e,t,r,i){let o=null,s=0,l=null;r!==null?(o=r.__key,M(r)?(s=r.getTextContentSize(),l="text"):v(r)&&(s=r.getChildrenSize(),l="element")):i!==null&&(o=i.__key,M(i)?l="text":v(i)&&(l="element")),o!==null&&l!==null?n.set(o,s,l):(s=e.getIndexWithinParent(),s===-1&&(s=t.getChildrenSize()),n.set(t.__key,s,"element"))}function is(n,e,t,r,i){n.type==="text"?n.set(t,n.offset+(e?0:i),"text"):n.offset>r.getIndexWithinParent()&&n.set(n.key,n.offset-1,"element")}function Zl(n,e,t,r,i){try{n.setBaseAndExtent(e,t,r,i)}catch{}}function wu(n,e,t,r,i,o,s){const l=r.anchorNode,a=r.focusNode,c=r.anchorOffset,u=r.focusOffset,f=document.activeElement;if(i.has(fu)&&f!==o||f!==null&&to(f))return;if(!A(e))return void(n!==null&&$n(t,l,a)&&r.removeAllRanges());const d=e.anchor,g=e.focus,h=d.key,p=g.key,m=xt(t,h),x=xt(t,p),y=d.offset,C=g.offset,k=e.format,T=e.style,b=e.isCollapsed();let N=m,w=x,_=!1;if(d.type==="text"){N=Xt(m);const q=d.getNode();_=q.getFormat()!==k||q.getStyle()!==T}else A(n)&&n.anchor.type==="text"&&(_=!0);var O,L,R,$,z;if(g.type==="text"&&(w=Xt(x)),N!==null&&w!==null&&(b&&(n===null||_||A(n)&&(n.format!==k||n.style!==T))&&(O=k,L=T,R=y,$=h,z=performance.now(),Rl=[O,L,R,$,z]),c!==y||u!==C||l!==N||a!==w||r.type==="Range"&&b||(f!==null&&o.contains(f)||i.has(pu)||o.focus({preventScroll:!0}),d.type==="element"))){if(Zl(r,N,y,w,C),!i.has(hu)&&e.isCollapsed()&&o!==null&&o===document.activeElement){const q=A(e)&&e.anchor.type==="element"?N.childNodes[y]||null:r.rangeCount>0?r.getRangeAt(0):null;if(q!==null){let ie;if(q instanceof Text){const he=document.createRange();he.selectNode(q),ie=he.getBoundingClientRect()}else ie=q.getBoundingClientRect();(function(he,Et,Fe){const ln=ya(Fe),ko=lo(ln);if(ln===null||ko===null)return;let{top:Br,bottom:Kr}=Et,Wn=0,Bn=0,qe=Fe;for(;qe!==null;){const Ur=qe===ln.body;if(Ur)Wn=0,Bn=xe(he).innerHeight;else{const Kn=qe.getBoundingClientRect();Wn=Kn.top,Bn=Kn.bottom}let an=0;if(Br<Wn?an=-(Wn-Br):Kr>Bn&&(an=Kr-Bn),an!==0)if(Ur)ko.scrollBy(0,an);else{const Kn=qe.scrollTop;qe.scrollTop+=an;const No=qe.scrollTop-Kn;Br-=No,Kr-=No}if(Ur)break;qe=In(qe)}})(t,ie,o)}}wi=!0}}function ku(n){let e=F()||tn();e===null&&(e=V().selectEnd()),e.insertNodes(n)}function Zr(n){let e=n;n.isCollapsed()||e.removeText();const t=F();A(t)&&(e=t),A(e)||E(161);const r=e.anchor;let i=r.getNode(),o=r.offset;for(;!Ye(i);){const s=i;if([i,o]=Nu(i,o),s.is(i))break}return o}function Nu(n,e){const t=n.getParent();if(!t){const i=Q();return V().append(i),i.select(),[V(),0]}if(M(n)){const i=n.splitText(e);if(i.length===0)return[t,n.getIndexWithinParent()];const o=e===0?0:1;return[t,i[0].getIndexWithinParent()+o]}if(!v(n)||e===0)return[t,n.getIndexWithinParent()];const r=n.getChildAtIndex(e);if(r){const i=new Nt(Me(n.__key,e,"element"),Me(n.__key,e,"element"),0,""),o=n.insertNewAfter(i);o&&o.append(r,...r.getNextSiblings())}return[t,n.getIndexWithinParent()+1]}function os(n,e,t,r,i="decorators-and-blocks"){if(e==="move"&&r==="character"&&!n.isCollapsed()){const[u,f]=t===n.isBackward()?[n.focus,n.anchor]:[n.anchor,n.focus];return f.set(u.key,u.offset,u.type),!0}const o=Ue(n.focus,t?"previous":"next"),s=r==="lineboundary",l=e==="move";let a=o,c=i==="decorators-and-blocks";if(!ba(a)){for(const u of a){c=!1;const{origin:f}=u;if(!W(f)||f.isIsolated()||(a=u,!s||!f.isInline()))break}if(c)for(const u of go(o).iterNodeCarets(e==="extend"?"shadowRoot":"root")){if(Ae(u))u.origin.isInline()||(a=u);else{if(v(u.origin))continue;W(u.origin)&&!u.origin.isInline()&&(a=u)}break}}if(a===o)return!1;if(l&&!s&&W(a.origin)&&a.origin.isKeyboardSelectable()){const u=Ql();return u.add(a.origin.getKey()),fe(u),!0}return a=Ee(a),l&&Mn(n.anchor,a),Mn(n.focus,a),c||!s}let ee=null,te=null,de=!1,ei=!1,or=0;const ss={characterData:!0,childList:!0,subtree:!0};function Ln(){return de||ee!==null&&ee._readOnly}function oe(){de&&E(13)}function ea(){or>99&&E(14)}function it(){return ee===null&&E(195,ta()),ee}function H(){return te===null&&E(196,ta()),te}function ta(){let n=0;const e=new Set,t=Gt.version;if(typeof window<"u")for(const i of document.querySelectorAll("[contenteditable]")){const o=Dr(i);if(no(o))n++;else if(o){let s=String(o.constructor.version||"<0.17.1");s===t&&(s+=" (separately built, likely a bundler configuration issue)"),e.add(s)}}let r=` Detected on the page: ${n} compatible editor(s) with version ${t}`;return e.size&&(r+=` and incompatible editors with versions ${Array.from(e).join(", ")}`),r}function Tu(){return te}function ls(n,e,t){const r=e.__type,i=aa(n,r);let o=t.get(r);o===void 0&&(o=Array.from(i.transforms),t.set(r,o));const s=o.length;for(let l=0;l<s&&(o[l](e),e.isAttached());l++);}function as(n,e){return n!==void 0&&n.__key!==e&&n.isAttached()}function na(n,e){if(!e)return;const t=n._updateTags;let r=e;Array.isArray(e)||(r=[e]);for(const i of r)t.add(i)}function Eu(n){return Yi(n,H()._nodes)}function Yi(n,e){const t=n.type,r=e.get(t);r===void 0&&E(17,t);const i=r.klass;n.type!==i.getType()&&E(18,i.name);const o=i.importJSON(n),s=n.children;if(v(o)&&Array.isArray(s))for(let l=0;l<s.length;l++){const a=Yi(s[l],e);o.append(a)}return o}function cs(n,e,t){const r=ee,i=de,o=te;ee=e,de=!0,te=n;try{return t()}finally{ee=r,de=i,te=o}}function je(n,e){const t=n._pendingEditorState,r=n._rootElement,i=n._headless||r===null;if(t===null)return;const o=n._editorState,s=o._selection,l=t._selection,a=n._dirtyType!==0,c=ee,u=de,f=te,d=n._updating,g=n._observer;let h=null;if(n._pendingEditorState=null,n._editorState=t,!i&&a&&g!==null){te=n,ee=t,de=!1,n._updating=!0;try{const b=n._dirtyType,N=n._dirtyElements,w=n._dirtyLeaves;g.disconnect(),h=Yc(o,t,n,b,N,w)}catch(b){if(b instanceof Error&&n._onError(b),ei)throw b;return sa(n,null,r,t),pl(n),n._dirtyType=2,ei=!0,je(n,o),void(ei=!1)}finally{g.observe(r,ss),n._updating=d,ee=c,de=u,te=f}}t._readOnly||(t._readOnly=!0);const p=n._dirtyLeaves,m=n._dirtyElements,x=n._normalizedNodes,y=n._updateTags,C=n._deferred;a&&(n._dirtyType=0,n._cloneNotNeeded.clear(),n._dirtyLeaves=new Set,n._dirtyElements=new Map,n._normalizedNodes=new Set,n._updateTags=new Set),(function(b,N){const w=b._decorators;let _=b._pendingDecorators||w;const O=N._nodeMap;let L;for(L in _)O.has(L)||(_===w&&(_=fa(b)),delete _[L])})(n,t);const k=i?null:ve(xe(n));if(n._editable&&k!==null&&(a||l===null||l.dirty||!l.is(s))&&r!==null&&!y.has(gu)){te=n,ee=t;try{if(g!==null&&g.disconnect(),a||l===null||l.dirty){const b=n._blockCursorElement;b!==null&&Fi(b,n,r),wu(s,l,n,k,y,r)}(function(b,N,w){let _=b._blockCursorElement;if(A(w)&&w.isCollapsed()&&w.anchor.type==="element"&&N.contains(document.activeElement)){const O=w.anchor,L=O.getNode(),R=O.offset;let $=!1,z=null;if(R===L.getChildrenSize())ni(L.getChildAtIndex(R-1))&&($=!0);else{const q=L.getChildAtIndex(R);if(q!==null&&ni(q)){const ie=q.getPreviousSibling();(ie===null||ni(ie))&&($=!0,z=b.getElementByKey(q.__key))}}if($){const q=b.getElementByKey(L.__key);return _===null&&(b._blockCursorElement=_=(function(ie){const he=ie.theme,Et=document.createElement("div");Et.contentEditable="false",Et.setAttribute("data-lexical-cursor","true");let Fe=he.blockCursor;if(Fe!==void 0){if(typeof Fe=="string"){const ln=ul(Fe);Fe=he.blockCursor=ln}Fe!==void 0&&Et.classList.add(...Fe)}return Et})(b._config)),N.style.caretColor="transparent",void(z===null?q.appendChild(_):q.insertBefore(_,z))}}_!==null&&Fi(_,b,N)})(n,r,l)}finally{g!==null&&g.observe(r,ss),te=f,ee=c}}h!==null&&(function(b,N,w,_,O){const L=Array.from(b._listeners.mutation),R=L.length;for(let $=0;$<R;$++){const[z,q]=L[$];for(const ie of q){const he=N.get(ie);he!==void 0&&z(he,{dirtyLeaves:_,prevEditorState:O,updateTags:w})}}})(n,h,y,p,o),A(l)||l===null||s!==null&&s.is(l)||n.dispatchCommand(vl,void 0);const T=n._pendingDecorators;T!==null&&(n._decorators=T,n._pendingDecorators=null,xn("decorator",n,!0,T)),(function(b,N,w){const _=gs(N),O=gs(w);_!==O&&xn("textcontent",b,!0,O)})(n,e||o,t),xn("update",n,!0,{dirtyElements:m,dirtyLeaves:p,editorState:t,mutatedNodes:h,normalizedNodes:x,prevEditorState:e||o,tags:y}),(function(b,N){if(b._deferred=[],N.length!==0){const w=b._updating;b._updating=!0;try{for(let _=0;_<N.length;_++)N[_]()}finally{b._updating=w}}})(n,C),(function(b){const N=b._updates;if(N.length!==0){const w=N.shift();if(w){const[_,O]=w;Mr(b,_,O)}}})(n)}function xn(n,e,t,...r){const i=e._updating;e._updating=t;try{const o=Array.from(e._listeners[n]);for(let s=0;s<o.length;s++)o[s].apply(null,r)}finally{e._updating=i}}function us(n,e){const t=n._updates;let r=e||!1;for(;t.length!==0;){const i=t.shift();if(i){const[o,s]=i,l=n._pendingEditorState;let a;s!==void 0&&(a=s.onUpdate,s.skipTransforms&&(r=!0),s.discrete&&(l===null&&E(191),l._flushSync=!0),a&&n._deferred.push(a),na(n,s.tag)),l==null?Mr(n,o,s):o()}}return r}function Mr(n,e,t){const r=n._updateTags;let i,o=!1,s=!1;t!==void 0&&(i=t.onUpdate,na(n,t.tag),o=t.skipTransforms||!1,s=t.discrete||!1),i&&n._deferred.push(i);const l=n._editorState;let a=n._pendingEditorState,c=!1;(a===null||a._readOnly)&&(a=n._pendingEditorState=ia(a||l),c=!0),a._flushSync=s;const u=ee,f=de,d=te,g=n._updating;ee=a,de=!1,n._updating=!0,te=n;const h=n._headless||n.getRootElement()===null;Zi(null);try{c&&(h?l._selection!==null&&(a._selection=l._selection.clone()):a._selection=(function(y,C){const k=y.getEditorState()._selection,T=ve(xe(y));return A(k)||k==null?qi(k,T,y,C):k.clone()})(n,t&&t.event||null));const m=n._compositionKey;e(),o=us(n,o),(function(y,C){const k=C.getEditorState()._selection,T=y._selection;if(A(T)){const b=T.anchor,N=T.focus;let w;if(b.type==="text"&&(w=b.getNode(),w.selectionTransform(k,T)),N.type==="text"){const _=N.getNode();w!==_&&_.selectionTransform(k,T)}}})(a,n),n._dirtyType!==0&&(o?(function(y,C){const k=C._dirtyLeaves,T=y._nodeMap;for(const b of k){const N=T.get(b);M(N)&&N.isAttached()&&N.isSimpleText()&&!N.isUnmergeable()&&jo(N)}})(a,n):(function(y,C){const k=C._dirtyLeaves,T=C._dirtyElements,b=y._nodeMap,N=Ge(),w=new Map;let _=k,O=_.size,L=T,R=L.size;for(;O>0||R>0;){if(O>0){C._dirtyLeaves=new Set;for(const $ of _){const z=b.get($);M(z)&&z.isAttached()&&z.isSimpleText()&&!z.isUnmergeable()&&jo(z),z!==void 0&&as(z,N)&&ls(C,z,w),k.add($)}if(_=C._dirtyLeaves,O=_.size,O>0){or++;continue}}C._dirtyLeaves=new Set,C._dirtyElements=new Map,L.delete("root")&&L.set("root",!0);for(const $ of L){const z=$[0],q=$[1];if(T.set(z,q),!q)continue;const ie=b.get(z);ie!==void 0&&as(ie,N)&&ls(C,ie,w)}_=C._dirtyLeaves,O=_.size,L=C._dirtyElements,R=L.size,or++}C._dirtyLeaves=k,C._dirtyElements=T})(a,n),us(n),(function(y,C,k,T){const b=y._nodeMap,N=C._nodeMap,w=[];for(const[_]of T){const O=N.get(_);O!==void 0&&(O.isAttached()||(v(O)&&fl(O,_,b,N,w,T),b.has(_)||T.delete(_),w.push(_)))}for(const _ of w)N.delete(_);for(const _ of k){const O=N.get(_);O===void 0||O.isAttached()||(b.has(_)||k.delete(_),N.delete(_))}})(l,a,n._dirtyLeaves,n._dirtyElements)),m!==n._compositionKey&&(a._flushSync=!0);const x=a._selection;if(A(x)){const y=a._nodeMap,C=x.anchor.key,k=x.focus.key;y.get(C)!==void 0&&y.get(k)!==void 0||E(19)}else pe(x)&&x._nodes.size===0&&(a._selection=null)}catch(m){return m instanceof Error&&n._onError(m),n._pendingEditorState=l,n._dirtyType=2,n._cloneNotNeeded.clear(),n._dirtyLeaves=new Set,n._dirtyElements.clear(),void je(n)}finally{ee=u,de=f,te=d,n._updating=g,or=0}n._dirtyType!==0||n._deferred.length>0||(function(m,x){const y=x.getEditorState()._selection,C=m._selection;if(C!==null){if(C.dirty||!C.is(y))return!0}else if(y!==null)return!0;return!1})(a,n)?a._flushSync?(a._flushSync=!1,je(n)):c&&Lu(()=>{je(n)}):(a._flushSync=!1,c&&(r.clear(),n._deferred=[],n._pendingEditorState=null))}function me(n,e,t){te===n&&t===void 0?e():Mr(n,e,t)}class Sn{element;before;after;constructor(e,t,r){this.element=e,this.before=t||null,this.after=r||null}withBefore(e){return new Sn(this.element,e,this.after)}withAfter(e){return new Sn(this.element,this.before,e)}withElement(e){return this.element===e?this:new Sn(e,this.before,this.after)}insertChild(e){const t=this.before||this.getManagedLineBreak();return t!==null&&t.parentElement!==this.element&&E(222),this.element.insertBefore(e,t),this}removeChild(e){return e.parentElement!==this.element&&E(223),this.element.removeChild(e),this}replaceChild(e,t){return t.parentElement!==this.element&&E(224),this.element.replaceChild(e,t),this}getFirstChild(){const e=this.after?this.after.nextSibling:this.element.firstChild;return e===this.before||e===this.getManagedLineBreak()?null:e}getManagedLineBreak(){return this.element.__lexicalLineBreak||null}setManagedLineBreak(e){if(e===null)this.removeManagedLineBreak();else{const t=e==="decorator"&&(kn||Yt||wn);this.insertManagedLineBreak(t)}}removeManagedLineBreak(){const e=this.getManagedLineBreak();if(e){const t=this.element,r=e.nodeName==="IMG"?e.nextSibling:null;r&&t.removeChild(r),t.removeChild(e),t.__lexicalLineBreak=void 0}}insertManagedLineBreak(e){const t=this.getManagedLineBreak();if(t){if(e===(t.nodeName==="IMG"))return;this.removeManagedLineBreak()}const r=this.element,i=this.before,o=document.createElement("br");if(r.insertBefore(o,i),e){const s=document.createElement("img");s.setAttribute("data-lexical-linebreak","true"),s.style.cssText="display: inline !important; border: 0px !important; margin: 0px !important;",s.alt="",r.insertBefore(s,o),r.__lexicalLineBreak=s}else r.__lexicalLineBreak=o}getFirstChildOffset(){let e=0;for(let t=this.after;t!==null;t=t.previousSibling)e++;return e}resolveChildIndex(e,t,r,i){if(r===this.element){const a=this.getFirstChildOffset();return[e,Math.min(a+e.getChildrenSize(),Math.max(a,i))]}const o=ds(t,r);o.push(i);const s=ds(t,this.element);let l=e.getIndexWithinParent();for(let a=0;a<s.length;a++){const c=o[a],u=s[a];if(c===void 0||c<u)break;if(c>u){l+=1;break}}return[e.getParentOrThrow(),l]}}function ds(n,e){const t=[];let r=e;for(;r!==n&&r!==null;r=r.parentNode){let i=0;for(let o=r.previousSibling;o!==null;o=o.previousSibling)i++;t.push(i)}return r!==n&&E(225),t.reverse()}class ce extends Oe{__first;__last;__size;__format;__style;__indent;__dir;__textFormat;__textStyle;constructor(e){super(e),this.__first=null,this.__last=null,this.__size=0,this.__format=0,this.__style="",this.__indent=0,this.__dir=null,this.__textFormat=0,this.__textStyle=""}afterCloneFrom(e){super.afterCloneFrom(e),this.__key===e.__key&&(this.__first=e.__first,this.__last=e.__last,this.__size=e.__size),this.__indent=e.__indent,this.__format=e.__format,this.__style=e.__style,this.__dir=e.__dir,this.__textFormat=e.__textFormat,this.__textStyle=e.__textStyle}getFormat(){return this.getLatest().__format}getFormatType(){const e=this.getFormat();return Ic[e]||""}getStyle(){return this.getLatest().__style}getIndent(){return this.getLatest().__indent}getChildren(){const e=[];let t=this.getFirstChild();for(;t!==null;)e.push(t),t=t.getNextSibling();return e}getChildrenKeys(){const e=[];let t=this.getFirstChild();for(;t!==null;)e.push(t.__key),t=t.getNextSibling();return e}getChildrenSize(){return this.getLatest().__size}isEmpty(){return this.getChildrenSize()===0}isDirty(){const e=H()._dirtyElements;return e!==null&&e.has(this.__key)}isLastChild(){const e=this.getLatest(),t=this.getParentOrThrow().getLastChild();return t!==null&&t.is(e)}getAllTextNodes(){const e=[];let t=this.getFirstChild();for(;t!==null;){if(M(t)&&e.push(t),v(t)){const r=t.getAllTextNodes();e.push(...r)}t=t.getNextSibling()}return e}getFirstDescendant(){let e=this.getFirstChild();for(;v(e);){const t=e.getFirstChild();if(t===null)break;e=t}return e}getLastDescendant(){let e=this.getLastChild();for(;v(e);){const t=e.getLastChild();if(t===null)break;e=t}return e}getDescendantByIndex(e){const t=this.getChildren(),r=t.length;if(e>=r){const o=t[r-1];return v(o)&&o.getLastDescendant()||o||null}const i=t[e];return v(i)&&i.getFirstDescendant()||i||null}getFirstChild(){const e=this.getLatest().__first;return e===null?null:ne(e)}getFirstChildOrThrow(){const e=this.getFirstChild();return e===null&&E(45,this.__key),e}getLastChild(){const e=this.getLatest().__last;return e===null?null:ne(e)}getLastChildOrThrow(){const e=this.getLastChild();return e===null&&E(96,this.__key),e}getChildAtIndex(e){const t=this.getChildrenSize();let r,i;if(e<t/2){for(r=this.getFirstChild(),i=0;r!==null&&i<=e;){if(i===e)return r;r=r.getNextSibling(),i++}return null}for(r=this.getLastChild(),i=t-1;r!==null&&i>=e;){if(i===e)return r;r=r.getPreviousSibling(),i--}return null}getTextContent(){let e="";const t=this.getChildren(),r=t.length;for(let i=0;i<r;i++){const o=t[i];e+=o.getTextContent(),v(o)&&i!==r-1&&!o.isInline()&&(e+=et)}return e}getTextContentSize(){let e=0;const t=this.getChildren(),r=t.length;for(let i=0;i<r;i++){const o=t[i];e+=o.getTextContentSize(),v(o)&&i!==r-1&&!o.isInline()&&(e+=2)}return e}getDirection(){return this.getLatest().__dir}getTextFormat(){return this.getLatest().__textFormat}hasFormat(e){if(e!==""){const t=Do[e];return(this.getFormat()&t)!==0}return!1}hasTextFormat(e){const t=pt[e];return(this.getTextFormat()&t)!==0}getFormatFlags(e,t){return vr(this.getLatest().__textFormat,e,t)}getTextStyle(){return this.getLatest().__textStyle}select(e,t){oe();const r=F();let i=e,o=t;const s=this.getChildrenSize();if(!this.canBeEmpty()){if(e===0&&t===0){const a=this.getFirstChild();if(M(a)||v(a))return a.select(0,0)}else if(!(e!==void 0&&e!==s||t!==void 0&&t!==s)){const a=this.getLastChild();if(M(a)||v(a))return a.select()}}i===void 0&&(i=s),o===void 0&&(o=s);const l=this.__key;return A(r)?(r.anchor.set(l,i,"element"),r.focus.set(l,o,"element"),r.dirty=!0,r):Gl(l,i,l,o,"element","element")}selectStart(){const e=this.getFirstDescendant();return e?e.selectStart():this.select()}selectEnd(){const e=this.getLastDescendant();return e?e.selectEnd():this.select()}clear(){const e=this.getWritable();return this.getChildren().forEach(t=>t.remove()),e}append(...e){return this.splice(this.getChildrenSize(),0,e)}setDirection(e){const t=this.getWritable();return t.__dir=e,t}setFormat(e){return this.getWritable().__format=e!==""?Do[e]:0,this}setStyle(e){return this.getWritable().__style=e||"",this}setTextFormat(e){const t=this.getWritable();return t.__textFormat=e,t}setTextStyle(e){const t=this.getWritable();return t.__textStyle=e,t}setIndent(e){return this.getWritable().__indent=e,this}splice(e,t,r){xr(this)&&E(324,this.__key,this.__type);const i=this.getChildrenSize(),o=this.getWritable();e+t<=i||E(226,String(e),String(t),String(i));const s=o.__key,l=[],a=[],c=this.getChildAtIndex(e+t);let u=null,f=i-t+r.length;if(e!==0)if(e===i)u=this.getLastChild();else{const g=this.getChildAtIndex(e);g!==null&&(u=g.getPreviousSibling())}if(t>0){let g=u===null?this.getFirstChild():u.getNextSibling();for(let h=0;h<t;h++){g===null&&E(100);const p=g.getNextSibling(),m=g.__key;ft(g.getWritable()),a.push(m),g=p}}let d=u;for(const g of r){d!==null&&g.is(d)&&(u=d=d.getPreviousSibling());const h=g.getWritable();h.__parent===s&&f--,ft(h);const p=g.__key;if(d===null)o.__first=p,h.__prev=null;else{const m=d.getWritable();m.__next=p,h.__prev=m.__key}g.__key===s&&E(76),h.__parent=s,l.push(p),d=g}if(e+t===i)d!==null&&(d.getWritable().__next=null,o.__last=d.__key);else if(c!==null){const g=c.getWritable();if(d!==null){const h=d.getWritable();g.__prev=d.__key,h.__next=c.__key}else g.__prev=null}if(o.__size=f,a.length){const g=F();if(A(g)){const h=new Set(a),p=new Set(l),{anchor:m,focus:x}=g;fs(m,h,p)&&Cr(m,m.getNode(),this,u,c),fs(x,h,p)&&Cr(x,x.getNode(),this,u,c),f!==0||this.canBeEmpty()||He(this)||this.remove()}}return o}getDOMSlot(e){return new Sn(e)}exportDOM(e){const{element:t}=super.exportDOM(e);if(J(t)){const r=this.getIndent();r>0&&(t.style.paddingInlineStart=40*r+"px");const i=this.getDirection();i&&(t.dir=i)}return{element:t}}exportJSON(){const e={children:[],direction:this.getDirection(),format:this.getFormatType(),indent:this.getIndent(),...super.exportJSON()},t=this.getTextFormat(),r=this.getTextStyle();return t!==0&&(e.textFormat=t),r!==""&&(e.textStyle=r),e}updateFromJSON(e){return super.updateFromJSON(e).setFormat(e.format).setIndent(e.indent).setDirection(e.direction).setTextFormat(e.textFormat||0).setTextStyle(e.textStyle||"")}insertNewAfter(e,t){return null}canIndent(){return!0}collapseAtStart(e){return!1}excludeFromCopy(e){return!1}canReplaceWith(e){return!0}canInsertAfter(e){return!0}canBeEmpty(){return!0}canInsertTextBefore(){return!0}canInsertTextAfter(){return!0}isInline(){return!1}isShadowRoot(){return!1}canMergeWith(e){return!1}extractWithChild(e,t,r){return!1}canMergeWhenEmpty(){return!1}reconcileObservedMutation(e,t){const r=this.getDOMSlot(e);let i=r.getFirstChild();for(let o=this.getFirstChild();o;o=o.getNextSibling()){const s=t.getElementByKey(o.getKey());s!==null&&(i==null?(r.insertChild(s),i=s):i!==s&&r.replaceChild(s,i),i=i.nextSibling)}}}function v(n){return n instanceof ce}function fs(n,e,t){let r=n.getNode();for(;r;){const i=r.__key;if(e.has(i)&&!t.has(i))return!0;r=r.getParent()}return!1}class ra extends Oe{decorate(e,t){return null}isIsolated(){return!1}isInline(){return!0}isKeyboardSelectable(){return!0}}function W(n){return n instanceof ra}class nn extends ce{__cachedText;static getType(){return"root"}static clone(){return new nn}constructor(){super("root"),this.__cachedText=null}getTopLevelElementOrThrow(){E(51)}getTextContent(){const e=this.__cachedText;return!Ln()&&H()._dirtyType!==0||e===null?super.getTextContent():e}remove(){E(52)}replace(e){E(53)}insertBefore(e){E(54)}insertAfter(e){E(55)}updateDOM(e,t){return!1}splice(e,t,r){for(const i of r)v(i)||W(i)||E(282);return super.splice(e,t,r)}static importJSON(e){return V().updateFromJSON(e)}collapseAtStart(){return!0}}function G(n){return n instanceof nn}function ia(n){return new Pn(new Map(n._nodeMap))}function Gi(){return new Pn(new Map([["root",new nn]]))}function oa(n){const e=n.exportJSON(),t=n.constructor;if(e.type!==t.getType()&&E(130,t.name),v(n)){const r=e.children;Array.isArray(r)||E(59,t.name);const i=n.getChildren();for(let o=0;o<i.length;o++){const s=oa(i[o]);r.push(s)}}return e}function Ou(n){return n instanceof Pn}class Pn{_nodeMap;_selection;_flushSync;_readOnly;constructor(e,t){this._nodeMap=e,this._selection=t||null,this._flushSync=!1,this._readOnly=!1}isEmpty(){return this._nodeMap.size===1&&this._selection===null}read(e,t){return cs(t&&t.editor||null,this,e)}clone(e){const t=new Pn(this._nodeMap,e===void 0?this._selection:e);return t._readOnly=!0,t}toJSON(){return cs(null,this,()=>({root:oa(V())}))}}class Xi extends ce{static getType(){return"artificial"}createDOM(e){return document.createElement("div")}}class rn extends ce{static getType(){return"paragraph"}static clone(e){return new rn(e.__key)}createDOM(e){const t=document.createElement("p"),r=Jt(e.theme,"paragraph");return r!==void 0&&t.classList.add(...r),t}updateDOM(e,t,r){return!1}static importDOM(){return{p:e=>({conversion:Au,priority:0})}}exportDOM(e){const{element:t}=super.exportDOM(e);if(J(t)){this.isEmpty()&&t.append(document.createElement("br"));const r=this.getFormatType();r&&(t.style.textAlign=r)}return{element:t}}static importJSON(e){return Q().updateFromJSON(e)}exportJSON(){return{...super.exportJSON(),textFormat:this.getTextFormat(),textStyle:this.getTextStyle()}}insertNewAfter(e,t){const r=Q();r.setTextFormat(e.format),r.setTextStyle(e.style);const i=this.getDirection();return r.setDirection(i),r.setFormat(this.getFormatType()),r.setStyle(this.getStyle()),this.insertAfter(r,t),r}collapseAtStart(){const e=this.getChildren();if(e.length===0||M(e[0])&&e[0].getTextContent().trim()===""){if(this.getNextSibling()!==null)return this.selectNext(),this.remove(),!0;if(this.getPreviousSibling()!==null)return this.selectPrevious(),this.remove(),!0}return!1}}function Au(n){const e=Q();return n.style&&(e.setFormat(n.style.textAlign),ao(n,e)),{node:e}}function Q(){return ye(new rn)}function Qi(n){return n instanceof rn}const j=0,Mu=4;function sa(n,e,t,r){const i=n._keyToDOMMap;i.clear(),n._editorState=Gi(),n._pendingEditorState=r,n._compositionKey=null,n._dirtyType=0,n._cloneNotNeeded.clear(),n._dirtyLeaves=new Set,n._dirtyElements.clear(),n._normalizedNodes=new Set,n._updateTags=new Set,n._updates=[],n._blockCursorElement=null;const o=n._observer;o!==null&&(o.disconnect(),n._observer=null),e!==null&&(e.textContent=""),t!==null&&(t.textContent="",i.set("root",t))}function Du(n){const e=new Set,t=new Set;let r=n;for(;r;){const{ownNodeConfig:i}=$r(r),o=r.transform;if(!t.has(o)){t.add(o);const s=r.transform();s&&e.add(s)}if(i){const s=i.$transform;s&&e.add(s),r=i.extends}else{const s=Object.getPrototypeOf(r);r=s.prototype instanceof Oe&&s!==Oe?s:void 0}}return e}function la(n){const e=n||{},t=Tu(),r=e.theme||{},i=n===void 0?t:e.parentEditor||null,o=e.disableEvents||!1,s=Gi(),l=e.namespace||(i!==null?i._config.namespace:pa()),a=e.editorState,c=[nn,kt,Zt,en,rn,Xi,...e.nodes||[]],{onError:u,html:f}=e,d=e.editable===void 0||e.editable;let g;if(n===void 0&&t!==null)g=t._nodes;else{g=new Map;for(let p=0;p<c.length;p++){let m=c[p],x=null,y=null;if(typeof m!="function"){const T=m;m=T.replace,x=T.with,y=T.withKlass||null}$r(m);const C=m.getType(),k=Du(m);g.set(C,{exportDOM:f&&f.export?f.export.get(m):void 0,klass:m,replace:x,replaceWithKlass:y,sharedNodeState:Uc(c[p]),transforms:k})}}const h=new Gt(s,i,g,{disableEvents:o,namespace:l,theme:r},u||console.error,(function(p,m){const x=new Map,y=new Set,C=k=>{Object.keys(k).forEach(T=>{let b=x.get(T);b===void 0&&(b=[],x.set(T,b)),b.push(k[T])})};return p.forEach(k=>{const T=k.klass.importDOM;if(T==null||y.has(T))return;y.add(T);const b=T.call(k.klass);b!==null&&C(b)}),m&&C(m),x})(g,f?f.import:void 0),d,n);return a!==void 0&&(h._pendingEditorState=a,h._dirtyType=2),h}class Gt{static version;_headless;_parentEditor;_rootElement;_editorState;_pendingEditorState;_compositionKey;_deferred;_keyToDOMMap;_updates;_updating;_listeners;_commands;_nodes;_decorators;_pendingDecorators;_config;_dirtyType;_cloneNotNeeded;_dirtyLeaves;_dirtyElements;_normalizedNodes;_updateTags;_observer;_key;_onError;_htmlConversions;_window;_editable;_blockCursorElement;_createEditorArgs;constructor(e,t,r,i,o,s,l,a){this._createEditorArgs=a,this._parentEditor=t,this._rootElement=null,this._editorState=e,this._pendingEditorState=null,this._compositionKey=null,this._deferred=[],this._keyToDOMMap=new Map,this._updates=[],this._updating=!1,this._listeners={decorator:new Set,editable:new Set,mutation:new Map,root:new Set,textcontent:new Set,update:new Set},this._commands=new Map,this._config=i,this._nodes=r,this._decorators={},this._pendingDecorators=null,this._dirtyType=0,this._cloneNotNeeded=new Set,this._dirtyLeaves=new Set,this._dirtyElements=new Map,this._normalizedNodes=new Set,this._updateTags=new Set,this._observer=null,this._key=pa(),this._onError=o,this._htmlConversions=s,this._editable=l,this._headless=t!==null&&t._headless,this._window=null,this._blockCursorElement=null}isComposing(){return this._compositionKey!=null}registerUpdateListener(e){const t=this._listeners.update;return t.add(e),()=>{t.delete(e)}}registerEditableListener(e){const t=this._listeners.editable;return t.add(e),()=>{t.delete(e)}}registerDecoratorListener(e){const t=this._listeners.decorator;return t.add(e),()=>{t.delete(e)}}registerTextContentListener(e){const t=this._listeners.textcontent;return t.add(e),()=>{t.delete(e)}}registerRootListener(e){const t=this._listeners.root;return e(this._rootElement,null),t.add(e),()=>{e(null,this._rootElement),t.delete(e)}}registerCommand(e,t,r){r===void 0&&E(35);const i=this._commands;i.has(e)||i.set(e,[new Set,new Set,new Set,new Set,new Set]);const o=i.get(e);o===void 0&&E(36,String(e));const s=o[r];return s.add(t),()=>{s.delete(t),o.every(l=>l.size===0)&&i.delete(e)}}registerMutationListener(e,t,r){const i=this.resolveRegisteredNodeAfterReplacements(this.getRegisteredNode(e)).klass,o=this._listeners.mutation;let s=o.get(t);s===void 0&&(s=new Set,o.set(t,s)),s.add(i);const l=r&&r.skipInitialization;return l!==void 0&&l||this.initializeMutationListener(t,i),()=>{s.delete(i),s.size===0&&o.delete(t)}}getRegisteredNode(e){const t=this._nodes.get(e.getType());return t===void 0&&E(37,e.name),t}resolveRegisteredNodeAfterReplacements(e){for(;e.replaceWithKlass;)e=this.getRegisteredNode(e.replaceWithKlass);return e}initializeMutationListener(e,t){const r=this._editorState,i=Cs(r).get(t.getType());if(!i)return;const o=new Map;for(const s of i.keys())o.set(s,"created");o.size>0&&e(o,{dirtyLeaves:new Set,prevEditorState:r,updateTags:new Set(["registerMutationListener"])})}registerNodeTransformToKlass(e,t){const r=this.getRegisteredNode(e);return r.transforms.add(t),r}registerNodeTransform(e,t){const r=this.registerNodeTransformToKlass(e,t),i=[r],o=r.replaceWithKlass;if(o!=null){const s=this.registerNodeTransformToKlass(o,t);i.push(s)}return(function(s,l){const a=Cs(s.getEditorState()),c=[];for(const u of l){const f=a.get(u);f&&c.push(f)}c.length!==0&&s.update(()=>{for(const u of c)for(const f of u.keys()){const d=ne(f);d&&d.markDirty()}},s._pendingEditorState===null?{tag:ct}:void 0)})(this,i.map(s=>s.klass.getType())),()=>{i.forEach(s=>s.transforms.delete(t))}}hasNode(e){return this._nodes.has(e.getType())}hasNodes(e){return e.every(this.hasNode.bind(this))}dispatchCommand(e,t){return D(this,e,t)}getDecorators(){return this._decorators}getRootElement(){return this._rootElement}getKey(){return this._key}setRootElement(e){const t=this._rootElement;if(e!==t){const r=Jt(this._config.theme,"root"),i=this._pendingEditorState||this._editorState;if(this._rootElement=e,sa(this,t,e,i),t!==null&&(this._config.disableEvents||cu(t),r!=null&&t.classList.remove(...r)),e!==null){const o=lo(e),s=e.style;s.userSelect="text",s.whiteSpace="pre-wrap",s.wordBreak="break-word",e.setAttribute("data-lexical-editor","true"),this._window=o,this._dirtyType=2,pl(this),this._updateTags.add(ct),je(this),this._config.disableEvents||(function(l,a){const c=l.ownerDocument;bi.set(l,c);const u=yr.get(c)??0;u<1&&c.addEventListener("selectionchange",Kl),yr.set(c,u+1),l.__lexicalEditor=a;const f=Bl(l);for(let d=0;d<vi.length;d++){const[g,h]=vi[d],p=typeof h=="function"?m=>{Vo(m)||(Ho(m),(a.isEditable()||g==="click")&&h(m,a))}:m=>{if(Vo(m))return;Ho(m);const x=a.isEditable();switch(g){case"cut":return x&&D(a,Hi,m);case"copy":return D(a,Or,m);case"paste":return x&&D(a,Ki,m);case"dragstart":return x&&D(a,Ll,m);case"dragover":return x&&D(a,Pl,m);case"dragend":return x&&D(a,ru,m);case"focus":return x&&D(a,su,m);case"blur":return x&&D(a,lu,m);case"drop":return x&&D(a,Fl,m)}};l.addEventListener(g,p),f.push(()=>{l.removeEventListener(g,p)})}})(e,this),r!=null&&e.classList.add(...r)}else this._window=null,this._updateTags.add(ct),je(this);xn("root",this,!1,e,t)}}getElementByKey(e){return this._keyToDOMMap.get(e)||null}getEditorState(){return this._editorState}setEditorState(e,t){e.isEmpty()&&E(38);let r=e;r._readOnly&&(r=ia(e),r._selection=e._selection?e._selection.clone():null),gl(this);const i=this._pendingEditorState,o=this._updateTags,s=t!==void 0?t.tag:null;i===null||i.isEmpty()||(s!=null&&o.add(s),je(this)),this._pendingEditorState=r,this._dirtyType=2,this._dirtyElements.set("root",!1),this._compositionKey=null,s!=null&&o.add(s),this._updating||je(this)}parseEditorState(e,t){return(function(r,i,o){const s=Gi(),l=ee,a=de,c=te,u=i._dirtyElements,f=i._dirtyLeaves,d=i._cloneNotNeeded,g=i._dirtyType;i._dirtyElements=new Map,i._dirtyLeaves=new Set,i._cloneNotNeeded=new Set,i._dirtyType=0,ee=s,de=!1,te=i,Zi(null);try{const h=i._nodes;Yi(r.root,h),o&&o(),s._readOnly=!0}catch(h){h instanceof Error&&i._onError(h)}finally{i._dirtyElements=u,i._dirtyLeaves=f,i._cloneNotNeeded=d,i._dirtyType=g,ee=l,de=a,te=c}return s})(typeof e=="string"?JSON.parse(e):e,this,t)}read(e){return je(this),this.getEditorState().read(e,{editor:this})}update(e,t){(function(r,i,o){r._updating?r._updates.push([i,o]):Mr(r,i,o)})(this,e,t)}focus(e,t={}){const r=this._rootElement;r!==null&&(r.setAttribute("autocapitalize","off"),me(this,()=>{const i=F(),o=V();i!==null?i.dirty||fe(i.clone()):o.getChildrenSize()!==0&&(t.defaultSelection==="rootStart"?o.selectStart():o.selectEnd()),Ru("focus"),zu(()=>{r.removeAttribute("autocapitalize"),e&&e()})}),this._pendingEditorState===null&&r.removeAttribute("autocapitalize"))}blur(){const e=this._rootElement;e!==null&&e.blur();const t=ve(this._window);t!==null&&t.removeAllRanges()}isEditable(){return this._editable}setEditable(e){this._editable!==e&&(this._editable=e,xn("editable",this,!0,e))}toJSON(){return{editorState:this._editorState.toJSON()}}}Gt.version="0.38.2+prod.esm";let Ai=null;function Zi(n){Ai=n}let Fu=1;function aa(n,e){const t=eo(n,e);return t===void 0&&E(30,e),t}function eo(n,e){return n._nodes.get(e)}const Lu=typeof queueMicrotask=="function"?queueMicrotask:n=>{Promise.resolve().then(n)};function hs(n){return W(tt(n))}function to(n){const e=document.activeElement;if(!J(e))return!1;const t=e.nodeName;return W(tt(n))&&(t==="INPUT"||t==="TEXTAREA"||e.contentEditable==="true"&&Dr(e)==null)}function $n(n,e,t){const r=n.getRootElement();try{return r!==null&&r.contains(e)&&r.contains(t)&&e!==null&&!to(e)&&ca(e)===n}catch{return!1}}function no(n){return n instanceof Gt}function ca(n){let e=n;for(;e!=null;){const t=Dr(e);if(no(t))return t;e=In(e)}return null}function Dr(n){return n?n.__lexicalEditor:null}function dt(n){return Vl(n)||n.isToken()}function Ie(n){return dt(n)||n.isSegmented()}function Je(n){return on(n)&&n.nodeType===3}function ua(n){return on(n)&&n.nodeType===9}function Xt(n){let e=n;for(;e!=null;){if(Je(e))return e;e=e.firstChild}return null}function vr(n,e,t){const r=pt[e];if(t!==null&&(n&r)===(t&r))return n;let i=n^r;return e==="subscript"?i&=-65:e==="superscript"?i&=-33:e==="lowercase"?(i&=-513,i&=-1025):e==="uppercase"?(i&=-257,i&=-1025):e==="capitalize"&&(i&=-257,i&=-513),i}function Pu(n,e){const t=(function(){const s=Ai;return Ai=null,s})();if((e=e||t&&t.__key)!=null)return void(n.__key=e);oe(),ea();const r=H(),i=it(),o=""+Fu++;i._nodeMap.set(o,n),v(n)?r._dirtyElements.set(o,!0):r._dirtyLeaves.add(o),r._cloneNotNeeded.add(o),r._dirtyType=1,n.__key=o}function ft(n){const e=n.getParent();if(e!==null){const t=n.getWritable(),r=e.getWritable(),i=n.getPreviousSibling(),o=n.getNextSibling(),s=o!==null?o.__key:null,l=i!==null?i.__key:null,a=i!==null?i.getWritable():null,c=o!==null?o.getWritable():null;i===null&&(r.__first=s),o===null&&(r.__last=l),a!==null&&(a.__next=s),c!==null&&(c.__prev=l),t.__prev=null,t.__next=null,t.__parent=null,r.__size--}}function br(n){ea(),xr(n)&&E(323,n.__key,n.__type);const e=n.getLatest(),t=e.__parent,r=it(),i=H(),o=r._nodeMap,s=i._dirtyElements;t!==null&&(function(a,c,u){let f=a;for(;f!==null;){if(u.has(f))return;const d=c.get(f);if(d===void 0)break;u.set(f,!1),f=d.__parent}})(t,o,s);const l=e.__key;i._dirtyType=1,v(n)?s.set(l,!0):i._dirtyLeaves.add(l)}function re(n){oe();const e=H(),t=e._compositionKey;if(n!==t){if(e._compositionKey=n,t!==null){const r=ne(t);r!==null&&r.getWritable()}if(n!==null){const r=ne(n);r!==null&&r.getWritable()}}}function Ge(){return Ln()?null:H()._compositionKey}function ne(n,e){const t=(e||it())._nodeMap.get(n);return t===void 0?null:t}function da(n,e){const t=Fr(n,H());return t!==void 0?ne(t,e):null}function Fr(n,e){return n[`__lexicalKey_${e._key}`]}function tt(n,e){let t=n;for(;t!=null;){const r=da(t,e);if(r!==null)return r;t=In(t)}return null}function fa(n){const e=n._decorators,t=Object.assign({},e);return n._pendingDecorators=t,t}function gs(n){return n.read(()=>V().getTextContent())}function V(){return ha(it())}function ha(n){return n._nodeMap.get("root")}function fe(n){oe();const e=it();n!==null&&(n.dirty=!0,n.setCachedNodes(null)),e._selection=n}function jt(n){const e=H(),t=(function(r,i){let o=r;for(;o!=null;){const s=Fr(o,i);if(s!==void 0)return s;o=In(o)}return null})(n,e);return t===null?n===e.getRootElement()?ne("root"):null:ne(t)}function ga(n){return/[\uD800-\uDBFF][\uDC00-\uDFFF]/g.test(n)}function ro(n){const e=[];let t=n;for(;t!==null;)e.push(t),t=t._parentEditor;return e}function pa(){return Math.random().toString(36).replace(/[^a-z]+/g,"").substring(0,5)}function ma(n){return Je(n)?n.nodeValue:null}function io(n,e,t){const r=ve(xe(e));if(r===null)return;const i=r.anchorNode;let{anchorOffset:o,focusOffset:s}=r;if(i!==null){let l=ma(i);const a=tt(i);if(l!==null&&M(a)){if(l===Tr&&t){const c=t.length;l=t,o=c,s=c}l!==null&&oo(a,l,o,s,n)}}}function oo(n,e,t,r,i){let o=n;if(o.isAttached()&&(i||!o.isDirty())){const s=o.isComposing();let l=e;(s||i)&&e[e.length-1]===Tr&&(l=e.slice(0,-1));const a=o.getTextContent();if(i||l!==a){if(l===""){if(re(null),wn||Yt||kn)o.remove();else{const p=H();setTimeout(()=>{p.update(()=>{o.isAttached()&&o.remove()})},20)}return}const c=o.getParent(),u=tn(),f=o.getTextContentSize(),d=Ge(),g=o.getKey();if(o.isToken()||d!==null&&g===d&&!s||A(u)&&(c!==null&&!c.canInsertTextBefore()&&u.anchor.offset===0||u.anchor.key===n.__key&&u.anchor.offset===0&&!o.canInsertTextBefore()&&!s||u.focus.key===n.__key&&u.focus.offset===f&&!o.canInsertTextAfter()&&!s))return void o.markDirty();const h=F();if(!A(h)||t===null||r===null)return void ps(o,l,h);if(h.setTextNodeRange(o,t,o,r),o.isSegmented()){const p=Z(o.getTextContent());o.replace(p),o=p}ps(o,l,h)}}}function ps(n,e,t){if(n.setTextContent(e),A(t)){const r=n.getKey();for(const i of["anchor","focus"]){const o=t[i];o.type==="text"&&o.key===r&&(o.offset=Qe(n,o.offset,"clamp"))}}}function Xn(n,e,t){const r=e[t]||!1;return r==="any"||r===n[t]}function $u(n,e){return Xn(n,e,"altKey")&&Xn(n,e,"ctrlKey")&&Xn(n,e,"shiftKey")&&Xn(n,e,"metaKey")}function K(n,e,t){return $u(n,t)&&n.key.toLowerCase()===e.toLowerCase()}const $e={ctrlKey:!Se,metaKey:Se},ms={altKey:Se,ctrlKey:!Se};function _s(n){return n.key==="Backspace"}function ys(n){return K(n,"a",$e)}function Iu(n){const e=V();if(A(n)){const t=n.anchor,r=n.focus,i=t.getNode().getTopLevelElementOrThrow().getParentOrThrow();return t.set(i.getKey(),0,"element"),r.set(i.getKey(),i.getChildrenSize(),"element"),dr(n),n}{const t=e.select(0,e.getChildrenSize());return fe(dr(t)),t}}function Jt(n,e){n.__lexicalClassNameCache===void 0&&(n.__lexicalClassNameCache={});const t=n.__lexicalClassNameCache,r=t[e];if(r!==void 0)return r;const i=n[e];if(typeof i=="string"){const o=ul(i);return t[e]=o,o}return i}function so(n,e,t,r,i){if(t.size===0)return;const o=r.__type,s=r.__key,l=e.get(o);l===void 0&&E(33,o);const a=l.klass;let c=n.get(a);c===void 0&&(c=new Map,n.set(a,c));const u=c.get(s),f=u==="destroyed"&&i==="created";(u===void 0||f)&&c.set(s,f?"updated":i)}function xs(n,e,t){const r=n.getParent();let i=t,o=n;return r!==null&&(e&&t===0?(i=o.getIndexWithinParent(),o=r):e||t!==o.getChildrenSize()||(i=o.getIndexWithinParent()+1,o=r)),o.getChildAtIndex(e?i-1:i)}function Mi(n,e){const t=n.offset;if(n.type==="element")return xs(n.getNode(),e,t);{const r=n.getNode();if(e&&t===0||!e&&t===r.getTextContentSize()){const i=e?r.getPreviousSibling():r.getNextSibling();return i===null?xs(r.getParentOrThrow(),e,r.getIndexWithinParent()+(e?0:1)):i}}return null}function _a(n){const e=xe(n).event,t=e&&e.inputType;return t==="insertFromPaste"||t==="insertFromPasteAsQuotation"}function D(n,e,t){return(function(r,i,o){const s=ro(r);for(let l=4;l>=0;l--)for(let a=0;a<s.length;a++){const c=s[a],u=c._commands.get(i);if(u!==void 0){const f=u[l];if(f!==void 0){const d=Array.from(f),g=d.length;let h=!1;if(me(c,()=>{for(let p=0;p<g;p++)if(d[p](o,r))return void(h=!0)}),h)return h}}}return!1})(n,e,t)}function Lr(n){return!G(n)&&!n.isLastChild()&&!n.isInline()}function xt(n,e){const t=n._keyToDOMMap.get(e);return t===void 0&&E(75,e),t}function In(n){const e=n.assignedSlot||n.parentElement;return Li(e)?e.host:e}function ya(n){return ua(n)?n:J(n)?n.ownerDocument:null}function Ru(n){oe(),H()._updateTags.add(n)}function zu(n){oe(),H()._deferred.push(n)}function Di(n,e){let t=n.getParent();for(;t!==null;){if(t.is(e))return!0;t=t.getParent()}return!1}function lo(n){const e=ya(n);return e?e.defaultView:null}function xe(n){const e=n._window;return e===null&&E(78),e}function ju(n){return v(n)&&n.isInline()||W(n)&&n.isInline()}function Wu(n){let e=n.getParentOrThrow();for(;e!==null;){if(He(e))return e;e=e.getParentOrThrow()}return e}function He(n){return G(n)||v(n)&&n.isShadowRoot()}function ye(n){const e=H(),t=n.getType(),r=eo(e,t);r===void 0&&E(200,n.constructor.name,t);const{replace:i,replaceWithKlass:o}=r;if(i!==null){const s=i(n),l=s.constructor;return o!==null?s instanceof o||E(201,o.name,o.getType(),l.name,l.getType(),n.constructor.name,t):s instanceof n.constructor&&l!==n.constructor||E(202,l.name,l.getType(),n.constructor.name,t),s.__key===n.__key&&E(203,n.constructor.name,t,l.name,l.getType()),s}return n}function ti(n,e){!G(n.getParent())||v(e)||W(e)||E(99)}function Bu(n){const e=ne(n);return e===null&&E(63,n),e}function ni(n){return(W(n)||v(n)&&!n.canBeEmpty())&&!n.isInline()}function Fi(n,e,t){t.style.removeProperty("caret-color"),e._blockCursorElement=null;const r=n.parentElement;r!==null&&r.removeChild(n)}function ve(n){return be?(n||window).getSelection():null}function Ku(n){const e=lo(n);return e?e.getSelection():null}function xa(n){return J(n)&&n.tagName==="A"}function J(n){return on(n)&&n.nodeType===1}function on(n){return typeof n=="object"&&n!==null&&"nodeType"in n&&typeof n.nodeType=="number"}function Li(n){return on(n)&&n.nodeType===11}function Pi(n){const e=new RegExp(/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|mark|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var|#text)$/,"i");return n.nodeName.match(e)!==null}function wr(n){const e=new RegExp(/^(address|article|aside|blockquote|canvas|dd|div|dl|dt|fieldset|figcaption|figure|footer|form|h1|h2|h3|h4|h5|h6|header|hr|li|main|nav|noscript|ol|p|pre|section|table|td|tfoot|ul|video)$/,"i");return n.nodeName.match(e)!==null}function Ye(n){if(W(n)&&!n.isInline())return!0;if(!v(n)||He(n))return!1;const e=n.getFirstChild(),t=e===null||ut(e)||M(e)||e.isInline();return!n.isInline()&&n.canBeEmpty()!==!1&&t}function Pr(){return H()}const Ss=new WeakMap,Uu=new Map;function Cs(n){if(!n._readOnly&&n.isEmpty())return Uu;n._readOnly||E(192);let e=Ss.get(n);return e||(e=(function(t){const r=new Map;for(const[i,o]of t._nodeMap){const s=o.__type;let l=r.get(s);l||(l=new Map,r.set(s,l)),l.set(i,o)}return r})(n),Ss.set(n,e)),e}function Sa(n){const e=n.constructor.clone(n);return e.afterCloneFrom(n),e}function Ju(n){return(e=Sa(n))[Ul]=!0,e;var e}function ao(n,e){const t=parseInt(n.style.paddingInlineStart,10)||0,r=Math.round(t/40);e.setIndent(r)}function Hu(n){n.__lexicalUnmanaged=!0}function Vu(n){return n.__lexicalUnmanaged===!0}function un(n,e){return(function(t,r){return Object.prototype.hasOwnProperty.call(t,r)})(n,e)&&n[e]!==Oe[e]}function $r(n){const e=Fo in n.prototype?n.prototype[Fo]():void 0,t=(function(s){if(!(s===Oe||s.prototype instanceof Oe)){let l="<unknown>",a="<unknown>";try{l=s.getType()}catch{}try{Gt.version&&(a=JSON.parse(Gt.version))}catch{}E(290,s.name,l,a)}return s===ra||s===ce||s===Oe})(n),r=!t&&un(n,"getType")?n.getType():void 0;let i,o=r;if(e)if(r)i=e[r];else for(const[s,l]of Object.entries(e))o=s,i=l;if(!t&&o&&(un(n,"getType")||(n.getType=()=>o),un(n,"clone")||(n.clone=s=>(Zi(s),new n)),un(n,"importJSON")||(n.importJSON=i&&i.$importJSON||(s=>new n().updateFromJSON(s))),!un(n,"importDOM")&&i)){const{importDOM:s}=i;s&&(n.importDOM=()=>s)}return{ownNodeConfig:i,ownNodeType:o}}const ht=(n,e)=>{let t=n;for(;t!=null&&!G(t);){if(e(t))return t;t=t.getParent()}return null},qu={next:"previous",previous:"next"};class co{origin;constructor(e){this.origin=e}[Symbol.iterator](){return po({hasNext:vt,initial:this.getAdjacentCaret(),map:e=>e,step:e=>e.getAdjacentCaret()})}getAdjacentCaret(){return le(this.getNodeAtCaret(),this.direction)}getSiblingCaret(){return le(this.origin,this.direction)}remove(){const e=this.getNodeAtCaret();return e&&e.remove(),this}replaceOrInsert(e,t){const r=this.getNodeAtCaret();return e.is(this.origin)||e.is(r)||(r===null?this.insert(e):r.replace(e,t)),this}splice(e,t,r="next"){const i=r===this.direction?t:Array.from(t).reverse();let o=this;const s=this.getParentAtCaret(),l=new Map;for(let a=o.getAdjacentCaret();a!==null&&l.size<e;a=a.getAdjacentCaret()){const c=a.origin.getWritable();l.set(c.getKey(),c)}for(const a of i){if(l.size>0){const c=o.getNodeAtCaret();if(c){if(l.delete(c.getKey()),l.delete(a.getKey()),!(c.is(a)||o.origin.is(a))){const u=a.getParent();u&&u.is(s)&&a.remove(),c.replace(a)}}else c===null&&E(263,Array.from(l).join(" "))}else o.insert(a);o=le(a,this.direction)}for(const a of l.values())a.remove();return this}}class An extends co{type="child";getLatest(){const e=this.origin.getLatest();return e===this.origin?this:De(e,this.direction)}getParentCaret(e="root"){return le(uo(this.getParentAtCaret(),e),this.direction)}getFlipped(){const e=sn(this.direction);return le(this.getNodeAtCaret(),e)||De(this.origin,e)}getParentAtCaret(){return this.origin}getChildCaret(){return this}isSameNodeCaret(e){return e instanceof An&&this.direction===e.direction&&this.origin.is(e.origin)}isSamePointCaret(e){return this.isSameNodeCaret(e)}}const Yu={root:G,shadowRoot:He};function sn(n){return qu[n]}function uo(n,e="root"){return Yu[e](n)?null:n}class St extends co{type="sibling";getLatest(){const e=this.origin.getLatest();return e===this.origin?this:le(e,this.direction)}getSiblingCaret(){return this}getParentAtCaret(){return this.origin.getParent()}getChildCaret(){return v(this.origin)?De(this.origin,this.direction):null}getParentCaret(e="root"){return le(uo(this.getParentAtCaret(),e),this.direction)}getFlipped(){const e=sn(this.direction);return le(this.getNodeAtCaret(),e)||De(this.origin.getParentOrThrow(),e)}isSamePointCaret(e){return e instanceof St&&this.direction===e.direction&&this.origin.is(e.origin)}isSameNodeCaret(e){return(e instanceof St||e instanceof Ct)&&this.direction===e.direction&&this.origin.is(e.origin)}}class Ct extends co{type="text";offset;constructor(e,t){super(e),this.offset=t}getLatest(){const e=this.origin.getLatest();return e===this.origin?this:bt(e,this.direction,this.offset)}getParentAtCaret(){return this.origin.getParent()}getChildCaret(){return null}getParentCaret(e="root"){return le(uo(this.getParentAtCaret(),e),this.direction)}getFlipped(){return bt(this.origin,sn(this.direction),this.offset)}isSamePointCaret(e){return e instanceof Ct&&this.direction===e.direction&&this.origin.is(e.origin)&&this.offset===e.offset}isSameNodeCaret(e){return(e instanceof St||e instanceof Ct)&&this.direction===e.direction&&this.origin.is(e.origin)}getSiblingCaret(){return le(this.origin,this.direction)}}function Xe(n){return n instanceof Ct}function vt(n){return n instanceof St}function Ae(n){return n instanceof An}const Gu={next:class extends Ct{direction="next";getNodeAtCaret(){return this.origin.getNextSibling()}insert(n){return this.origin.insertAfter(n),this}},previous:class extends Ct{direction="previous";getNodeAtCaret(){return this.origin.getPreviousSibling()}insert(n){return this.origin.insertBefore(n),this}}},Xu={next:class extends St{direction="next";getNodeAtCaret(){return this.origin.getNextSibling()}insert(n){return this.origin.insertAfter(n),this}},previous:class extends St{direction="previous";getNodeAtCaret(){return this.origin.getPreviousSibling()}insert(n){return this.origin.insertBefore(n),this}}},Qu={next:class extends An{direction="next";getNodeAtCaret(){return this.origin.getFirstChild()}insert(n){return this.origin.splice(0,0,[n]),this}},previous:class extends An{direction="previous";getNodeAtCaret(){return this.origin.getLastChild()}insert(n){return this.origin.splice(this.origin.getChildrenSize(),0,[n]),this}}};function le(n,e){return n?new Xu[e](n):null}function bt(n,e,t){return n?new Gu[e](n,Qe(n,t)):null}function Qe(n,e,t="error"){const r=n.getTextContentSize();let i=e==="next"?r:e==="previous"?0:e;return(i<0||i>r)&&(t!=="clamp"&&al(284,String(e),String(r),n.getKey()),i=i<0?0:r),i}function vs(n,e){return new ed(n,e)}function De(n,e){return v(n)?new Qu[e](n):null}function Zu(n){return n&&n.getChildCaret()||n}function fo(n){return n&&Zu(n.getAdjacentCaret())}class ho{type="node-caret-range";direction;anchor;focus;constructor(e,t,r){this.anchor=e,this.focus=t,this.direction=r}getLatest(){const e=this.anchor.getLatest(),t=this.focus.getLatest();return e===this.anchor&&t===this.focus?this:new ho(e,t,this.direction)}isCollapsed(){return this.anchor.isSamePointCaret(this.focus)}getTextSlices(){const e=i=>{const o=this[i].getLatest();return Xe(o)?(function(s,l){const{direction:a,origin:c}=s,u=Qe(c,l==="focus"?sn(a):a);return vs(s,u-s.offset)})(o,i):null},t=e("anchor"),r=e("focus");if(t&&r){const{caret:i}=t,{caret:o}=r;if(i.isSameNodeCaret(o))return[vs(i,o.offset-i.offset),null]}return[t,r]}iterNodeCarets(e="root"){const t=Xe(this.anchor)?this.anchor.getSiblingCaret():this.anchor.getLatest(),r=this.focus.getLatest(),i=Xe(r),o=s=>s.isSameNodeCaret(r)?null:fo(s)||s.getParentCaret(e);return po({hasNext:s=>s!==null&&!(i&&r.isSameNodeCaret(s)),initial:t.isSameNodeCaret(r)?null:o(t),map:s=>s,step:o})}[Symbol.iterator](){return this.iterNodeCarets("root")}}class ed{type="slice";caret;distance;constructor(e,t){this.caret=e,this.distance=t}getSliceIndices(){const{distance:e,caret:{offset:t}}=this,r=t+e;return r<t?[r,t]:[t,r]}getTextContent(){const[e,t]=this.getSliceIndices();return this.caret.origin.getTextContent().slice(e,t)}getTextContentSize(){return Math.abs(this.distance)}removeTextSlice(){const{caret:{origin:e,direction:t}}=this,[r,i]=this.getSliceIndices(),o=e.getTextContent();return bt(e.setTextContent(o.slice(0,r)+o.slice(i)),t,r)}}function go(n){return nt(n,le(V(),n.direction))}function td(n){return nt(n,n)}function nt(n,e){return n.direction!==e.direction&&E(265),new ho(n,e,n.direction)}function po(n){const{initial:e,hasNext:t,step:r,map:i}=n;let o=e;return{[Symbol.iterator](){return this},next(){if(!t(o))return{done:!0,value:void 0};const s={done:!1,value:i(o)};return o=r(o),s}}}function Ca(n,e){const t=sr(n.origin,e.origin);switch(t===null&&E(275,n.origin.getKey(),e.origin.getKey()),t.type){case"same":{const r=n.type==="text",i=e.type==="text";return r&&i?(function(o,s){return Math.sign(o-s)})(n.offset,e.offset):n.type===e.type?0:r?-1:i?1:n.type==="child"?-1:1}case"ancestor":return n.type==="child"?-1:1;case"descendant":return e.type==="child"?1:-1;case"branch":return va(t)}}function va(n){const{a:e,b:t}=n,r=e.__key,i=t.__key;let o=e,s=t;for(;o&&s;o=o.getNextSibling(),s=s.getNextSibling()){if(o.__key===i)return-1;if(s.__key===r)return 1}return o===null?1:-1}function Qn(n,e){return e.is(n)}function bs(n){return v(n)?[n.getLatest(),null]:[n.getParent(),n.getLatest()]}function sr(n,e){if(n.is(e))return{commonAncestor:n,type:"same"};const t=new Map;for(let[r,i]=bs(n);r;i=r,r=r.getParent())t.set(r,i);for(let[r,i]=bs(e);r;i=r,r=r.getParent()){const o=t.get(r);if(o!==void 0)return o===null?(Qn(n,r)||E(276),{commonAncestor:r,type:"ancestor"}):i===null?(Qn(e,r)||E(277),{commonAncestor:r,type:"descendant"}):((v(o)||Qn(n,o))&&(v(i)||Qn(e,i))&&r.is(o.getParent())&&r.is(i.getParent())||E(278),{a:o,b:i,commonAncestor:r,type:"branch"})}return null}function Ue(n,e){const{type:t,key:r,offset:i}=n,o=Bu(n.key);return t==="text"?(M(o)||E(266,o.getType(),r),bt(o,e,i)):(v(o)||E(267,o.getType(),r),id(o,n.offset,e))}function Mn(n,e){const{origin:t,direction:r}=e,i=r==="next";Xe(e)?n.set(t.getKey(),e.offset,"text"):vt(e)?M(t)?n.set(t.getKey(),Qe(t,r),"text"):n.set(t.getParentOrThrow().getKey(),t.getIndexWithinParent()+(i?1:0),"element"):(Ae(e)&&v(t)||E(268),n.set(t.getKey(),i?0:t.getChildrenSize(),"element"))}function nd(n){const e=F(),t=A(e)?e:Xl();return lr(t,n),fe(t),t}function lr(n,e){Mn(n.anchor,e.anchor),Mn(n.focus,e.focus)}function ws(n){const{anchor:e,focus:t}=n,r=Ue(e,"next"),i=Ue(t,"next"),o=Ca(r,i)<=0?"next":"previous";return nt(Qt(r,o),Qt(i,o))}function mo(n){const{direction:e,origin:t}=n,r=le(t,sn(e)).getNodeAtCaret();return r?le(r,e):De(t.getParentOrThrow(),e)}function ks(n,e="root"){const t=[n];for(let r=Ae(n)?n.getParentCaret(e):n.getSiblingCaret();r!==null;r=r.getParentCaret(e))t.push(mo(r));return t}function ri(n){return!!n&&n.origin.isAttached()}function rd(n,e="removeEmptySlices"){if(n.isCollapsed())return n;const t="root",r="next";let i=e;const o=wa(n,r),s=ks(o.anchor,t),l=ks(o.focus.getFlipped(),t),a=new Set,c=[];for(const h of o.iterNodeCarets(t))if(Ae(h))a.add(h.origin.getKey());else if(vt(h)){const{origin:p}=h;v(p)&&!a.has(p.getKey())||c.push(p)}for(const h of c)h.remove();for(const h of o.getTextSlices()){if(!h)continue;const{origin:p}=h.caret,m=p.getTextContentSize(),x=mo(le(p,r)),y=p.getMode();if(Math.abs(h.distance)===m&&i==="removeEmptySlices"||y==="token"&&h.distance!==0)x.remove();else if(h.distance!==0){i="removeEmptySlices";let C=h.removeTextSlice();const k=h.caret.origin;if(y==="segmented"){const T=C.origin,b=Z(T.getTextContent()).setStyle(T.getStyle()).setFormat(T.getFormat());x.replaceOrInsert(b),C=bt(b,r,C.offset)}k.is(s[0].origin)&&(s[0]=C),k.is(l[0].origin)&&(l[0]=C.getFlipped())}}let u,f;for(const h of s)if(ri(h)){u=Ee(h);break}for(const h of l)if(ri(h)){f=Ee(h);break}const d=(function(h,p,m){if(!h||!p)return null;const x=h.getParentAtCaret(),y=p.getParentAtCaret();if(!x||!y)return null;const C=x.getParents().reverse();C.push(x);const k=y.getParents().reverse();k.push(y);const T=Math.min(C.length,k.length);let b;for(b=0;b<T&&C[b]===k[b];b++);const N=(O,L)=>{let R;for(let $=b;$<O.length;$++){const z=O[$];if(He(z))return;!R&&L(z)&&(R=z)}return R},w=N(C,Ye),_=w&&N(k,O=>m.has(O.getKey())&&Ye(O));return w&&_?[w,_]:null})(u,f,a);if(d){const[h,p]=d;De(h,"previous").splice(0,p.getChildren()),p.remove()}const g=[u,f,...s,...l].find(ri);if(g)return td(Qt(Ee(g),n.direction));E(269,JSON.stringify(s.map(h=>h.origin.__key)))}function Ee(n){const e=(function(i){let o=i;for(;Ae(o);){const s=fo(o);if(!Ae(s))break;o=s}return o})(n.getLatest()),{direction:t}=e;if(M(e.origin))return Xe(e)?e:bt(e.origin,t,t);const r=e.getAdjacentCaret();return vt(r)&&M(r.origin)?bt(r.origin,t,sn(t)):e}function ba(n){return Xe(n)&&n.offset!==Qe(n.origin,n.direction)}function Qt(n,e){return n.direction===e?n:n.getFlipped()}function wa(n,e){return n.direction===e?n:nt(Qt(n.focus,e),Qt(n.anchor,e))}function id(n,e,t){let r=De(n,"next");for(let i=0;i<e;i++){const o=r.getAdjacentCaret();if(o===null)break;r=o}return Qt(r,t)}function od(...n){return n}function sd(n,e){if(!e||n===e)return n;for(const t in e)if(n[t]!==e[t])return{...n,...e};return n}const ka=P.createContext(null);function ld(n,e){return{getTheme:function(){return e??null}}}function Ve(){const n=P.useContext(ka);return n==null&&(function(e,...t){const r=new URL("https://lexical.dev/docs/error"),i=new URLSearchParams;i.append("code",e);for(const o of t)i.append("v",o);throw r.search=i.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)})(8),n}const Na=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,ad=Na?P.useLayoutEffect:P.useEffect,Zn={tag:ct};function cd({initialConfig:n,children:e}){const t=P.useMemo(()=>{const{theme:r,namespace:i,nodes:o,onError:s,editorState:l,html:a}=n,c=ld(null,r),u=la({editable:n.editable,html:a,namespace:i,nodes:o,onError:f=>s(f,u),theme:r});return(function(f,d){if(d!==null){if(d===void 0)f.update(()=>{const g=V();if(g.isEmpty()){const h=Q();g.append(h);const p=Na?document.activeElement:null;(F()!==null||p!==null&&p===f.getRootElement())&&h.select()}},Zn);else if(d!==null)switch(typeof d){case"string":{const g=f.parseEditorState(d);f.setEditorState(g,Zn);break}case"object":f.setEditorState(d,Zn);break;case"function":f.update(()=>{V().isEmpty()&&d(f)},Zn)}}})(u,l),[u,c]},[]);return ad(()=>{const r=n.editable,[i]=t;i.setEditable(r===void 0||r)},[]),S.jsx(ka.Provider,{value:t,children:e})}const ud=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?P.useLayoutEffect:P.useEffect;function dd(n){return{initialValueFn:()=>n.isEditable(),subscribe:e=>n.registerEditableListener(e)}}function fd(){return(function(n){const[e]=Ve(),t=P.useMemo(()=>n(e),[e,n]),[r,i]=P.useState(()=>t.initialValueFn()),o=P.useRef(r);return ud(()=>{const{initialValueFn:s,subscribe:l}=t,a=s();return o.current!==a&&(o.current=a,i(a)),l(c=>{o.current=c,i(c)})},[t,n]),r})(dd)}const $i=new Map;function Ta(n){const e={};if(!n)return e;const t=n.split(";");for(const r of t)if(r!==""){const[i,o]=r.split(/:([^]+)/);i&&o&&(e[i.trim()]=o.trim())}return e}function Ns(n){let e=$i.get(n);return e===void 0&&(e=Ta(n),$i.set(n,e)),e}function Ea(n){const e=Pr().getElementByKey(n.getKey());if(e===null)return null;const t=e.ownerDocument.defaultView;return t===null?null:t.getComputedStyle(e)}function Oa(n){return Ea(G(n)?n:n.getParentOrThrow())}function Ts(n){const e=Oa(n);return e!==null&&e.direction==="rtl"}function Aa(n,e,t="self"){const r=n.getStartEndPoints();if(e.isSelected(n)&&!Ie(e)&&r!==null){const[i,o]=r,s=n.isBackward(),l=i.getNode(),a=o.getNode(),c=e.is(l),u=e.is(a);if(c||u){const[f,d]=Ei(n),g=l.is(a),h=e.is(s?a:l),p=e.is(s?l:a);let m,x=0;g?(x=f>d?d:f,m=f>d?f:d):h?(x=s?d:f,m=void 0):p&&(x=0,m=s?f:d);const y=e.__text.slice(x,m);y!==e.__text&&(t==="clone"&&(e=Ju(e)),e.__text=y)}}return e}function hd(n){const e=n.getStyle(),t=Ta(e);$i.set(e,t)}function Ma(n){const e=Da(n);return e!==null&&e.writingMode==="vertical-rl"}function Da(n){const e=n.anchor.getNode();return v(e)?Ea(e):Oa(e)}function Es(n,e){let t=Ma(n)?!e:e;Fa(n)&&(t=!t);const r=Ue(n.focus,t?"previous":"next");if(ba(r))return!1;for(const i of go(r)){if(Ae(i))return!i.origin.isInline();if(!v(i.origin)){if(W(i.origin))return!0;break}}return!1}function gd(n,e,t,r){n.modify(e?"extend":"move",t,r)}function Fa(n){const e=Da(n);return e!==null&&e.direction==="rtl"}function Os(n,e,t){const r=Fa(n);let i;i=Ma(n)||r?!t:t,gd(n,e,i,"character")}function pd(n,...e){const t=new URL("https://lexical.dev/docs/error"),r=new URLSearchParams;r.append("code",n);for(const i of e)r.append("v",i);throw t.search=r.toString(),Error(`Minified Lexical error #${n}; visit ${t.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}const La=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,md=La&&"documentMode"in document?document.documentMode:null;!(!La||!("InputEvent"in window)||md)&&"getTargetRanges"in new window.InputEvent("input");function Pa(...n){const e=[];for(const t of n)if(t&&typeof t=="string")for(const[r]of t.matchAll(/\S+/g))e.push(r);return e}function wt(...n){return()=>{for(let e=n.length-1;e>=0;e--)n[e]();n.length=0}}function _e(n,...e){const t=Pa(...e);t.length>0&&n.classList.add(...t)}function Ht(n,...e){const t=Pa(...e);t.length>0&&n.classList.remove(...t)}function _d(n){const e=ht(n,t=>v(t)&&!t.isInline());return v(e)||pd(4,n.__key),e}function lt(n,e){return n!==null&&Object.getPrototypeOf(n).constructor.name===e.name}function $a(n,e){const t=[],r=Array.from(n).reverse();for(let i=r.pop();i!==void 0;i=r.pop())if(e(i))t.push(i);else if(v(i))for(const o of yd(i))r.push(o);return t}function yd(n){return xd(De(n,"previous"))}function xd(n){return po({hasNext:vt,initial:n.getAdjacentCaret(),map:e=>e.origin.getLatest(),step:e=>e.getAdjacentCaret()})}const Sd=Symbol.for("preact-signals");function Ir(){if(Ze>1)return void Ze--;let n,e=!1;for(;Cn!==void 0;){let t=Cn;for(Cn=void 0,Ii++;t!==void 0;){const r=t.o;if(t.o=void 0,t.f&=-3,!(8&t.f)&&Ia(t))try{t.c()}catch(i){e||(n=i,e=!0)}t=r}}if(Ii=0,Ze--,e)throw n}function Cd(n){if(Ze>0)return n();Ze++;try{return n()}finally{Ir()}}let B,Cn;function As(n){const e=B;B=void 0;try{return n()}finally{B=e}}let Ze=0,Ii=0,ar=0;function Ms(n){if(B===void 0)return;let e=n.n;return e===void 0||e.t!==B?(e={i:0,S:n,p:B.s,n:void 0,t:B,e:void 0,x:void 0,r:e},B.s!==void 0&&(B.s.n=e),B.s=e,n.n=e,32&B.f&&n.S(e),e):e.i===-1?(e.i=0,e.n!==void 0&&(e.n.p=e.p,e.p!==void 0&&(e.p.n=e.n),e.p=B.s,e.n=void 0,B.s.n=e,B.s=e),e):void 0}function ae(n,e){this.v=n,this.i=0,this.n=void 0,this.t=void 0,this.W=e?.watched,this.Z=e?.unwatched,this.name=e?.name}function vd(n,e){return new ae(n,e)}function Ia(n){for(let e=n.s;e!==void 0;e=e.n)if(e.S.i!==e.i||!e.S.h()||e.S.i!==e.i)return!0;return!1}function Ds(n){for(let e=n.s;e!==void 0;e=e.n){const t=e.S.n;if(t!==void 0&&(e.r=t),e.S.n=e,e.i=-1,e.n===void 0){n.s=e;break}}}function Ra(n){let e,t=n.s;for(;t!==void 0;){const r=t.p;t.i===-1?(t.S.U(t),r!==void 0&&(r.n=t.n),t.n!==void 0&&(t.n.p=r)):e=t,t.S.n=t.r,t.r!==void 0&&(t.r=void 0),t=r}n.s=e}function Mt(n,e){ae.call(this,void 0),this.x=n,this.s=void 0,this.g=ar-1,this.f=4,this.W=e?.watched,this.Z=e?.unwatched,this.name=e?.name}function za(n){const e=n.u;if(n.u=void 0,typeof e=="function"){Ze++;const t=B;B=void 0;try{e()}catch(r){throw n.f&=-2,n.f|=8,_o(n),r}finally{B=t,Ir()}}}function _o(n){for(let e=n.s;e!==void 0;e=e.n)e.S.U(e);n.x=void 0,n.s=void 0,za(n)}function bd(n){if(B!==this)throw new Error("Out-of-order effect");Ra(this),B=n,this.f&=-2,8&this.f&&_o(this),Ir()}function It(n,e){this.x=n,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32,this.name=e?.name}function yo(n,e){const t=new It(n,e);try{t.c()}catch(i){throw t.d(),i}const r=t.d.bind(t);return r[Symbol.dispose]=r,r}function wd(n,e={}){const t={};for(const r in n){const i=e[r],o=vd(i===void 0?n[r]:i);t[r]=o}return t}ae.prototype.brand=Sd,ae.prototype.h=function(){return!0},ae.prototype.S=function(n){const e=this.t;e!==n&&n.e===void 0&&(n.x=e,this.t=n,e!==void 0?e.e=n:As(()=>{var t;(t=this.W)==null||t.call(this)}))},ae.prototype.U=function(n){if(this.t!==void 0){const e=n.e,t=n.x;e!==void 0&&(e.x=t,n.e=void 0),t!==void 0&&(t.e=e,n.x=void 0),n===this.t&&(this.t=t,t===void 0&&As(()=>{var r;(r=this.Z)==null||r.call(this)}))}},ae.prototype.subscribe=function(n){return yo(()=>{const e=this.value,t=B;B=void 0;try{n(e)}finally{B=t}},{name:"sub"})},ae.prototype.valueOf=function(){return this.value},ae.prototype.toString=function(){return this.value+""},ae.prototype.toJSON=function(){return this.value},ae.prototype.peek=function(){const n=B;B=void 0;try{return this.value}finally{B=n}},Object.defineProperty(ae.prototype,"value",{get(){const n=Ms(this);return n!==void 0&&(n.i=this.i),this.v},set(n){if(n!==this.v){if(Ii>100)throw new Error("Cycle detected");this.v=n,this.i++,ar++,Ze++;try{for(let e=this.t;e!==void 0;e=e.x)e.t.N()}finally{Ir()}}}}),Mt.prototype=new ae,Mt.prototype.h=function(){if(this.f&=-3,1&this.f)return!1;if((36&this.f)==32||(this.f&=-5,this.g===ar))return!0;if(this.g=ar,this.f|=1,this.i>0&&!Ia(this))return this.f&=-2,!0;const n=B;try{Ds(this),B=this;const e=this.x();(16&this.f||this.v!==e||this.i===0)&&(this.v=e,this.f&=-17,this.i++)}catch(e){this.v=e,this.f|=16,this.i++}return B=n,Ra(this),this.f&=-2,!0},Mt.prototype.S=function(n){if(this.t===void 0){this.f|=36;for(let e=this.s;e!==void 0;e=e.n)e.S.S(e)}ae.prototype.S.call(this,n)},Mt.prototype.U=function(n){if(this.t!==void 0&&(ae.prototype.U.call(this,n),this.t===void 0)){this.f&=-33;for(let e=this.s;e!==void 0;e=e.n)e.S.U(e)}},Mt.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(let n=this.t;n!==void 0;n=n.x)n.t.N()}},Object.defineProperty(Mt.prototype,"value",{get(){if(1&this.f)throw new Error("Cycle detected");const n=Ms(this);if(this.h(),n!==void 0&&(n.i=this.i),16&this.f)throw this.v;return this.v}}),It.prototype.c=function(){const n=this.S();try{if(8&this.f||this.x===void 0)return;const e=this.x();typeof e=="function"&&(this.u=e)}finally{n()}},It.prototype.S=function(){if(1&this.f)throw new Error("Cycle detected");this.f|=1,this.f&=-9,za(this),Ds(this),Ze++;const n=B;return B=this,bd.bind(this,n)},It.prototype.N=function(){2&this.f||(this.f|=2,this.o=Cn,Cn=this)},It.prototype.d=function(){this.f|=8,1&this.f||_o(this)},It.prototype.dispose=function(){this.d()};function kd(n){return(typeof n.nodes=="function"?n.nodes():n.nodes)||[]}function U(n,...e){const t=new URL("https://lexical.dev/docs/error"),r=new URLSearchParams;r.append("code",n);for(const i of e)r.append("v",i);throw t.search=r.toString(),Error(`Minified Lexical error #${n}; visit ${t.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function ja(n,e){if(n&&e&&!Array.isArray(e)&&typeof n=="object"&&typeof e=="object"){const t=n,r=e;for(const i in r)t[i]=ja(t[i],r[i]);return n}return e}const xo=0,Ri=1,Wa=2,ii=3,er=4,Dt=5,oi=6,dn=7;function si(n){return n.id===xo}function Ba(n){return n.id===Wa}function Nd(n){return(function(e){return e.id===Ri})(n)||U(305,String(n.id),String(Ri)),Object.assign(n,{id:Wa})}const Td=new Set;class Ed{builder;configs;_dependency;_peerNameSet;extension;state;_signal;constructor(e,t){this.builder=e,this.extension=t,this.configs=new Set,this.state={id:xo}}mergeConfigs(){let e=this.extension.config||{};const t=this.extension.mergeConfig?this.extension.mergeConfig.bind(this.extension):sd;for(const r of this.configs)e=t(e,r);return e}init(e){const t=this.state;Ba(t)||U(306,String(t.id));const r={getDependency:this.getInitDependency.bind(this),getDirectDependentNames:this.getDirectDependentNames.bind(this),getPeer:this.getInitPeer.bind(this),getPeerNameSet:this.getPeerNameSet.bind(this)},i={...r,getDependency:this.getDependency.bind(this),getInitResult:this.getInitResult.bind(this),getPeer:this.getPeer.bind(this)},o=(function(l,a,c){return Object.assign(l,{config:a,id:ii,registerState:c})})(t,this.mergeConfigs(),r);let s;this.state=o,this.extension.init&&(s=this.extension.init(e,o.config,r)),this.state=(function(l,a,c){return Object.assign(l,{id:er,initResult:a,registerState:c})})(o,s,i)}build(e){const t=this.state;let r;t.id!==er&&U(307,String(t.id),String(Dt)),this.extension.build&&(r=this.extension.build(e,t.config,t.registerState));const i={...t.registerState,getOutput:()=>r,getSignal:this.getSignal.bind(this)};this.state=(function(o,s,l){return Object.assign(o,{id:Dt,output:s,registerState:l})})(t,r,i)}register(e,t){this._signal=t;const r=this.state;r.id!==Dt&&U(308,String(r.id),String(Dt));const i=this.extension.register&&this.extension.register(e,r.config,r.registerState);return this.state=(function(o){return Object.assign(o,{id:oi})})(r),()=>{const o=this.state;o.id!==dn&&U(309,String(r.id),String(dn)),this.state=(function(s){return Object.assign(s,{id:Dt})})(o),i&&i()}}afterRegistration(e){const t=this.state;let r;return t.id!==oi&&U(310,String(t.id),String(oi)),this.extension.afterRegistration&&(r=this.extension.afterRegistration(e,t.config,t.registerState)),this.state=(function(i){return Object.assign(i,{id:dn})})(t),r}getSignal(){return this._signal===void 0&&U(311),this._signal}getInitResult(){this.extension.init===void 0&&U(312,this.extension.name);const e=this.state;return(function(t){return t.id>=er})(e)||U(313,String(e.id),String(er)),e.initResult}getInitPeer(e){const t=this.builder.extensionNameMap.get(e);return t?t.getExtensionInitDependency():void 0}getExtensionInitDependency(){const e=this.state;return(function(t){return t.id>=ii})(e)||U(314,String(e.id),String(ii)),{config:e.config}}getPeer(e){const t=this.builder.extensionNameMap.get(e);return t?t.getExtensionDependency():void 0}getInitDependency(e){const t=this.builder.getExtensionRep(e);return t===void 0&&U(315,this.extension.name,e.name),t.getExtensionInitDependency()}getDependency(e){const t=this.builder.getExtensionRep(e);return t===void 0&&U(315,this.extension.name,e.name),t.getExtensionDependency()}getState(){const e=this.state;return(function(t){return t.id>=dn})(e)||U(316,String(e.id),String(dn)),e}getDirectDependentNames(){return this.builder.incomingEdges.get(this.extension.name)||Td}getPeerNameSet(){let e=this._peerNameSet;return e||(e=new Set((this.extension.peerDependencies||[]).map(([t])=>t)),this._peerNameSet=e),e}getExtensionDependency(){if(!this._dependency){const e=this.state;(function(t){return t.id>=Dt})(e)||U(317,this.extension.name),this._dependency={config:e.config,init:e.initResult,output:e.output}}return this._dependency}}const Fs={tag:ct};function Od(){const n=V();n.isEmpty()&&n.append(Q())}const Ad={config:{setOptions:Fs,updateOptions:Fs},init:({$initialEditorState:n=Od})=>({$initialEditorState:n,initialized:!1}),afterRegistration(n,{updateOptions:e,setOptions:t},r){const i=r.getInitResult();if(!i.initialized){i.initialized=!0;const{$initialEditorState:o}=i;if(Ou(o))n.setEditorState(o,t);else if(typeof o=="function")n.update(()=>{o(n)},e);else if(o&&(typeof o=="string"||typeof o=="object")){const s=n.parseEditorState(o);n.setEditorState(s,t)}}return()=>{}},name:"@lexical/extension/InitialState",nodes:[nn,kt,Zt,en,rn]},Ls=Symbol.for("@lexical/extension/LexicalBuilder");function Ps(){}function Md(n){throw n}function tr(n){return Array.isArray(n)?n:[n]}const li="0.38.2+prod.esm";class Vt{roots;extensionNameMap;outgoingConfigEdges;incomingEdges;conflicts;_sortedExtensionReps;PACKAGE_VERSION;constructor(e){this.outgoingConfigEdges=new Map,this.incomingEdges=new Map,this.extensionNameMap=new Map,this.conflicts=new Map,this.PACKAGE_VERSION=li,this.roots=e;for(const t of e)this.addExtension(t)}static fromExtensions(e){const t=[tr(Ad)];for(const r of e)t.push(tr(r));return new Vt(t)}static maybeFromEditor(e){const t=e[Ls];return t&&(t.PACKAGE_VERSION!==li&&U(292,t.PACKAGE_VERSION,li),t instanceof Vt||U(293)),t}static fromEditor(e){const t=Vt.maybeFromEditor(e);return t===void 0&&U(294),t}constructEditor(){const{$initialEditorState:e,onError:t,...r}=this.buildCreateEditorArgs(),i=Object.assign(la({...r,...t?{onError:o=>{t(o,i)}}:{}}),{[Ls]:this});for(const o of this.sortedExtensionReps())o.build(i);return i}buildEditor(){let e=Ps;function t(){try{e()}finally{e=Ps}}const r=Object.assign(this.constructEditor(),{dispose:t,[Symbol.dispose]:t});return e=wt(this.registerEditor(r),()=>r.setRootElement(null)),r}hasExtensionByName(e){return this.extensionNameMap.has(e)}getExtensionRep(e){const t=this.extensionNameMap.get(e.name);if(t)return t.extension!==e&&U(295,e.name),t}addEdge(e,t,r){const i=this.outgoingConfigEdges.get(e);i?i.set(t,r):this.outgoingConfigEdges.set(e,new Map([[t,r]]));const o=this.incomingEdges.get(t);o?o.add(e):this.incomingEdges.set(t,new Set([e]))}addExtension(e){this._sortedExtensionReps!==void 0&&U(296);const t=tr(e),[r]=t;typeof r.name!="string"&&U(297,typeof r.name);let i=this.extensionNameMap.get(r.name);if(i!==void 0&&i.extension!==r&&U(298,r.name),!i){i=new Ed(this,r),this.extensionNameMap.set(r.name,i);const o=this.conflicts.get(r.name);typeof o=="string"&&U(299,r.name,o);for(const s of r.conflictsWith||[])this.extensionNameMap.has(s)&&U(299,r.name,s),this.conflicts.set(s,r.name);for(const s of r.dependencies||[]){const l=tr(s);this.addEdge(r.name,l[0].name,l.slice(1)),this.addExtension(l)}for(const[s,l]of r.peerDependencies||[])this.addEdge(r.name,s,l?[l]:[])}}sortedExtensionReps(){if(this._sortedExtensionReps)return this._sortedExtensionReps;const e=[],t=(r,i)=>{let o=r.state;if(Ba(o))return;const s=r.extension.name;var l;si(o)||U(300,s,i||"[unknown]"),si(l=o)||U(304,String(l.id),String(xo)),o=Object.assign(l,{id:Ri}),r.state=o;const a=this.outgoingConfigEdges.get(s);if(a)for(const c of a.keys()){const u=this.extensionNameMap.get(c);u&&t(u,s)}o=Nd(o),r.state=o,e.push(r)};for(const r of this.extensionNameMap.values())si(r.state)&&t(r);for(const r of e)for(const[i,o]of this.outgoingConfigEdges.get(r.extension.name)||[])if(o.length>0){const s=this.extensionNameMap.get(i);if(s)for(const l of o)s.configs.add(l)}for(const[r,...i]of this.roots)if(i.length>0){const o=this.extensionNameMap.get(r.name);o===void 0&&U(301,r.name);for(const s of i)o.configs.add(s)}return this._sortedExtensionReps=e,this._sortedExtensionReps}registerEditor(e){const t=this.sortedExtensionReps(),r=new AbortController,i=[()=>r.abort()],o=r.signal;for(const s of t){const l=s.register(e,o);l&&i.push(l)}for(const s of t){const l=s.afterRegistration(e);l&&i.push(l)}return wt(...i)}buildCreateEditorArgs(){const e={},t=new Set,r=new Map,i=new Map,o={},s={},l=this.sortedExtensionReps();for(const u of l){const{extension:f}=u;if(f.onError!==void 0&&(e.onError=f.onError),f.disableEvents!==void 0&&(e.disableEvents=f.disableEvents),f.parentEditor!==void 0&&(e.parentEditor=f.parentEditor),f.editable!==void 0&&(e.editable=f.editable),f.namespace!==void 0&&(e.namespace=f.namespace),f.$initialEditorState!==void 0&&(e.$initialEditorState=f.$initialEditorState),f.nodes)for(const d of kd(f)){if(typeof d!="function"){const g=r.get(d.replace);g&&U(302,f.name,d.replace.name,g.extension.name),r.set(d.replace,u)}t.add(d)}if(f.html){if(f.html.export)for(const[d,g]of f.html.export.entries())i.set(d,g);f.html.import&&Object.assign(o,f.html.import)}f.theme&&ja(s,f.theme)}Object.keys(s).length>0&&(e.theme=s),t.size&&(e.nodes=[...t]);const a=Object.keys(o).length>0,c=i.size>0;(a||c)&&(e.html={},a&&(e.html.import=o),c&&(e.html.export=i));for(const u of l)u.init(e);return e.onError||(e.onError=Md),e}}function Dd(n,e){const t=Vt.fromEditor(n).extensionNameMap.get(e);return t?t.getExtensionDependency():void 0}const Fd={name:"@lexical/react/ReactProvider"};function Ld(){return V().getTextContent()}function Pd(n,e=!0){if(n)return!1;let t=Ld();return e&&(t=t.trim()),t===""}function $d(n){if(!Pd(n,!1))return!1;const e=V().getChildren(),t=e.length;if(t>1)return!1;for(let r=0;r<t;r++){const i=e[r];if(W(i))return!1;if(v(i)){if(!Qi(i)||i.__indent!==0)return!1;const o=i.getChildren(),s=o.length;for(let l=0;l<s;l++){const a=o[r];if(!M(a))return!1}}}return!0}function Ka(n){return()=>$d(n)}function Id(n){const e=window.location.origin,t=r=>{if(r.origin!==e)return;const i=n.getRootElement();if(document.activeElement!==i)return;const o=r.data;if(typeof o=="string"){let s;try{s=JSON.parse(o)}catch{return}if(s&&s.protocol==="nuanria_messaging"&&s.type==="request"){const l=s.payload;if(l&&l.functionId==="makeChanges"){const a=l.args;if(a){const[c,u,f,d,g]=a;n.update(()=>{const h=F();if(A(h)){const p=h.anchor;let m=p.getNode(),x=0,y=0;if(M(m)&&c>=0&&u>=0&&(x=c,y=c+u,h.setTextNodeRange(m,x,m,y)),x===y&&f===""||(h.insertRawText(f),m=p.getNode()),M(m)){x=d,y=d+g;const C=m.getTextContentSize();x=x>C?C:x,y=y>C?C:y,h.setTextNodeRange(m,x,m,y)}r.stopImmediatePropagation()}})}}}}};return window.addEventListener("message",t,!0),()=>{window.removeEventListener("message",t,!0)}}function vn(n,e){const t=ua(e)?e.body.childNodes:e.childNodes;let r=[];const i=[];for(const o of t)if(!Ha.has(o.nodeName)){const s=Va(o,n,i,!1);s!==null&&(r=r.concat(s))}return(function(o){for(const s of o)s.getNextSibling()instanceof Xi&&s.insertAfter(yt());for(const s of o){const l=s.getChildren();for(const a of l)s.insertBefore(a);s.remove()}})(i),r}function Ua(n,e){if(typeof document>"u"||typeof window>"u"&&global.window===void 0)throw new Error("To use $generateHtmlFromNodes in headless mode please initialize a headless browser implementation such as JSDom before calling this function.");const t=document.createElement("div"),r=V().getChildren();for(let i=0;i<r.length;i++)Ja(n,r[i],t,e);return t.innerHTML}function Ja(n,e,t,r=null){let i=r===null||e.isSelected(r);const o=v(e)&&e.excludeFromCopy("html");let s=e;r!==null&&M(e)&&(s=Aa(r,e,"clone"));const l=v(s)?s.getChildren():[],a=eo(n,s.getType());let c;c=a&&a.exportDOM!==void 0?a.exportDOM(n,s):s.exportDOM(n);const{element:u,after:f}=c;if(!u)return!1;const d=document.createDocumentFragment();for(let g=0;g<l.length;g++){const h=l[g],p=Ja(n,h,d,r);!i&&v(e)&&p&&e.extractWithChild(h,r,"html")&&(i=!0)}if(i&&!o){if((J(u)||Li(u))&&u.append(d),t.append(u),f){const g=f.call(s,u);g&&(Li(u)?u.replaceChildren(g):u.replaceWith(g))}}else t.append(d);return i}const Ha=new Set(["STYLE","SCRIPT"]);function Va(n,e,t,r,i=new Map,o){let s=[];if(Ha.has(n.nodeName))return s;let l=null;const a=(function(h,p){const{nodeName:m}=h,x=p._htmlConversions.get(m.toLowerCase());let y=null;if(x!==void 0)for(const C of x){const k=C(h);k!==null&&(y===null||(y.priority||0)<=(k.priority||0))&&(y=k)}return y!==null?y.conversion:null})(n,e),c=a?a(n):null;let u=null;if(c!==null){u=c.after;const h=c.node;if(l=Array.isArray(h)?h[h.length-1]:h,l!==null){for(const[,p]of i)if(l=p(l,o),!l)break;l&&s.push(...Array.isArray(h)?h:[l])}c.forChild!=null&&i.set(n.nodeName,c.forChild)}const f=n.childNodes;let d=[];const g=(l==null||!He(l))&&(l!=null&&Oi(l)||r);for(let h=0;h<f.length;h++)d.push(...Va(f[h],e,t,g,new Map(i),l));return u!=null&&(d=u(d)),wr(n)&&(d=Rd(n,d,g?()=>{const h=new Xi;return t.push(h),h}:Q)),l==null?d.length>0?s=s.concat(d):wr(n)&&(function(h){return h.nextSibling==null||h.previousSibling==null?!1:Pi(h.nextSibling)&&Pi(h.previousSibling)})(n)&&(s=s.concat(yt())):v(l)&&l.append(...d),s}function Rd(n,e,t){const r=n.style.textAlign,i=[];let o=[];for(let s=0;s<e.length;s++){const l=e[s];if(Oi(l))r&&!l.getFormat()&&l.setFormat(r),i.push(l);else if(o.push(l),s===e.length-1||s<e.length-1&&Oi(e[s+1])){const a=t();a.setFormat(r),a.append(...o),i.push(a),o=[]}}return i}function kr(n,...e){const t=new URL("https://lexical.dev/docs/error"),r=new URLSearchParams;r.append("code",n);for(const i of e)r.append("v",i);throw t.search=r.toString(),Error(`Minified Lexical error #${n}; visit ${t.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function zd(n,e=F()){return e==null&&kr(166),A(e)&&e.isCollapsed()||e.getNodes().length===0?"":Ua(n,e)}function jd(n,e=F()){return e==null&&kr(166),A(e)&&e.isCollapsed()||e.getNodes().length===0?null:JSON.stringify(Wd(n,e))}function $s(n,e,t){const r=n.getData("application/x-lexical-editor");if(r)try{const l=JSON.parse(r);if(l.namespace===t._config.namespace&&Array.isArray(l.nodes))return Is(t,Bd(l.nodes),e)}catch(l){console.error(l)}const i=n.getData("text/html"),o=n.getData("text/plain");if(i&&o!==i)try{const l=new DOMParser().parseFromString((function(a){return window.trustedTypes&&window.trustedTypes.createPolicy?window.trustedTypes.createPolicy("lexical",{createHTML:c=>c}).createHTML(a):a})(i),"text/html");return Is(t,vn(t,l),e)}catch(l){console.error(l)}const s=o||n.getData("text/uri-list");if(s!=null)if(A(e)){const l=s.split(/(\r?\n|\t)/);l[l.length-1]===""&&l.pop();for(let a=0;a<l.length;a++){const c=F();if(A(c)){const u=l[a];u===`
`||u===`\r
`?c.insertParagraph():u==="	"?c.insertNodes([Fn()]):c.insertText(u)}}}else e.insertRawText(s)}function Is(n,e,t){n.dispatchCommand(Gc,{nodes:e,selection:t})||(t.insertNodes(e),(function(r){if(A(r)&&r.isCollapsed()){const i=r.anchor;let o=null;const s=Ue(i,"previous");if(s)if(Xe(s))o=s.origin;else{const l=nt(s,De(V(),"next").getFlipped());for(const a of l){if(M(a.origin)){o=a.origin;break}if(v(a.origin)&&!a.origin.isInline())break}}if(o&&M(o)){const l=o.getFormat(),a=o.getStyle();r.format===l&&r.style===a||(r.format=l,r.style=a,r.dirty=!0)}}})(t))}function qa(n,e,t,r=[]){let i=e===null||t.isSelected(e);const o=v(t)&&t.excludeFromCopy("html");let s=t;e!==null&&M(s)&&(s=Aa(e,s,"clone"));const l=v(s)?s.getChildren():[],a=(function(c){const u=c.exportJSON(),f=c.constructor;if(u.type!==f.getType()&&kr(58,f.name),v(c)){const d=u.children;Array.isArray(d)||kr(59,f.name)}return u})(s);M(s)&&s.getTextContentSize()===0&&(i=!1);for(let c=0;c<l.length;c++){const u=l[c],f=qa(n,e,u,a.children);!i&&v(t)&&f&&t.extractWithChild(u,e,"clone")&&(i=!0)}if(i&&!o)r.push(a);else if(Array.isArray(a.children))for(let c=0;c<a.children.length;c++){const u=a.children[c];r.push(u)}return i}function Wd(n,e){const t=[],r=V().getChildren();for(let i=0;i<r.length;i++)qa(n,e,r[i],t);return{namespace:n._config.namespace,nodes:t}}function Bd(n){const e=[];for(let t=0;t<n.length;t++){const r=n[t],i=Eu(r);M(i)&&hd(i),e.push(i)}return e}let Ft=null;async function Rs(n,e,t){if(Ft!==null)return!1;if(e!==null)return new Promise((c,u)=>{n.update(()=>{c(zs(n,e,t))})});const r=n.getRootElement(),i=n._window||window,o=i.document,s=ve(i);if(r===null||s===null)return!1;const l=o.createElement("span");l.style.cssText="position: fixed; top: -1000px;",l.append(o.createTextNode("#")),r.append(l);const a=new Range;return a.setStart(l,0),a.setEnd(l,1),s.removeAllRanges(),s.addRange(a),new Promise((c,u)=>{const f=n.registerCommand(Or,d=>(lt(d,ClipboardEvent)&&(f(),Ft!==null&&(i.clearTimeout(Ft),Ft=null),c(zs(n,d,t))),!0),Mu);Ft=i.setTimeout(()=>{f(),Ft=null,c(!1)},50),o.execCommand("copy"),l.remove()})}function zs(n,e,t){if(t===void 0){const i=ve(n._window),o=F();if(!o||o.isCollapsed()||!i)return!1;const s=i.anchorNode,l=i.focusNode;if(s!==null&&l!==null&&!$n(n,s,l))return!1;t=Kd(o)}e.preventDefault();const r=e.clipboardData;return r!==null&&(Ud(r,t),!0)}const Ya=[["text/html",zd],["application/x-lexical-editor",jd]];function Kd(n=F()){const e={"text/plain":n?n.getTextContent():""};if(n){const t=Pr();for(const[r,i]of Ya){const o=i(t,n);o!==null&&(e[r]=o)}}return e}function Ud(n,e){for(const[t]of Ya)e[t]===void 0&&n.setData(t,"");for(const t in e){const r=e[t];r!==void 0&&n.setData(t,r)}}function js(n,e){if(document.caretRangeFromPoint!==void 0){const t=document.caretRangeFromPoint(n,e);return t===null?null:{node:t.startContainer,offset:t.startOffset}}if(document.caretPositionFromPoint!=="undefined"){const t=document.caretPositionFromPoint(n,e);return t===null?null:{node:t.offsetNode,offset:t.offset}}return null}const Tt=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,Jd=Tt&&"documentMode"in document?document.documentMode:null,Hd=Tt&&/Mac|iPod|iPhone|iPad/.test(navigator.platform),Vd=!(!Tt||!("InputEvent"in window)||Jd)&&"getTargetRanges"in new window.InputEvent("input"),qd=Tt&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),Ws=Tt&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,Yd=Tt&&/^(?=.*Chrome).*/i.test(navigator.userAgent),Gd=Tt&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&Hd&&!Yd,Bs=I("DRAG_DROP_PASTE_FILE");class Rr extends ce{static getType(){return"quote"}static clone(e){return new Rr(e.__key)}createDOM(e){const t=document.createElement("blockquote");return _e(t,e.theme.quote),t}updateDOM(e,t){return!1}static importDOM(){return{blockquote:e=>({conversion:Xd,priority:0})}}exportDOM(e){const{element:t}=super.exportDOM(e);if(J(t)){this.isEmpty()&&t.append(document.createElement("br"));const r=this.getFormatType();r&&(t.style.textAlign=r);const i=this.getDirection();i&&(t.dir=i)}return{element:t}}static importJSON(e){return Ga().updateFromJSON(e)}insertNewAfter(e,t){const r=Q(),i=this.getDirection();return r.setDirection(i),this.insertAfter(r,t),r}collapseAtStart(){const e=Q();return this.getChildren().forEach(t=>e.append(t)),this.replace(e),!0}canMergeWhenEmpty(){return!0}}function Ga(){return ye(new Rr)}class zr extends ce{__tag;static getType(){return"heading"}static clone(e){return new zr(e.__tag,e.__key)}constructor(e,t){super(t),this.__tag=e}getTag(){return this.__tag}setTag(e){const t=this.getWritable();return this.__tag=e,t}createDOM(e){const t=this.__tag,r=document.createElement(t),i=e.theme.heading;if(i!==void 0){const o=i[t];_e(r,o)}return r}updateDOM(e,t,r){return e.__tag!==this.__tag}static importDOM(){return{h1:e=>({conversion:Lt,priority:0}),h2:e=>({conversion:Lt,priority:0}),h3:e=>({conversion:Lt,priority:0}),h4:e=>({conversion:Lt,priority:0}),h5:e=>({conversion:Lt,priority:0}),h6:e=>({conversion:Lt,priority:0}),p:e=>{const t=e.firstChild;return t!==null&&Ks(t)?{conversion:()=>({node:null}),priority:3}:null},span:e=>Ks(e)?{conversion:t=>({node:Wt("h1")}),priority:3}:null}}exportDOM(e){const{element:t}=super.exportDOM(e);if(J(t)){this.isEmpty()&&t.append(document.createElement("br"));const r=this.getFormatType();r&&(t.style.textAlign=r);const i=this.getDirection();i&&(t.dir=i)}return{element:t}}static importJSON(e){return Wt(e.tag).updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setTag(e.tag)}exportJSON(){return{...super.exportJSON(),tag:this.getTag()}}insertNewAfter(e,t=!0){const r=e?e.anchor.offset:0,i=this.getLastDescendant(),o=!i||e&&e.anchor.key===i.getKey()&&r===i.getTextContentSize()||!e?Q():Wt(this.getTag()),s=this.getDirection();if(o.setDirection(s),this.insertAfter(o,t),r===0&&!this.isEmpty()&&e){const l=Q();l.select(),this.replace(l,!0)}return o}collapseAtStart(){const e=this.isEmpty()?Q():Wt(this.getTag());return this.getChildren().forEach(t=>e.append(t)),this.replace(e),!0}extractWithChild(){return!0}}function Ks(n){return n.nodeName.toLowerCase()==="span"&&n.style.fontSize==="26pt"}function Lt(n){const e=n.nodeName.toLowerCase();let t=null;return e!=="h1"&&e!=="h2"&&e!=="h3"&&e!=="h4"&&e!=="h5"&&e!=="h6"||(t=Wt(e),n.style!==null&&(ao(n,t),t.setFormat(n.style.textAlign))),{node:t}}function Xd(n){const e=Ga();return n.style!==null&&(e.setFormat(n.style.textAlign),ao(n,e)),{node:e}}function Wt(n="h1"){return ye(new zr(n))}function nr(n){let e=null;if(lt(n,DragEvent)?e=n.dataTransfer:lt(n,ClipboardEvent)&&(e=n.clipboardData),e===null)return[!1,[],!1];const t=e.types,r=t.includes("Files"),i=t.includes("text/html")||t.includes("text/plain");return[r,Array.from(e.files),i]}function Us(n){const e=F();if(!A(e))return!1;const t=new Set,r=e.getNodes();for(let i=0;i<r.length;i++){const o=r[i],s=o.getKey();if(t.has(s))continue;const l=ht(o,c=>v(c)&&!c.isInline());if(l===null)continue;const a=l.getKey();l.canIndent()&&!t.has(a)&&(t.add(a),n(l))}return t.size>0}function Js(n){const e=tt(n);return W(e)}function ai(n){for(const e of["lowercase","uppercase","capitalize"])n.hasFormat(e)&&n.toggleFormat(e)}function Qd(n){return wt(n.registerCommand(bl,e=>{const t=F();return!!pe(t)&&(t.clear(),!0)},j),n.registerCommand(at,e=>{const t=F();return A(t)?(t.deleteCharacter(e),!0):!!pe(t)&&(t.deleteNodes(),!0)},j),n.registerCommand(En,e=>{const t=F();return!!A(t)&&(t.deleteWord(e),!0)},j),n.registerCommand(On,e=>{const t=F();return!!A(t)&&(t.deleteLine(e),!0)},j),n.registerCommand(Kt,e=>{const t=F();if(typeof e=="string")t!==null&&t.insertText(e);else{if(t===null)return!1;const r=e.dataTransfer;if(r!=null)$s(r,t,n);else if(A(t)){const i=e.data;return i&&t.insertText(i),!0}}return!0},j),n.registerCommand(Si,()=>{const e=F();return!!A(e)&&(e.removeText(),!0)},j),n.registerCommand(Be,e=>{const t=F();return!!A(t)&&(t.formatText(e),!0)},j),n.registerCommand(nu,e=>{const t=F();if(!A(t)&&!pe(t))return!1;const r=t.getNodes();for(const i of r){const o=ht(i,s=>v(s)&&!s.isInline());o!==null&&o.setFormat(e)}return!0},j),n.registerCommand(Bt,e=>{const t=F();return!!A(t)&&(t.insertLineBreak(e),!0)},j),n.registerCommand(mr,()=>{const e=F();return!!A(e)&&(e.insertParagraph(),!0)},j),n.registerCommand(eu,()=>(ku([Fn()]),!0),j),n.registerCommand(tu,()=>Us(e=>{const t=e.getIndent();e.setIndent(t+1)}),j),n.registerCommand(Ko,()=>Us(e=>{const t=e.getIndent();t>0&&e.setIndent(Math.max(0,t-1))}),j),n.registerCommand(Nl,e=>{const t=F();if(pe(t)){const r=t.getNodes();if(r.length>0)return e.preventDefault(),r[0].selectPrevious(),!0}else if(A(t)){const r=Mi(t.focus,!0);if(!e.shiftKey&&W(r)&&!r.isIsolated()&&!r.isInline())return r.selectPrevious(),e.preventDefault(),!0}return!1},j),n.registerCommand(Tl,e=>{const t=F();if(pe(t)){const r=t.getNodes();if(r.length>0)return e.preventDefault(),r[0].selectNext(0,0),!0}else if(A(t)){if((function(i){const o=i.focus;return o.key==="root"&&o.offset===V().getChildrenSize()})(t))return e.preventDefault(),!0;const r=Mi(t.focus,!1);if(!e.shiftKey&&W(r)&&!r.isIsolated()&&!r.isInline())return r.selectNext(),e.preventDefault(),!0}return!1},j),n.registerCommand(kl,e=>{const t=F();if(pe(t)){const r=t.getNodes();if(r.length>0)return e.preventDefault(),Ts(r[0])?r[0].selectNext(0,0):r[0].selectPrevious(),!0}if(!A(t))return!1;if(Es(t,!0)){const r=e.shiftKey;return e.preventDefault(),Os(t,r,!0),!0}return!1},j),n.registerCommand(wl,e=>{const t=F();if(pe(t)){const i=t.getNodes();if(i.length>0)return e.preventDefault(),Ts(i[0])?i[0].selectPrevious():i[0].selectNext(0,0),!0}if(!A(t))return!1;const r=e.shiftKey;return!!Es(t,!1)&&(e.preventDefault(),Os(t,r,!1),!0)},j),n.registerCommand(Ol,e=>{if(Js(e.target))return!1;const t=F();if(A(t)){if((function(r){if(!r.isCollapsed())return!1;const{anchor:i}=r;if(i.offset!==0)return!1;const o=i.getNode();if(G(o))return!1;const s=_d(o);return s.getIndent()>0&&(s.is(o)||o.is(s.getFirstDescendant()))})(t))return e.preventDefault(),n.dispatchCommand(Ko,void 0);if(Ws&&navigator.language==="ko-KR")return!1}else if(!pe(t))return!1;return e.preventDefault(),n.dispatchCommand(at,!0)},j),n.registerCommand(Ml,e=>{if(Js(e.target))return!1;const t=F();return!(!A(t)&&!pe(t))&&(e.preventDefault(),n.dispatchCommand(at,!1))},j),n.registerCommand(_r,e=>{const t=F();if(!A(t))return!1;if(ai(t),e!==null){if((Ws||qd||Gd)&&Vd)return!1;if(e.preventDefault(),e.shiftKey)return n.dispatchCommand(Bt,!1)}return n.dispatchCommand(mr,void 0)},j),n.registerCommand(Al,()=>{const e=F();return!!A(e)&&(n.blur(),!0)},j),n.registerCommand(Fl,e=>{const[,t]=nr(e);if(t.length>0){const i=js(e.clientX,e.clientY);if(i!==null){const{offset:o,node:s}=i,l=tt(s);if(l!==null){const a=Xl();if(M(l))a.anchor.set(l.getKey(),o,"text"),a.focus.set(l.getKey(),o,"text");else{const u=l.getParentOrThrow().getKey(),f=l.getIndexWithinParent()+1;a.anchor.set(u,f,"element"),a.focus.set(u,f,"element")}const c=dr(a);fe(c)}n.dispatchCommand(Bs,t)}return e.preventDefault(),!0}const r=F();return!!A(r)},j),n.registerCommand(Ll,e=>{const[t]=nr(e),r=F();return!(t&&!A(r))},j),n.registerCommand(Pl,e=>{const[t]=nr(e),r=F();if(t&&!A(r))return!1;const i=js(e.clientX,e.clientY);if(i!==null){const o=tt(i.node);W(o)&&e.preventDefault()}return!0},j),n.registerCommand(Ci,()=>(Iu(),!0),j),n.registerCommand(Or,e=>(Rs(n,lt(e,ClipboardEvent)?e:null),!0),j),n.registerCommand(Hi,e=>((async function(t,r){await Rs(r,lt(t,ClipboardEvent)?t:null),r.update(()=>{const i=F();A(i)?i.removeText():pe(i)&&i.getNodes().forEach(o=>o.remove())})})(e,n),!0),j),n.registerCommand(Ki,e=>{const[,t,r]=nr(e);return t.length>0&&!r?(n.dispatchCommand(Bs,t),!0):on(e.target)&&to(e.target)?!1:F()!==null&&((function(i,o){i.preventDefault(),o.update(()=>{const s=F(),l=lt(i,InputEvent)||lt(i,KeyboardEvent)?null:i.clipboardData;l!=null&&s!==null&&$s(l,s,o)},{tag:du})})(e,n),!0)},j),n.registerCommand(El,e=>{const t=F();return A(t)&&ai(t),!1},j),n.registerCommand(Dl,e=>{const t=F();return A(t)&&ai(t),!1},j))}function Zd(n,...e){const t=new URL("https://lexical.dev/docs/error"),r=new URLSearchParams;r.append("code",n);for(const i of e)r.append("v",i);throw t.search=r.toString(),Error(`Minified Lexical error #${n}; visit ${t.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}const So=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?P.useLayoutEffect:P.useEffect;function ef({editor:n,ErrorBoundary:e}){return(function(t,r){const[i,o]=P.useState(()=>t.getDecorators());return So(()=>t.registerDecoratorListener(s=>{Oo.flushSync(()=>{o(s)})}),[t]),P.useEffect(()=>{o(t.getDecorators())},[t]),P.useMemo(()=>{const s=[],l=Object.keys(i);for(let a=0;a<l.length;a++){const c=l[a],u=S.jsx(r,{onError:d=>t._onError(d),children:S.jsx(P.Suspense,{fallback:null,children:i[c]})}),f=t.getElementByKey(c);f!==null&&s.push(Oo.createPortal(u,f,c))}return s},[r,i,t])})(n,e)}function tf({editor:n,ErrorBoundary:e}){return(function(t){const r=Vt.maybeFromEditor(t);if(r&&r.hasExtensionByName(Fd.name)){for(const i of["@lexical/plain-text","@lexical/rich-text"])r.hasExtensionByName(i)&&Zd(320,i);return!0}return!1})(n)?null:S.jsx(ef,{editor:n,ErrorBoundary:e})}function Hs(n){return n.getEditorState().read(Ka(n.isComposing()))}function nf({contentEditable:n,placeholder:e=null,ErrorBoundary:t}){const[r]=Ve();return(function(i){So(()=>wt(Qd(i),Id(i)),[i])})(r),S.jsxs(S.Fragment,{children:[n,S.jsx(rf,{content:e}),S.jsx(tf,{editor:r,ErrorBoundary:t})]})}function rf({content:n}){const[e]=Ve(),t=(function(i){const[o,s]=P.useState(()=>Hs(i));return So(()=>{function l(){const a=Hs(i);s(a)}return l(),wt(i.registerUpdateListener(()=>{l()}),i.registerEditableListener(()=>{l()}))},[i]),o})(e),r=fd();return t?typeof n=="function"?n(r):n:null}const Xa=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?P.useLayoutEffect:P.useEffect;function of({editor:n,ariaActiveDescendant:e,ariaAutoComplete:t,ariaControls:r,ariaDescribedBy:i,ariaErrorMessage:o,ariaExpanded:s,ariaInvalid:l,ariaLabel:a,ariaLabelledBy:c,ariaMultiline:u,ariaOwns:f,ariaRequired:d,autoCapitalize:g,className:h,id:p,role:m="textbox",spellCheck:x=!0,style:y,tabIndex:C,"data-testid":k,...T},b){const[N,w]=P.useState(n.isEditable()),_=P.useCallback(L=>{L&&L.ownerDocument&&L.ownerDocument.defaultView?n.setRootElement(L):n.setRootElement(null)},[n]),O=P.useMemo(()=>(function(...L){return R=>{for(const $ of L)typeof $=="function"?$(R):$!=null&&($.current=R)}})(b,_),[_,b]);return Xa(()=>(w(n.isEditable()),n.registerEditableListener(L=>{w(L)})),[n]),S.jsx("div",{"aria-activedescendant":N?e:void 0,"aria-autocomplete":N?t:"none","aria-controls":N?r:void 0,"aria-describedby":i,...o!=null?{"aria-errormessage":o}:{},"aria-expanded":N&&m==="combobox"?!!s:void 0,...l!=null?{"aria-invalid":l}:{},"aria-label":a,"aria-labelledby":c,"aria-multiline":u,"aria-owns":N?f:void 0,"aria-readonly":!N||void 0,"aria-required":d,autoCapitalize:g,className:h,contentEditable:N,"data-testid":k,id:p,ref:O,role:m,spellCheck:x,style:y,tabIndex:C,...T})}const sf=P.forwardRef(of);function Vs(n){return n.getEditorState().read(Ka(n.isComposing()))}const lf=P.forwardRef(af);function af(n,e){const{placeholder:t,...r}=n,[i]=Ve();return S.jsxs(S.Fragment,{children:[S.jsx(sf,{editor:i,...r,ref:e}),t!=null&&S.jsx(cf,{editor:i,content:t})]})}function cf({content:n,editor:e}){const t=(function(s){const[l,a]=P.useState(()=>Vs(s));return Xa(()=>{function c(){const u=Vs(s);a(u)}return c(),wt(s.registerUpdateListener(()=>{c()}),s.registerEditableListener(()=>{c()}))},[s]),l})(e),[r,i]=P.useState(e.isEditable());if(P.useLayoutEffect(()=>(i(e.isEditable()),e.registerEditableListener(s=>{i(s)})),[e]),!t)return null;let o=null;return typeof n=="function"?o=n(r):n!==null&&(o=n),o===null?null:S.jsx("div",{"aria-hidden":!0,children:o})}function uf(n,e,t,r,i){if(n===null||t.size===0&&r.size===0&&!i)return 0;const o=e._selection,s=n._selection;if(i)return 1;if(!(A(o)&&A(s)&&s.isCollapsed()&&o.isCollapsed()))return 0;const l=(function(x,y,C){const k=x._nodeMap,T=[];for(const b of y){const N=k.get(b);N!==void 0&&T.push(N)}for(const[b,N]of C){if(!N)continue;const w=k.get(b);w===void 0||G(w)||T.push(w)}return T})(e,t,r);if(l.length===0)return 0;if(l.length>1){const x=e._nodeMap,y=x.get(o.anchor.key),C=x.get(s.anchor.key);return y&&C&&!n._nodeMap.has(y.__key)&&M(y)&&y.__text.length===1&&o.anchor.offset===1?2:0}const a=l[0],c=n._nodeMap.get(a.__key);if(!M(c)||!M(a)||c.__mode!==a.__mode)return 0;const u=c.__text,f=a.__text;if(u===f)return 0;const d=o.anchor,g=s.anchor;if(d.key!==g.key||d.type!=="text")return 0;const h=d.offset,p=g.offset,m=f.length-u.length;return m===1&&p===h-1?2:m===-1&&p===h+1?3:m===-1&&p===h?4:0}function df(n,e){let t=Date.now(),r=0;return(i,o,s,l,a,c)=>{const u=Date.now();if(c.has(Ti))return r=0,t=u,2;const f=uf(i,o,l,a,n.isComposing()),d=(()=>{const g=s===null||s.editor===n,h=c.has(uu);if(!h&&g&&c.has(ct))return 0;if(i===null)return 1;const p=o._selection;if(!(l.size>0||a.size>0))return p!==null?0:2;const m=typeof e=="number"?e:e.peek();return h===!1&&f!==0&&f===r&&u<t+m&&g||l.size===1&&(function(x,y,C){const k=y._nodeMap.get(x),T=C._nodeMap.get(x),b=y._selection,N=C._selection;return!(A(b)&&A(N)&&b.anchor.type==="element"&&b.focus.type==="element"&&N.anchor.type==="text"&&N.focus.type==="text"||!M(k)||!M(T)||k.__parent!==T.__parent)&&JSON.stringify(y.read(()=>k.exportJSON()))===JSON.stringify(C.read(()=>T.exportJSON()))})(Array.from(l)[0],i,o)?0:1})();return t=u,r=f,d}}function qs(n){n.undoStack=[],n.redoStack=[],n.current=null}function Qa(n,e,t){const r=df(n,t);return wt(n.registerCommand(Ui,()=>((function(o,s){const l=s.redoStack,a=s.undoStack;if(a.length!==0){const c=s.current,u=a.pop();c!==null&&(l.push(c),o.dispatchCommand(Hn,!0)),a.length===0&&o.dispatchCommand(Vn,!1),s.current=u||null,u&&u.editor.setEditorState(u.editorState,{tag:Ti})}})(n,e),!0),j),n.registerCommand(Ji,()=>((function(o,s){const l=s.redoStack,a=s.undoStack;if(l.length!==0){const c=s.current;c!==null&&(a.push(c),o.dispatchCommand(Vn,!0));const u=l.pop();l.length===0&&o.dispatchCommand(Hn,!1),s.current=u||null,u&&u.editor.setEditorState(u.editorState,{tag:Ti})}})(n,e),!0),j),n.registerCommand(iu,()=>(qs(e),!1),j),n.registerCommand(ou,()=>(qs(e),n.dispatchCommand(Hn,!1),n.dispatchCommand(Vn,!1),!0),j),n.registerUpdateListener(({editorState:o,prevEditorState:s,dirtyLeaves:l,dirtyElements:a,tags:c})=>{const u=e.current,f=e.redoStack,d=e.undoStack,g=u===null?null:u.editorState;if(u!==null&&o===g)return;const h=r(s,o,u,l,a,c);if(h===1)f.length!==0&&(e.redoStack=[],n.dispatchCommand(Hn,!1)),u!==null&&(d.push({...u}),n.dispatchCommand(Vn,!0));else if(h===2)return;e.current={editor:n,editorState:o}}))}function Za(){return{current:null,redoStack:[],undoStack:[]}}const ci={build:(n,{delay:e,createInitialHistoryState:t,disabled:r})=>wd({delay:e,disabled:r,historyState:t(n)}),config:{createInitialHistoryState:Za,delay:300,disabled:typeof window>"u"},name:"@lexical/history/History",register:(n,e,t)=>{const r=t.getOutput();return yo(()=>r.disabled.value?void 0:Qa(n,r.historyState.value,r.delay))}};od(ci,{createInitialHistoryState:()=>{throw new Error("SharedHistory did not inherit parent history")},disabled:!0});function ff({delay:n,externalHistoryState:e}){const[t]=Ve();return(function(r,i,o=1e3){const s=P.useMemo(()=>i||Za(),[i]);P.useEffect(()=>Qa(r,s,o),[o,r,s])})(t,e,n),null}const hf=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?P.useLayoutEffect:P.useEffect;function gf({ignoreHistoryMergeTagChange:n=!0,ignoreSelectionChange:e=!1,onChange:t}){const[r]=Ve();return hf(()=>{if(t)return r.registerUpdateListener(({editorState:i,dirtyElements:o,dirtyLeaves:s,prevEditorState:l,tags:a})=>{e&&o.size===0&&s.size===0||n&&a.has(ct)||l.isEmpty()||t(i,r,a)})},[r,n,e,t]),null}const pf=P.createContext(null),ui={didCatch:!1,error:null};class mf extends P.Component{constructor(e){super(e),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=ui}static getDerivedStateFromError(e){return{didCatch:!0,error:e}}resetErrorBoundary(){const{error:e}=this.state;if(e!==null){for(var t,r,i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];(t=(r=this.props).onReset)===null||t===void 0||t.call(r,{args:o,reason:"imperative-api"}),this.setState(ui)}}componentDidCatch(e,t){var r,i;(r=(i=this.props).onError)===null||r===void 0||r.call(i,e,t)}componentDidUpdate(e,t){const{didCatch:r}=this.state,{resetKeys:i}=this.props;if(r&&t.error!==null&&_f(e.resetKeys,i)){var o,s;(o=(s=this.props).onReset)===null||o===void 0||o.call(s,{next:i,prev:e.resetKeys,reason:"keys"}),this.setState(ui)}}render(){const{children:e,fallbackRender:t,FallbackComponent:r,fallback:i}=this.props,{didCatch:o,error:s}=this.state;let l=e;if(o){const a={error:s,resetErrorBoundary:this.resetErrorBoundary};if(typeof t=="function")l=t(a);else if(r)l=P.createElement(r,a);else if(i!==void 0)l=i;else throw s}return P.createElement(pf.Provider,{value:{didCatch:o,error:s,resetErrorBoundary:this.resetErrorBoundary}},l)}}function _f(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return n.length!==e.length||n.some((t,r)=>!Object.is(t,e[r]))}function yf({children:n,onError:e}){return S.jsx(mf,{fallback:S.jsx("div",{style:{border:"1px solid #f00",color:"#f00",padding:"8px"},children:"An error was thrown."}),onError:e,children:n})}function mn(n,...e){const t=new URL("https://lexical.dev/docs/error"),r=new URLSearchParams;r.append("code",n);for(const i of e)r.append("v",i);throw t.search=r.toString(),Error(`Minified Lexical error #${n}; visit ${t.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function xf(n){let e=1,t=n.getParent();for(;t!=null;){if(ue(t)){const r=t.getParent();if(Y(r)){e++,t=r.getParent();continue}mn(40)}return e}return e}function Te(n){return ue(n)&&Y(n.getFirstChild())}function Ys(n){return rt().append(n)}function ec(n,e){n.splice(n.getChildrenSize(),0,e)}function Co(n,e){const t=n.getLastChild(),r=e.getFirstChild();t&&r&&Te(t)&&Te(r)&&(Co(t.getFirstChild(),r.getFirstChild()),r.remove());const i=e.getChildren();i.length>0&&n.append(...i),e.remove()}function Sf(n){const e=n.getListType()!=="check";let t=n.getStart();for(const r of n.getChildren())ue(r)&&(r.getValue()!==t&&r.setValue(t),e&&r.getLatest().__checked!=null&&r.setChecked(void 0),Y(r.getFirstChild())||t++)}function Cf(n){const e=new Set;if(Te(n)||e.has(n.getKey()))return;const t=n.getParent(),r=n.getNextSibling(),i=n.getPreviousSibling();if(Te(r)&&Te(i)){const o=i.getFirstChild();if(Y(o)){o.append(n);const s=r.getFirstChild();Y(s)&&(ec(o,s.getChildren()),r.remove(),e.add(r.getKey()))}}else if(Te(r)){const o=r.getFirstChild();if(Y(o)){const s=o.getFirstChild();s!==null&&s.insertBefore(n)}}else if(Te(i)){const o=i.getFirstChild();Y(o)&&o.append(n)}else if(Y(t)){const o=rt().setTextFormat(n.getTextFormat()).setTextStyle(n.getTextStyle()),s=Ke(t.getListType()).setTextFormat(t.getTextFormat()).setTextStyle(t.getTextStyle());o.append(s),s.append(n),i?i.insertAfter(o):r?r.insertBefore(o):t.append(o)}}function vf(n){if(Te(n))return;const e=n.getParent(),t=e?e.getParent():void 0;if(Y(t?t.getParent():void 0)&&ue(t)&&Y(e)){const r=e?e.getFirstChild():void 0,i=e?e.getLastChild():void 0;if(n.is(r))t.insertBefore(n),e.isEmpty()&&t.remove();else if(n.is(i))t.insertAfter(n),e.isEmpty()&&t.remove();else{const o=e.getListType(),s=rt(),l=Ke(o);s.append(l),n.getPreviousSiblings().forEach(u=>l.append(u));const a=rt(),c=Ke(o);a.append(c),ec(c,n.getNextSiblings()),t.insertBefore(s),t.insertAfter(a),t.replace(n)}}}function Nr(...n){const e=[];for(const t of n)if(t&&typeof t=="string")for(const[r]of t.matchAll(/\S+/g))e.push(r);return e}class vo extends ce{__value;__checked;$config(){return this.config("listitem",{$transform:e=>{if(e.__checked==null)return;const t=e.getParent();Y(t)&&t.getListType()!=="check"&&e.getChecked()!=null&&e.setChecked(void 0)},extends:ce,importDOM:{li:()=>({conversion:bf,priority:0})}})}constructor(e=1,t=void 0,r){super(r),this.__value=e===void 0?1:e,this.__checked=t}afterCloneFrom(e){super.afterCloneFrom(e),this.__value=e.__value,this.__checked=e.__checked}createDOM(e){const t=document.createElement("li");return this.updateListItemDOM(null,t,e),t}updateListItemDOM(e,t,r){(function(s,l,a){const c=l.getParent();!Y(c)||c.getListType()!=="check"||Y(l.getFirstChild())?(s.removeAttribute("role"),s.removeAttribute("tabIndex"),s.removeAttribute("aria-checked")):(s.setAttribute("role","checkbox"),s.setAttribute("tabIndex","-1"),a&&l.__checked===a.__checked||s.setAttribute("aria-checked",l.getChecked()?"true":"false"))})(t,this,e),t.value=this.__value,(function(s,l,a){const c=[],u=[],f=l.list,d=f?f.listitem:void 0;let g;if(f&&f.nested&&(g=f.nested.listitem),d!==void 0&&c.push(...Nr(d)),f){const h=a.getParent(),p=Y(h)&&h.getListType()==="check",m=a.getChecked();p&&!m||u.push(f.listitemUnchecked),p&&m||u.push(f.listitemChecked),p&&c.push(m?f.listitemChecked:f.listitemUnchecked)}if(g!==void 0){const h=Nr(g);a.getChildren().some(p=>Y(p))?c.push(...h):u.push(...h)}u.length>0&&Ht(s,...u),c.length>0&&_e(s,...c)})(t,r.theme,this);const i=e?e.__style:"",o=this.__style;i!==o&&(o===""?t.removeAttribute("style"):t.style.cssText=o),(function(s,l,a){const c=Ns(l.__textStyle);for(const u in c)s.style.setProperty(`--listitem-marker-${u}`,c[u]);if(a)for(const u in Ns(a.__textStyle))u in c||s.style.removeProperty(`--listitem-marker-${u}`)})(t,this,e)}updateDOM(e,t,r){const i=t;return this.updateListItemDOM(e,i,r),!1}updateFromJSON(e){return super.updateFromJSON(e).setValue(e.value).setChecked(e.checked)}exportDOM(e){const t=this.createDOM(e._config),r=this.getFormatType();r&&(t.style.textAlign=r);const i=this.getDirection();return i&&(t.dir=i),{element:t}}exportJSON(){return{...super.exportJSON(),checked:this.getChecked(),value:this.getValue()}}append(...e){for(let t=0;t<e.length;t++){const r=e[t];if(v(r)&&this.canMergeWith(r)){const i=r.getChildren();this.append(...i),r.remove()}else super.append(r)}return this}replace(e,t){if(ue(e))return super.replace(e);this.setIndent(0);const r=this.getParentOrThrow();if(!Y(r))return e;if(r.__first===this.getKey())r.insertBefore(e);else if(r.__last===this.getKey())r.insertAfter(e);else{const i=Ke(r.getListType());let o=this.getNextSibling();for(;o;){const s=o;o=o.getNextSibling(),i.append(s)}r.insertAfter(e),e.insertAfter(i)}return t&&(v(e)||mn(139),this.getChildren().forEach(i=>{e.append(i)})),this.remove(),r.getChildrenSize()===0&&r.remove(),e}insertAfter(e,t=!0){const r=this.getParentOrThrow();if(Y(r)||mn(39),ue(e))return super.insertAfter(e,t);const i=this.getNextSiblings();if(r.insertAfter(e,t),i.length!==0){const o=Ke(r.getListType());i.forEach(s=>o.append(s)),e.insertAfter(o,t)}return e}remove(e){const t=this.getPreviousSibling(),r=this.getNextSibling();super.remove(e),t&&r&&Te(t)&&Te(r)&&(Co(t.getFirstChild(),r.getFirstChild()),r.remove())}insertNewAfter(e,t=!0){const r=rt().updateFromJSON(this.exportJSON()).setChecked(!this.getChecked()&&void 0);return this.insertAfter(r,t),r}collapseAtStart(e){const t=Q();this.getChildren().forEach(s=>t.append(s));const r=this.getParentOrThrow(),i=r.getParentOrThrow(),o=ue(i);if(r.getChildrenSize()===1)if(o)r.remove(),i.select();else{r.insertBefore(t),r.remove();const s=e.anchor,l=e.focus,a=t.getKey();s.type==="element"&&s.getNode().is(this)&&s.set(a,s.offset,"element"),l.type==="element"&&l.getNode().is(this)&&l.set(a,l.offset,"element")}else r.insertBefore(t),this.remove();return!0}getValue(){return this.getLatest().__value}setValue(e){const t=this.getWritable();return t.__value=e,t}getChecked(){const e=this.getLatest();let t;const r=this.getParent();return Y(r)&&(t=r.getListType()),t==="check"?!!e.__checked:void 0}setChecked(e){const t=this.getWritable();return t.__checked=e,t}toggleChecked(){const e=this.getWritable();return e.setChecked(!e.__checked)}getIndent(){const e=this.getParent();if(e===null||!this.isAttached())return this.getLatest().__indent;let t=e.getParentOrThrow(),r=0;for(;ue(t);)t=t.getParentOrThrow().getParentOrThrow(),r++;return r}setIndent(e){typeof e!="number"&&mn(117),(e=Math.floor(e))>=0||mn(199);let t=this.getIndent();for(;t!==e;)t<e?(Cf(this),t++):(vf(this),t--);return this}canInsertAfter(e){return ue(e)}canReplaceWith(e){return ue(e)}canMergeWith(e){return ue(e)||Qi(e)}extractWithChild(e,t){if(!A(t))return!1;const r=t.anchor.getNode(),i=t.focus.getNode();return this.isParentOf(r)&&this.isParentOf(i)&&this.getTextContent().length===t.getTextContent().length}isParentRequired(){return!0}createParentElementNode(){return Ke("bullet")}canMergeWhenEmpty(){return!0}}function bf(n){if(n.classList.contains("task-list-item")){for(const t of n.children)if(t.tagName==="INPUT")return Gs(t)}if(n.classList.contains("joplin-checkbox")){for(const t of n.children)if(t.classList.contains("checkbox-wrapper")&&t.children.length>0&&t.children[0].tagName==="INPUT")return Gs(t.children[0])}const e=n.getAttribute("aria-checked");return{node:rt(e==="true"||e!=="false"&&void 0)}}function Gs(n){return n.getAttribute("type")!=="checkbox"?{node:null}:{node:rt(n.hasAttribute("checked"))}}function rt(n){return ye(new vo(void 0,n))}function ue(n){return n instanceof vo}class bo extends ce{__tag;__start;__listType;$config(){return this.config("list",{$transform:e=>{(function(t){const r=t.getNextSibling();Y(r)&&t.getListType()===r.getListType()&&Co(t,r)})(e),Sf(e)},extends:ce,importDOM:{ol:()=>({conversion:Qs,priority:0}),ul:()=>({conversion:Qs,priority:0})}})}constructor(e="number",t=1,r){super(r);const i=kf[e]||e;this.__listType=i,this.__tag=i==="number"?"ol":"ul",this.__start=t}afterCloneFrom(e){super.afterCloneFrom(e),this.__listType=e.__listType,this.__tag=e.__tag,this.__start=e.__start}getTag(){return this.getLatest().__tag}setListType(e){const t=this.getWritable();return t.__listType=e,t.__tag=e==="number"?"ol":"ul",t}getListType(){return this.getLatest().__listType}getStart(){return this.getLatest().__start}setStart(e){const t=this.getWritable();return t.__start=e,t}createDOM(e,t){const r=this.__tag,i=document.createElement(r);return this.__start!==1&&i.setAttribute("start",String(this.__start)),i.__lexicalListType=this.__listType,Xs(i,e.theme,this),i}updateDOM(e,t,r){return e.__tag!==this.__tag||e.__listType!==this.__listType||(Xs(t,r.theme,this),!1)}updateFromJSON(e){return super.updateFromJSON(e).setListType(e.listType).setStart(e.start)}exportDOM(e){const t=this.createDOM(e._config,e);return J(t)&&(this.__start!==1&&t.setAttribute("start",String(this.__start)),this.__listType==="check"&&t.setAttribute("__lexicalListType","check")),{element:t}}exportJSON(){return{...super.exportJSON(),listType:this.getListType(),start:this.getStart(),tag:this.getTag()}}canBeEmpty(){return!1}canIndent(){return!1}splice(e,t,r){let i=r;for(let o=0;o<r.length;o++){const s=r[o];ue(s)||(i===r&&(i=[...r]),i[o]=rt().append(!v(s)||Y(s)||s.isInline()?s:Z(s.getTextContent())))}return super.splice(e,t,i)}extractWithChild(e){return ue(e)}}function Xs(n,e,t){const r=[],i=[],o=e.list;if(o!==void 0){const s=o[`${t.__tag}Depth`]||[],l=xf(t)-1,a=l%s.length,c=s[a],u=o[t.__tag];let f;const d=o.nested,g=o.checklist;if(d!==void 0&&d.list&&(f=d.list),u!==void 0&&r.push(u),g!==void 0&&t.__listType==="check"&&r.push(g),c!==void 0){r.push(...Nr(c));for(let h=0;h<s.length;h++)h!==a&&i.push(t.__tag+h)}if(f!==void 0){const h=Nr(f);l>1?r.push(...h):i.push(...h)}}i.length>0&&Ht(n,...i),r.length>0&&_e(n,...r)}function wf(n){const e=[];for(let t=0;t<n.length;t++){const r=n[t];if(ue(r)){e.push(r);const i=r.getChildren();i.length>1&&i.forEach(o=>{Y(o)&&e.push(Ys(o))})}else e.push(Ys(r))}return e}function Qs(n){const e=n.nodeName.toLowerCase();let t=null;return e==="ol"?t=Ke("number",n.start):e==="ul"&&(t=(function(r){if(r.getAttribute("__lexicallisttype")==="check"||r.classList.contains("contains-task-list")||r.getAttribute("data-is-checklist")==="1")return!0;for(const i of r.childNodes)if(J(i)&&i.hasAttribute("aria-checked"))return!0;return!1})(n)?Ke("check"):Ke("bullet")),{after:wf,node:t}}const kf={ol:"number",ul:"bullet"};function Ke(n="number",e=1){return ye(new bo(n,e))}function Y(n){return n instanceof bo}const Nf=I("INSERT_UNORDERED_LIST_COMMAND"),Tf=I("INSERT_ORDERED_LIST_COMMAND"),Ef=new Set(["http:","https:","mailto:","sms:","tel:"]);class Rn extends ce{__url;__target;__rel;__title;static getType(){return"link"}static clone(e){return new Rn(e.__url,{rel:e.__rel,target:e.__target,title:e.__title},e.__key)}constructor(e="",t={},r){super(r);const{target:i=null,rel:o=null,title:s=null}=t;this.__url=e,this.__target=i,this.__rel=o,this.__title=s}createDOM(e){const t=document.createElement("a");return this.updateLinkDOM(null,t,e),_e(t,e.theme.link),t}updateLinkDOM(e,t,r){if(xa(t)){e&&e.__url===this.__url||(t.href=this.sanitizeUrl(this.__url));for(const i of["target","rel","title"]){const o=`__${i}`,s=this[o];e&&e[o]===s||(s?t[i]=s:t.removeAttribute(i))}}}updateDOM(e,t,r){return this.updateLinkDOM(e,t,r),!1}static importDOM(){return{a:e=>({conversion:Of,priority:1})}}static importJSON(e){return zi().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setURL(e.url).setRel(e.rel||null).setTarget(e.target||null).setTitle(e.title||null)}sanitizeUrl(e){e=el(e);try{const t=new URL(el(e));if(!Ef.has(t.protocol))return"about:blank"}catch{return e}return e}exportJSON(){return{...super.exportJSON(),rel:this.getRel(),target:this.getTarget(),title:this.getTitle(),url:this.getURL()}}getURL(){return this.getLatest().__url}setURL(e){const t=this.getWritable();return t.__url=e,t}getTarget(){return this.getLatest().__target}setTarget(e){const t=this.getWritable();return t.__target=e,t}getRel(){return this.getLatest().__rel}setRel(e){const t=this.getWritable();return t.__rel=e,t}getTitle(){return this.getLatest().__title}setTitle(e){const t=this.getWritable();return t.__title=e,t}insertNewAfter(e,t=!0){const r=zi(this.__url,{rel:this.__rel,target:this.__target,title:this.__title});return this.insertAfter(r,t),r}canInsertTextBefore(){return!1}canInsertTextAfter(){return!1}canBeEmpty(){return!1}isInline(){return!0}extractWithChild(e,t,r){if(!A(t))return!1;const i=t.anchor.getNode(),o=t.focus.getNode();return this.isParentOf(i)&&this.isParentOf(o)&&t.getTextContent().length>0}isEmailURI(){return this.__url.startsWith("mailto:")}isWebSiteURI(){return this.__url.startsWith("https://")||this.__url.startsWith("http://")}}function Of(n){let e=null;if(xa(n)){const t=n.textContent;(t!==null&&t!==""||n.children.length>0)&&(e=zi(n.getAttribute("href")||"",{rel:n.getAttribute("rel"),target:n.getAttribute("target"),title:n.getAttribute("title")}))}return{node:e}}function zi(n="",e){return ye(new Rn(n,e))}class jr extends Rn{__isUnlinked;constructor(e="",t={},r){super(e,t,r),this.__isUnlinked=t.isUnlinked!==void 0&&t.isUnlinked!==null&&t.isUnlinked}static getType(){return"autolink"}static clone(e){return new jr(e.__url,{isUnlinked:e.__isUnlinked,rel:e.__rel,target:e.__target,title:e.__title},e.__key)}getIsUnlinked(){return this.__isUnlinked}setIsUnlinked(e){const t=this.getWritable();return t.__isUnlinked=e,t}createDOM(e){return this.__isUnlinked?document.createElement("span"):super.createDOM(e)}updateDOM(e,t,r){return super.updateDOM(e,t,r)||e.__isUnlinked!==this.__isUnlinked}static importJSON(e){return Zs().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setIsUnlinked(e.isUnlinked||!1)}static importDOM(){return null}exportJSON(){return{...super.exportJSON(),isUnlinked:this.__isUnlinked}}insertNewAfter(e,t=!0){const r=this.getParentOrThrow().insertNewAfter(e,t);if(v(r)){const i=Zs(this.__url,{isUnlinked:this.__isUnlinked,rel:this.__rel,target:this.__target,title:this.__title});return r.append(i),i}return null}}function Zs(n="",e){return ye(new jr(n,e))}const Af=/^\+?[0-9\s()-]{5,}$/;function el(n){return n.match(/^[a-z][a-z0-9+.-]*:/i)||n.match(/^[/#.]/)?n:n.includes("@")?`mailto:${n}`:Af.test(n)?`tel:${n}`:`https://${n}`}const wo=/^(\d+(?:\.\d+)?)px$/,qt={BOTH:3,NO_STATUS:0,ROW:1};class zn extends ce{__colSpan;__rowSpan;__headerState;__width;__backgroundColor;__verticalAlign;static getType(){return"tablecell"}static clone(e){return new zn(e.__headerState,e.__colSpan,e.__width,e.__key)}afterCloneFrom(e){super.afterCloneFrom(e),this.__rowSpan=e.__rowSpan,this.__backgroundColor=e.__backgroundColor,this.__verticalAlign=e.__verticalAlign}static importDOM(){return{td:e=>({conversion:tl,priority:0}),th:e=>({conversion:tl,priority:0})}}static importJSON(e){return tc().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setHeaderStyles(e.headerState).setColSpan(e.colSpan||1).setRowSpan(e.rowSpan||1).setWidth(e.width||void 0).setBackgroundColor(e.backgroundColor||null).setVerticalAlign(e.verticalAlign||void 0)}constructor(e=qt.NO_STATUS,t=1,r,i){super(i),this.__colSpan=t,this.__rowSpan=1,this.__headerState=e,this.__width=r,this.__backgroundColor=null,this.__verticalAlign=void 0}createDOM(e){const t=document.createElement(this.getTag());return this.__width&&(t.style.width=`${this.__width}px`),this.__colSpan>1&&(t.colSpan=this.__colSpan),this.__rowSpan>1&&(t.rowSpan=this.__rowSpan),this.__backgroundColor!==null&&(t.style.backgroundColor=this.__backgroundColor),ji(this.__verticalAlign)&&(t.style.verticalAlign=this.__verticalAlign),_e(t,e.theme.tableCell,this.hasHeader()&&e.theme.tableCellHeader),t}exportDOM(e){const t=super.exportDOM(e);if(J(t.element)){const r=t.element;r.setAttribute("data-temporary-table-cell-lexical-key",this.getKey()),r.style.border="1px solid black",this.__colSpan>1&&(r.colSpan=this.__colSpan),this.__rowSpan>1&&(r.rowSpan=this.__rowSpan),r.style.width=`${this.getWidth()||75}px`,r.style.verticalAlign=this.getVerticalAlign()||"top",r.style.textAlign="start",this.__backgroundColor===null&&this.hasHeader()&&(r.style.backgroundColor="#f2f3f5")}return t}exportJSON(){return{...super.exportJSON(),...ji(this.__verticalAlign)&&{verticalAlign:this.__verticalAlign},backgroundColor:this.getBackgroundColor(),colSpan:this.__colSpan,headerState:this.__headerState,rowSpan:this.__rowSpan,width:this.getWidth()}}getColSpan(){return this.getLatest().__colSpan}setColSpan(e){const t=this.getWritable();return t.__colSpan=e,t}getRowSpan(){return this.getLatest().__rowSpan}setRowSpan(e){const t=this.getWritable();return t.__rowSpan=e,t}getTag(){return this.hasHeader()?"th":"td"}setHeaderStyles(e,t=qt.BOTH){const r=this.getWritable();return r.__headerState=e&t|r.__headerState&~t,r}getHeaderStyles(){return this.getLatest().__headerState}setWidth(e){const t=this.getWritable();return t.__width=e,t}getWidth(){return this.getLatest().__width}getBackgroundColor(){return this.getLatest().__backgroundColor}setBackgroundColor(e){const t=this.getWritable();return t.__backgroundColor=e,t}getVerticalAlign(){return this.getLatest().__verticalAlign}setVerticalAlign(e){const t=this.getWritable();return t.__verticalAlign=e||void 0,t}toggleHeaderStyle(e){const t=this.getWritable();return(t.__headerState&e)===e?t.__headerState-=e:t.__headerState+=e,t}hasHeaderState(e){return(this.getHeaderStyles()&e)===e}hasHeader(){return this.getLatest().__headerState!==qt.NO_STATUS}updateDOM(e){return e.__headerState!==this.__headerState||e.__width!==this.__width||e.__colSpan!==this.__colSpan||e.__rowSpan!==this.__rowSpan||e.__backgroundColor!==this.__backgroundColor||e.__verticalAlign!==this.__verticalAlign}isShadowRoot(){return!0}collapseAtStart(){return!0}canBeEmpty(){return!1}canIndent(){return!1}}function ji(n){return n==="middle"||n==="bottom"}function tl(n){const e=n,t=n.nodeName.toLowerCase();let r;wo.test(e.style.width)&&(r=parseFloat(e.style.width));const i=tc(t==="th"?qt.ROW:qt.NO_STATUS,e.colSpan,r);i.__rowSpan=e.rowSpan;const o=e.style.backgroundColor;o!==""&&(i.__backgroundColor=o);const s=e.style.verticalAlign;ji(s)&&(i.__verticalAlign=s);const l=e.style,a=(l&&l.textDecoration||"").split(" "),c=l.fontWeight==="700"||l.fontWeight==="bold",u=a.includes("line-through"),f=l.fontStyle==="italic",d=a.includes("underline");return{after:g=>{const h=[];let p=null;const m=()=>{if(p){const x=p.getFirstChild();ut(x)&&p.getChildrenSize()===1&&x.remove()}};for(const x of g)ju(x)||M(x)||ut(x)?(M(x)&&(c&&x.toggleFormat("bold"),u&&x.toggleFormat("strikethrough"),f&&x.toggleFormat("italic"),d&&x.toggleFormat("underline")),p?p.append(x):(p=Q().append(x),h.push(p))):(h.push(x),m(),p=null);return m(),h.length===0&&h.push(Q()),h},node:i}}function tc(n=qt.NO_STATUS,e=1,t){return ye(new zn(n,e,t))}function Dn(n){return n instanceof zn}function Wi(n,...e){const t=new URL("https://lexical.dev/docs/error"),r=new URLSearchParams;r.append("code",n);for(const i of e)r.append("v",i);throw t.search=r.toString(),Error(`Minified Lexical error #${n}; visit ${t.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}class jn extends ce{__height;static getType(){return"tablerow"}static clone(e){return new jn(e.__height,e.__key)}static importDOM(){return{tr:e=>({conversion:Mf,priority:0})}}static importJSON(e){return nc().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setHeight(e.height)}constructor(e,t){super(t),this.__height=e}exportJSON(){const e=this.getHeight();return{...super.exportJSON(),...e===void 0?void 0:{height:e}}}createDOM(e){const t=document.createElement("tr");return this.__height&&(t.style.height=`${this.__height}px`),_e(t,e.theme.tableRow),t}extractWithChild(e,t,r){return r==="html"}isShadowRoot(){return!0}setHeight(e){const t=this.getWritable();return t.__height=e,t}getHeight(){return this.getLatest().__height}updateDOM(e){return e.__height!==this.__height}canBeEmpty(){return!1}canIndent(){return!1}}function Mf(n){const e=n;let t;return wo.test(e.style.height)&&(t=parseFloat(e.style.height)),{after:r=>$a(r,Dn),node:nc(t)}}function nc(n){return ye(new jn(n))}function rc(n){return n instanceof jn}const ic=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,Df=ic&&"documentMode"in document?document.documentMode:null;ic&&"InputEvent"in window&&!Df&&new window.InputEvent("input");function Ff(n,e,t){const r=[];let i=null,o=null;function s(a){let c=r[a];return c===void 0&&(r[a]=c=[]),c}const l=n.getChildren();for(let a=0;a<l.length;a++){const c=l[a];rc(c)||Wi(209);const u=s(a);for(let f=c.getFirstChild(),d=0;f!=null;f=f.getNextSibling()){for(Dn(f)||Wi(147);u[d]!==void 0;)d++;const g={cell:f,startColumn:d,startRow:a},{__rowSpan:h,__colSpan:p}=f;for(let m=0;m<h&&!(a+m>=l.length);m++){const x=s(a+m);for(let y=0;y<p;y++)x[d+y]=g}}}return[r,i,o]}function fn(n){return J(n)&&n.nodeName==="TABLE"}function Lf(n,e){for(let t=e,r=null;t!==null;t=t.getParent()){if(n.is(t))return r;Dn(t)&&(r=t)}return null}function Pf(n,e,t){return Lf(n,tt(e,t))}function nl(n,e,t){if(!e.theme.tableAlignment)return;const r=[],i=[];for(const o of["center","right"]){const s=e.theme.tableAlignment[o];s&&(o===t?i:r).push(s)}Ht(n,...r),_e(n,...i)}const $f=new WeakSet;function rl(n=Pr()){return $f.has(n)}class Wr extends ce{__rowStriping;__frozenColumnCount;__frozenRowCount;__colWidths;static getType(){return"table"}getColWidths(){return this.getLatest().__colWidths}setColWidths(e){const t=this.getWritable();return t.__colWidths=e,t}static clone(e){return new Wr(e.__key)}afterCloneFrom(e){super.afterCloneFrom(e),this.__colWidths=e.__colWidths,this.__rowStriping=e.__rowStriping,this.__frozenColumnCount=e.__frozenColumnCount,this.__frozenRowCount=e.__frozenRowCount}static importDOM(){return{table:e=>({conversion:If,priority:1})}}static importJSON(e){return oc().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setRowStriping(e.rowStriping||!1).setFrozenColumns(e.frozenColumnCount||0).setFrozenRows(e.frozenRowCount||0).setColWidths(e.colWidths)}constructor(e){super(e),this.__rowStriping=!1,this.__frozenColumnCount=0,this.__frozenRowCount=0,this.__colWidths=void 0}exportJSON(){return{...super.exportJSON(),colWidths:this.getColWidths(),frozenColumnCount:this.__frozenColumnCount?this.__frozenColumnCount:void 0,frozenRowCount:this.__frozenRowCount?this.__frozenRowCount:void 0,rowStriping:this.__rowStriping?this.__rowStriping:void 0}}extractWithChild(e,t,r){return r==="html"}getDOMSlot(e){const t=fn(e)?e:e.querySelector("table");return fn(t)||Wi(229),super.getDOMSlot(e).withElement(t).withAfter(t.querySelector("colgroup"))}createDOM(e,t){const r=document.createElement("table");this.__style&&(r.style.cssText=this.__style);const i=document.createElement("colgroup");if(r.appendChild(i),Hu(i),_e(r,e.theme.table),this.updateTableElement(null,r,e),rl(t)){const o=document.createElement("div"),s=e.theme.tableScrollableWrapper;return s?_e(o,s):o.style.cssText="overflow-x: auto;",o.appendChild(r),this.updateTableWrapper(null,o,r,e),o}return r}updateTableWrapper(e,t,r,i){this.__frozenColumnCount!==(e?e.__frozenColumnCount:0)&&(function(o,s,l,a){a>0?(_e(o,l.theme.tableFrozenColumn),s.setAttribute("data-lexical-frozen-column","true")):(Ht(o,l.theme.tableFrozenColumn),s.removeAttribute("data-lexical-frozen-column"))})(t,r,i,this.__frozenColumnCount),this.__frozenRowCount!==(e?e.__frozenRowCount:0)&&(function(o,s,l,a){a>0?(_e(o,l.theme.tableFrozenRow),s.setAttribute("data-lexical-frozen-row","true")):(Ht(o,l.theme.tableFrozenRow),s.removeAttribute("data-lexical-frozen-row"))})(t,r,i,this.__frozenRowCount)}updateTableElement(e,t,r){this.__style!==(e?e.__style:"")&&(t.style.cssText=this.__style),this.__rowStriping!==(!!e&&e.__rowStriping)&&(function(i,o,s){s?(_e(i,o.theme.tableRowStriping),i.setAttribute("data-lexical-row-striping","true")):(Ht(i,o.theme.tableRowStriping),i.removeAttribute("data-lexical-row-striping"))})(t,r,this.__rowStriping),(function(i,o,s,l){const a=i.querySelector("colgroup");if(!a)return;const c=[];for(let u=0;u<s;u++){const f=document.createElement("col"),d=l&&l[u];d&&(f.style.width=`${d}px`),c.push(f)}a.replaceChildren(...c)})(t,0,this.getColumnCount(),this.getColWidths()),nl(t,r,this.getFormatType())}updateDOM(e,t,r){const i=this.getDOMSlot(t).element;return t===i===rl()||(J(o=t)&&o.nodeName==="DIV"&&this.updateTableWrapper(e,t,i,r),this.updateTableElement(e,i,r),!1);var o}exportDOM(e){const t=super.exportDOM(e),{element:r}=t;return{after:i=>{if(t.after&&(i=t.after(i)),!fn(i)&&J(i)&&(i=i.querySelector("table")),!fn(i))return null;nl(i,e._config,this.getFormatType());const[o]=Ff(this),s=new Map;for(const u of o)for(const f of u){const d=f.cell.getKey();s.has(d)||s.set(d,{colSpan:f.cell.getColSpan(),startColumn:f.startColumn})}const l=new Set;for(const u of i.querySelectorAll(":scope > tr > [data-temporary-table-cell-lexical-key]")){const f=u.getAttribute("data-temporary-table-cell-lexical-key");if(f){const d=s.get(f);if(u.removeAttribute("data-temporary-table-cell-lexical-key"),d){s.delete(f);for(let g=0;g<d.colSpan;g++)l.add(g+d.startColumn)}}}const a=i.querySelector(":scope > colgroup");if(a){const u=Array.from(i.querySelectorAll(":scope > colgroup > col")).filter((f,d)=>l.has(d));a.replaceChildren(...u)}const c=i.querySelectorAll(":scope > tr");if(c.length>0){const u=document.createElement("tbody");for(const f of c)u.appendChild(f);i.append(u)}return i},element:!fn(r)&&J(r)?r.querySelector("table"):r}}canBeEmpty(){return!1}isShadowRoot(){return!0}getCordsFromCellNode(e,t){const{rows:r,domRows:i}=t;for(let o=0;o<r;o++){const s=i[o];if(s!=null)for(let l=0;l<s.length;l++){const a=s[l];if(a==null)continue;const{elem:c}=a,u=Pf(this,c);if(u!==null&&e.is(u))return{x:l,y:o}}}throw new Error("Cell not found in table.")}getDOMCellFromCords(e,t,r){const{domRows:i}=r,o=i[t];if(o==null)return null;const s=o[e<o.length?e:o.length-1];return s??null}getDOMCellFromCordsOrThrow(e,t,r){const i=this.getDOMCellFromCords(e,t,r);if(!i)throw new Error("Cell not found at cords.");return i}getCellNodeFromCords(e,t,r){const i=this.getDOMCellFromCords(e,t,r);if(i==null)return null;const o=tt(i.elem);return Dn(o)?o:null}getCellNodeFromCordsOrThrow(e,t,r){const i=this.getCellNodeFromCords(e,t,r);if(!i)throw new Error("Node at cords not TableCellNode.");return i}getRowStriping(){return!!this.getLatest().__rowStriping}setRowStriping(e){const t=this.getWritable();return t.__rowStriping=e,t}setFrozenColumns(e){const t=this.getWritable();return t.__frozenColumnCount=e,t}getFrozenColumns(){return this.getLatest().__frozenColumnCount}setFrozenRows(e){const t=this.getWritable();return t.__frozenRowCount=e,t}getFrozenRows(){return this.getLatest().__frozenRowCount}canSelectBefore(){return!0}canIndent(){return!1}getColumnCount(){const e=this.getFirstChild();if(!e)return 0;let t=0;return e.getChildren().forEach(r=>{Dn(r)&&(t+=r.getColSpan())}),t}}function If(n){const e=oc();n.hasAttribute("data-lexical-row-striping")&&e.setRowStriping(!0),n.hasAttribute("data-lexical-frozen-column")&&e.setFrozenColumns(1),n.hasAttribute("data-lexical-frozen-row")&&e.setFrozenRows(1);const t=n.querySelector(":scope > colgroup");if(t){let r=[];for(const i of t.querySelectorAll(":scope > col")){let o=i.style.width||"";if(!wo.test(o)&&(o=i.getAttribute("width")||"",!/^\d+$/.test(o))){r=void 0;break}r.push(parseFloat(o))}r&&e.setColWidths(r)}return{after:r=>$a(r,rc),node:e}}function oc(){return ye(new Wr)}function Rf({onChange:n,lastEditorContentRef:e}){const[t]=Ve();return S.jsx(gf,{onChange:r=>{r.read(()=>{const i=Ua(t,null);e.current=i,n(i)})}})}function zf({content:n,lastEditorContentRef:e}){const[t]=Ve(),r=We.useRef(!1);return We.useEffect(()=>{const i=n===e.current;r.current&&i||(t.update(()=>{const o=V();if(o.setDirection("ltr"),o.clear(),n){const l=new DOMParser().parseFromString(n,"text/html");vn(t,l).forEach(c=>{c.__type!=="text"&&o.append(c)})}}),r.current=!0,e.current=n)},[t,n,e]),null}function jf(){const[n]=Ve(),[e,t]=We.useState(!1),r=We.useRef(null),i=d=>{n.dispatchCommand(Be,d)},o=d=>{n.update(()=>{const g=F();A(g)&&g.getNodes().forEach(h=>{const p=Wt(d);h.replace(p)})})},s=d=>{d==="bullet"?n.dispatchCommand(Nf,void 0):n.dispatchCommand(Tf,void 0)},l=()=>{const d=prompt("Enter URL:");d&&n.update(()=>{const g=F();if(A(g)){const h=g.getTextContent()||d;g.insertText("");const p=`<a href="${d}" target="_blank">${h}</a>`,x=new DOMParser().parseFromString(p,"text/html"),y=vn(n,x);g.insertNodes(y)}})},a=d=>{n.update(()=>{const g=F();if(A(g)){const h=`<p><img src="${d}" alt="Image" style="max-width: 100%; height: auto;" /></p>`,m=new DOMParser().parseFromString(h,"text/html"),x=vn(n,m),y=V();x.length>0&&y.append(x[0])}})},c=()=>{const d=prompt("Enter image URL:");d&&a(d),t(!1)},u=()=>{r.current?.click(),t(!1)},f=d=>{const g=d.target.files?.[0];if(g?.type.startsWith("image/")){const h=new FileReader;h.onload=p=>{const m=p.target?.result;a(m)},h.readAsDataURL(g)}};return We.useEffect(()=>{const d=()=>{t(!1)};if(e)return document.addEventListener("click",d),()=>{document.removeEventListener("click",d)}},[e]),S.jsxs("div",{className:"toolbar",children:[S.jsxs("div",{className:"toolbar-group",children:[S.jsx("button",{onClick:()=>{i("bold")},className:"toolbar-btn",title:"Bold",children:S.jsx("strong",{children:"B"})}),S.jsx("button",{onClick:()=>{i("italic")},className:"toolbar-btn",title:"Italic",children:S.jsx("em",{children:"I"})}),S.jsx("button",{onClick:()=>{i("underline")},className:"toolbar-btn",title:"Underline",children:S.jsx("u",{children:"U"})})]}),S.jsxs("div",{className:"toolbar-group",children:[S.jsx("button",{onClick:()=>{o("h1")},className:"toolbar-btn",title:"Heading 1",children:"H1"}),S.jsx("button",{onClick:()=>{o("h2")},className:"toolbar-btn",title:"Heading 2",children:"H2"}),S.jsx("button",{onClick:()=>{o("h3")},className:"toolbar-btn",title:"Heading 3",children:"H3"})]}),S.jsxs("div",{className:"toolbar-group",children:[S.jsx("button",{onClick:()=>{s("bullet")},className:"toolbar-btn",title:"Bullet List",children:"• List"}),S.jsx("button",{onClick:()=>{s("number")},className:"toolbar-btn",title:"Numbered List",children:"1. List"})]}),S.jsxs("div",{className:"toolbar-group",children:[S.jsx("button",{onClick:l,className:"toolbar-btn",title:"Insert Link",children:"🔗 Link"}),S.jsxs("div",{className:"image-dropdown",style:{position:"relative",display:"inline-block"},children:[S.jsx("button",{onClick:d=>{d.stopPropagation(),t(!e)},className:"toolbar-btn",title:"Insert Image",children:"🖼️ Image ▼"}),e&&S.jsxs("div",{onClick:d=>{d.stopPropagation()},style:{position:"absolute",top:"100%",left:0,backgroundColor:"white",border:"1px solid #ccc",borderRadius:"4px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",zIndex:1e3,minWidth:"150px"},children:[S.jsx("button",{onClick:c,style:{display:"block",width:"100%",padding:"8px 12px",border:"none",background:"none",textAlign:"left",cursor:"pointer"},onMouseEnter:d=>d.currentTarget.style.backgroundColor="#f5f5f5",onMouseLeave:d=>d.currentTarget.style.backgroundColor="transparent",children:"From URL"}),S.jsx("button",{onClick:u,style:{display:"block",width:"100%",padding:"8px 12px",border:"none",background:"none",textAlign:"left",cursor:"pointer"},onMouseEnter:d=>d.currentTarget.style.backgroundColor="#f5f5f5",onMouseLeave:d=>d.currentTarget.style.backgroundColor="transparent",children:"Upload File"})]}),S.jsx("input",{ref:r,type:"file",accept:"image/*",onChange:f,style:{display:"none"}})]}),S.jsx("button",{onClick:()=>{n.update(()=>{const d=F();if(A(d)){const p=new DOMParser().parseFromString('<table style="border-collapse: collapse; width: 100%; margin: 16px 0;"><thead><tr><th style="border: 1px solid #d1d5db; padding: 8px; background-color: #f3f4f6;">Header 1</th><th style="border: 1px solid #d1d5db; padding: 8px; background-color: #f3f4f6;">Header 2</th><th style="border: 1px solid #d1d5db; padding: 8px; background-color: #f3f4f6;">Header 3</th></tr></thead><tbody><tr><td style="border: 1px solid #d1d5db; padding: 8px;">Cell 1</td><td style="border: 1px solid #d1d5db; padding: 8px;">Cell 2</td><td style="border: 1px solid #d1d5db; padding: 8px;">Cell 3</td></tr><tr><td style="border: 1px solid #d1d5db; padding: 8px;">Cell 4</td><td style="border: 1px solid #d1d5db; padding: 8px;">Cell 5</td><td style="border: 1px solid #d1d5db; padding: 8px;">Cell 6</td></tr></tbody></table>',"text/html"),m=vn(n,p);d.insertNodes(m)}})},className:"toolbar-btn",title:"Insert Table",children:"📊 Table"})]})]})}function Wf({value:n,onChange:e,placeholder:t="Start typing..."}){const[r,i]=We.useState(!1),[o,s]=We.useState(n),l=We.useRef(n),a={namespace:"MyEditor",theme:{paragraph:"editor-paragraph",heading:{h1:"editor-heading-h1",h2:"editor-heading-h2",h3:"editor-heading-h3"},list:{nested:{listitem:"editor-nested-listitem"},ol:"editor-list-ol",ul:"editor-list-ul",listitem:"editor-listitem"},link:"editor-link",text:{bold:"editor-text-bold",italic:"editor-text-italic",underline:"editor-text-underline"},table:"editor-table",tableCell:"editor-table-cell",tableCellHeader:"editor-table-cell-header"},onError:d=>{console.error(d)},nodes:[zr,bo,vo,Rr,Rn,jr,Wr,zn,jn]},c=()=>{r?e(o):s(n),i(!r)},u=d=>{const g=d.target.value;s(g),e(g)},f=We.useCallback(d=>{l.current=d,e(d)},[e]);return S.jsxs("div",{className:"rich-text-editor",children:[S.jsx("div",{className:"toolbar",children:S.jsx("div",{className:"toolbar-group",children:S.jsx("button",{onClick:c,className:"toolbar-btn",title:r?"Switch to Rich Text":"Switch to HTML",type:"button",children:r?"📝 Rich Text":"🔧 HTML"})})}),r?S.jsx("textarea",{value:o,onChange:u,placeholder:"Enter HTML content...",style:{width:"100%",minHeight:"200px",padding:"16px",border:"none",outline:"none",fontFamily:"monospace",fontSize:"14px",lineHeight:"1.6",resize:"vertical"}}):S.jsxs(cd,{initialConfig:a,children:[S.jsx(jf,{}),S.jsxs("div",{className:"editor-container",children:[S.jsx(nf,{contentEditable:S.jsx(lf,{className:"editor-input",dir:"ltr",style:{direction:"ltr",textAlign:"left",unicodeBidi:"embed"},"aria-placeholder":t,placeholder:S.jsx("div",{className:"editor-placeholder",children:t})}),ErrorBoundary:yf}),S.jsx(ff,{}),S.jsx(Rf,{onChange:f,lastEditorContentRef:l}),S.jsx(zf,{content:n,lastEditorContentRef:l})]})]})]})}const{Text:rr}=bn;function Bf({announcement:n,onSave:e,onCancel:t}){const[r,i]=P.useState(""),[o,s]=P.useState(""),[l,a]=P.useState(!0),[c,u]=P.useState(!0),[f,d]=P.useState(!1);P.useEffect(()=>{ge.info("📝 AnnouncementEditor received announcement:",n),n?(i(n.title),s(n.content),a(n.showOnFeed??!0),u(n.allowComments??!0)):(i(""),s(""),a(!0),u(!0))},[n]);const g=async h=>{if(h&&h.preventDefault(),!r||r.trim().length===0){Un.error("Title is required");return}if(!o||o.trim().length===0){Un.error("Content is required");return}d(!0);try{await e(r.trim(),o.trim(),l,c),Un.success("Announcement saved successfully!"),t()}catch(p){ge.error("❌ Save failed:",p),Un.error("Failed to save: "+(p instanceof Error?p.message:"Unknown error"))}finally{d(!1)}};return S.jsx("div",{style:{padding:"24px"},children:S.jsx(Re,{title:n?"✏️ Edit Announcement":"📝 New Announcement",extra:S.jsxs(Rt,{children:[S.jsx(Ne,{icon:S.jsx(uc,{}),onClick:t,disabled:f,children:"Cancel"}),S.jsx(Ne,{type:"primary",icon:S.jsx(dc,{}),onClick:g,loading:f,children:"Save Draft"})]}),children:S.jsxs(Rt,{orientation:"vertical",size:"large",style:{width:"100%"},children:[S.jsxs("div",{children:[S.jsx(rr,{strong:!0,children:"Title *"}),S.jsx(ol,{value:r,onChange:h=>{i(h.target.value)},placeholder:"e.g., 2026 Spring Registration Open",maxLength:100,disabled:f,showCount:!0,size:"large"})]}),S.jsx(Re,{size:"small",title:"Announcement Settings",children:S.jsxs(sl,{gutter:[16,16],children:[S.jsx(zt,{span:12,children:S.jsxs(Rt,{children:[S.jsx(cr,{checked:l,onChange:a,disabled:f}),S.jsx(rr,{children:"Show On Announcement Feed"})]})}),S.jsx(zt,{span:12,children:S.jsxs(Rt,{children:[S.jsx(cr,{checked:c,onChange:u,disabled:f}),S.jsx(rr,{children:"Allow Comments"})]})})]})}),S.jsxs("div",{children:[S.jsx(rr,{strong:!0,children:"Content *"}),S.jsx("div",{style:{marginTop:"8px"},children:S.jsx(Wf,{value:o,onChange:s,placeholder:"Write your announcement here..."},n?.id||"new")})]})]})})})}const il={async addComment(n,e){const t=Ao(To,`comments/${n}`),r=Cc(t),i={...e,id:r.key};return await vc(r,i),i},async getComments(n){const e=Ao(To,`comments/${n}`),t=await Sc(e);if(!t.exists())return[];const r=t.val();return Object.values(r)}},{TextArea:Kf}=ol,{Text:hn}=bn;function Uf({announcementId:n,allowComments:e,onCommentCountChange:t}){const[r,i]=P.useState([]),[o,s]=P.useState(""),[l,a]=P.useState(!1),[c,u]=P.useState(!0),f=gn(p=>p.auth.user),{message:d}=fc.useApp();P.useEffect(()=>{g()},[n]);const g=async()=>{try{u(!0);const p=await il.getComments(n),m=p.sort((x,y)=>new Date(y.createdAt).getTime()-new Date(x.createdAt).getTime());i(m),setTimeout(()=>{t?.(p.length)},0)}catch(p){console.error("Failed to load comments:",p)}finally{u(!1)}},h=async()=>{if(!(!o.trim()||!f)){a(!0);try{const p={text:o.trim(),userName:f.displayName||f.email?.split("@")[0]||"Anonymous",userEmail:f.email||"",createdAt:new Date().toISOString()},m=await il.addComment(n,p);i(x=>{const y=[m,...x];return t?.(y.length),y}),s(""),d.success("Comment posted!")}catch(p){console.error("Failed to post comment:",p),d.error("Failed to post comment")}finally{a(!1)}}};return e?S.jsxs(Re,{title:"Comments",style:{marginTop:"16px"},children:[S.jsxs("div",{style:{marginBottom:"16px"},children:[S.jsx(Kf,{rows:3,value:o,onChange:p=>{s(p.target.value)},placeholder:"Write a comment...",maxLength:500,showCount:!0}),S.jsx("div",{style:{marginTop:"8px",textAlign:"right"},children:S.jsx(Ne,{type:"primary",icon:S.jsx(ll,{}),onClick:h,loading:l,disabled:!o.trim(),children:"Post Comment"})})]}),S.jsx("div",{children:c?S.jsx(hn,{type:"secondary",children:"Loading comments..."}):r.length===0?S.jsx(hn,{type:"secondary",children:"No comments yet. Be the first to comment!"}):r.map((p,m)=>S.jsxs("div",{children:[S.jsxs("div",{style:{display:"flex",gap:"12px",padding:"12px 0"},children:[S.jsx(hc,{icon:S.jsx(gc,{})}),S.jsxs("div",{style:{flex:1},children:[S.jsxs(Rt,{children:[S.jsx(hn,{strong:!0,children:p.userName}),S.jsx(hn,{type:"secondary",style:{fontSize:"12px"},children:new Date(p.createdAt).toLocaleString()})]}),S.jsx("div",{style:{marginTop:"4px"},children:S.jsx(hn,{children:p.text})})]})]}),m<r.length-1&&S.jsx(pc,{style:{margin:"8px 0"}})]},p.id))})]}):null}const{Text:di}=bn;function Zf(){const n=cc(),e=gn(_=>_.auth.user),t=gn(_=>_.auth.role),r=gn(_=>_.announcements.announcements),i=gn(_=>_.announcements.loading),[o,s]=P.useState("list"),[l,a]=P.useState(null),[c,u]=P.useState(null),[f,d]=P.useState("");P.useEffect(()=>{e?.uid&&g()},[e?.uid]);const g=async()=>{if(e?.uid){n(Eo(!0));try{const _=await At.getAnnouncements(e.uid);n(Ot(_)),d("")}catch(_){const O=_ instanceof Error?_.message:"Failed to load announcements";d(O),n(sc(O))}finally{n(Eo(!1))}}},h=()=>{a(null),s("editor")},p=_=>{a(_),s("editor")},m=async _=>{try{const O=r.map(L=>L.id===_?{...L,views:(L.views||0)+1}:L);n(Ot(O))}catch(O){ge.error("Failed to update view count:",O)}u(_),s("detail")},x=()=>{c&&(a(c),s("editor"))},y=async(_,O,L,R)=>{if(!e?.uid){ge.error("No user ID available");return}try{if(d(""),ge.info("🔄 Starting save operation...",{editingId:l,title:_,content:O}),l){ge.info("📝 Updating existing announcement:",l),await At.updateAnnouncement(l,{title:_,content:O,showOnFeed:L,allowComments:R});const $=r.map(z=>z.id===l?{...z,title:_,content:O}:z);n(Ot($)),ge.info("✅ Updated announcement successfully")}else{ge.info("📝 Creating new announcement...");const $=await At.createAnnouncement(e.uid,e.email||"Unknown",_,O,L,R);ge.info("✅ Created new announcement:",$),n(lc($)),ge.info("✅ Added to Redux store")}s("list"),a(null),ge.info("✅ Save operation completed successfully")}catch($){const z=$ instanceof Error?$.message:"Operation failed";throw d(z),ge.error("❌ Save error:",$),$}},C=async _=>{try{await At.publishAnnouncement(_);const O=r.map(L=>L.id===_?{...L,status:"published",publishedAt:new Date().toISOString()}:L);n(Ot(O)),d("")}catch(O){const L=O instanceof Error?O.message:"Publish failed";d(L)}},k=async _=>{if(confirm("Are you sure you want to delete this announcement?"))try{await At.deleteAnnouncement(_),n(ac(_)),d("")}catch(O){const L=O instanceof Error?O.message:"Delete failed";d(L)}},T=r.filter(_=>_.status==="draft").length,b=r.filter(_=>_.status==="published").length,N=P.useCallback(_=>{if(c){const O=r.map(L=>L.id===c?{...L,commentCount:_}:L);n(Ot(O))}},[c,r,n]),w=async(_,O,L)=>{try{await At.updateAnnouncement(_,{[O]:L});const R=r.map($=>$.id===_?{...$,[O]:L}:$);n(Ot(R))}catch(R){ge.error(`Failed to update ${O}:`,R)}};return S.jsxs("div",{className:"page-container",children:[o==="list"&&S.jsxs(S.Fragment,{children:[S.jsx(bc,{title:S.jsxs(S.Fragment,{children:[S.jsx(bn.Title,{level:2,style:{margin:0},children:"Announcements"}),S.jsx(bn.Text,{type:"secondary",children:"Communications and announcements"})]}),actions:t==="admin"||t==="owner"?S.jsx(Ne,{type:"primary",icon:S.jsx(Jr,{}),onClick:h,children:"Create Announcement"}):void 0}),r.length>0&&S.jsxs(sl,{gutter:16,style:{marginBottom:"24px"},children:[S.jsx(zt,{span:6,children:S.jsx(Re,{children:S.jsx(Jn,{title:"Total Announcements",value:r.length})})}),S.jsx(zt,{span:6,children:S.jsx(Re,{children:S.jsx(Jn,{title:"Published",value:b,styles:{content:{color:"#52c41a"}}})})}),S.jsx(zt,{span:6,children:S.jsx(Re,{children:S.jsx(Jn,{title:"Drafts",value:T,styles:{content:{color:"#faad14"}}})})}),S.jsx(zt,{span:6,children:S.jsx(Re,{children:S.jsx(Jn,{title:"Total Reach",value:0,suffix:"recipients"})})})]}),S.jsx(Re,{title:`Announcements (${r.length})`,children:S.jsx(mc,{columns:[{title:"Title",dataIndex:"title",key:"title",render:(_,O)=>S.jsx(Ne,{type:"link",onClick:()=>m(O.id),style:{padding:0,height:"auto"},children:S.jsx(di,{strong:!0,children:_})})},{title:"Status",dataIndex:"status",key:"status",render:_=>S.jsx(_c,{color:_==="published"?"green":"orange",children:_.toUpperCase()})},{title:"Date Created",dataIndex:"createdAt",key:"createdAt",render:_=>new Date(_).toLocaleDateString(),sorter:(_,O)=>new Date(_.createdAt).getTime()-new Date(O.createdAt).getTime()},{title:"Views",key:"views",render:_=>S.jsxs(di,{children:[S.jsx(yc,{})," ",_.views||0]})},{title:"Comments",key:"comments",render:_=>S.jsxs(di,{children:["💬 ",_.commentCount||0]})},{title:"Show on Feed",key:"showOnFeed",render:_=>S.jsx(cr,{checked:_.showOnFeed??!0,onChange:O=>w(_.id,"showOnFeed",O),disabled:t!=="admin"&&t!=="owner"})},{title:"Allow Comments",key:"allowComments",render:_=>S.jsx(cr,{checked:_.allowComments??!0,onChange:O=>w(_.id,"allowComments",O),disabled:t!=="admin"&&t!=="owner"})},...t==="admin"||t==="owner"?[{title:"Actions",key:"actions",render:_=>S.jsxs(Rt,{children:[S.jsx(Ne,{size:"small",icon:S.jsx(Jr,{}),onClick:()=>{p(_.id)}}),_.status==="draft"&&S.jsx(Ne,{size:"small",type:"primary",icon:S.jsx(ll,{}),onClick:()=>C(_.id)}),S.jsx(Ne,{size:"small",danger:!0,icon:S.jsx(xc,{}),onClick:()=>k(_.id)})]})}]:[]],dataSource:r,rowKey:"id",loading:i,locale:{emptyText:"No announcements yet. Check back later for updates!"},pagination:{pageSize:10,showSizeChanger:!1,showQuickJumper:!0,showTotal:(_,O)=>`${O[0]}-${O[1]} of ${_} announcements`}})})]}),o==="detail"&&c&&S.jsxs(S.Fragment,{children:[S.jsxs(Re,{title:r.find(_=>_.id===c)?.title,extra:(t==="admin"||t==="owner")&&S.jsx(Ne,{type:"primary",icon:S.jsx(Jr,{}),onClick:x,children:"Edit Announcement"}),children:[S.jsx(Ne,{type:"link",onClick:()=>{s("list")},style:{marginBottom:"16px"},children:"← Back to List"}),S.jsx("div",{style:{marginTop:"16px"},children:S.jsx("div",{dangerouslySetInnerHTML:{__html:r.find(_=>_.id===c)?.content||""}})})]}),S.jsx(Uf,{announcementId:c,allowComments:r.find(_=>_.id===c)?.allowComments??!0,onCommentCountChange:N})]}),o==="editor"&&S.jsx(Bf,{announcement:l?r.find(_=>_.id===l):void 0,onSave:y,onCancel:()=>{s("list"),a(null),u(null)}})]})}export{Zf as default};
