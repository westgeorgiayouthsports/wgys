import{I as p,j as e,r as u}from"./index-lWfxYzVq.js";import{r as o}from"./vendor-router-Ck4ZuSP9.js";import{u as M,a as D}from"./vendor-redux-BbD-gcRX.js";import{r as J}from"./firebaseRosters-BGWxAYEL.js";import"./vendor-react-Ck9bq5u-.js";import"./vendor-antd-CieyQibU.js";import"./vendor-firebase-BzUsRx-X.js";const H=({teamId:s,isAdmin:h=!1})=>{const i=M(),{registrations:y,loading:P,error:g}=D(a=>a.registrations),[m,b]=o.useState(!1),[V,q]=o.useState(null),[N,w]=o.useState([]),[C,f]=o.useState(!1),[t,j]=o.useState({playerName:"",playerAge:"",playerPosition:"",playerJerseyNumber:"",parentName:"",parentEmail:"",parentPhone:"",fee:"150"}),[l,v]=o.useState({selectedPayment:"stripe",cardNumber:"",cardExpiry:"",cardCVC:"",cardName:""});o.useEffect(()=>{s&&(i(p(s)),R())},[s,i]);const R=async()=>{if(s){f(!0);try{const a=await J.getTeamRoster(s);w(a)}catch(a){console.error("âŒ Error loading roster:",a)}finally{f(!1)}}},n=a=>{const{name:r,value:d}=a.target;j(x=>({...x,[r]:d}))},c=a=>{const{name:r,value:d}=a.target;v(x=>({...x,[r]:d}))},E=()=>t.playerName.trim()?!t.playerAge||parseInt(t.playerAge)<4||parseInt(t.playerAge)>18?(alert("Please enter a valid age (4-18)"),!1):t.parentName.trim()?t.parentEmail.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t.parentEmail)?t.parentPhone.trim()?!0:(alert("Please enter parent phone"),!1):(alert("Please enter a valid email"),!1):(alert("Please enter parent email"),!1):(alert("Please enter parent/guardian name"),!1):(alert("Please enter player name"),!1),S=async a=>{if(a.preventDefault(),!(!s||!E()))try{const r=await u.createRegistration(s,t.playerName,parseInt(t.playerAge),t.playerPosition||"",t.parentName,t.parentEmail,t.parentPhone,parseInt(t.fee),l.selectedPayment);l.selectedPayment!=="check"&&l.selectedPayment!=="cash"?await u.updateRegistration(r.id,{paymentMethod:l.selectedPayment,status:"pending"}):await u.updateRegistration(r.id,{paymentMethod:l.selectedPayment,status:"pending"}),j({playerName:"",playerAge:"",playerPosition:"",playerJerseyNumber:"",parentName:"",parentEmail:"",parentPhone:"",fee:"150"}),v({selectedPayment:"stripe",cardNumber:"",cardExpiry:"",cardCVC:"",cardName:""}),b(!1),s&&i(p(s)),alert("Registration submitted successfully!")}catch(r){console.error("âŒ Error creating registration:",r),alert("Failed to submit registration")}},A=async(a,r)=>{try{s&&i(p(s)),alert("Player linked to roster successfully!")}catch(d){console.error("âŒ Error linking to roster:",d),alert("Failed to link to roster")}},k=async a=>{try{await u.approveRegistration(a),s&&i(p(s)),alert("Registration approved!")}catch(r){console.error("âŒ Error approving registration:",r),alert("Failed to approve registration")}},F=a=>{switch(a){case"pending":return"bg-yellow-500/20 text-yellow-300";case"approved":return"bg-blue-500/20 text-blue-300";case"paid":return"bg-green-500/20 text-green-300";default:return"bg-gray-500/20 text-gray-300"}},L=a=>{switch(a){case"stripe":return"Stripe (Credit Card)";case"paypal":return"PayPal";case"square":return"Square";case"check":return"Check";case"cash":return"Cash";default:return"Not specified"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Team Registrations"}),e.jsx("button",{onClick:()=>{b(!m)},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition",children:m?"Cancel":"+ New Registration"})]}),g&&e.jsx("div",{className:"p-4 bg-red-500/20 border border-red-500 text-red-300 rounded-lg",children:g}),m&&e.jsxs("div",{className:"p-6 bg-slate-800 rounded-lg border border-slate-700 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Player Registration Form"}),e.jsxs("form",{onSubmit:S,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-300",children:"Player Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("input",{type:"text",name:"playerName",placeholder:"Player Name *",value:t.playerName,onChange:n,className:"px-4 py-2 bg-slate-700 border border-slate-600 rounded text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none"}),e.jsx("input",{type:"number",name:"playerAge",placeholder:"Age (4-18) *",min:"4",max:"18",value:t.playerAge,onChange:n,className:"px-4 py-2 bg-slate-700 border border-slate-600 rounded text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none"}),e.jsx("input",{type:"text",name:"playerPosition",placeholder:"Position (optional)",value:t.playerPosition,onChange:n,className:"px-4 py-2 bg-slate-700 border border-slate-600 rounded text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none"}),e.jsx("input",{type:"number",name:"playerJerseyNumber",placeholder:"Jersey # (optional)",value:t.playerJerseyNumber,onChange:n,className:"px-4 py-2 bg-slate-700 border border-slate-600 rounded text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-300",children:"Parent/Guardian Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("input",{type:"text",name:"parentName",placeholder:"Parent Name *",value:t.parentName,onChange:n,className:"px-4 py-2 bg-slate-700 border border-slate-600 rounded text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none"}),e.jsx("input",{type:"email",name:"parentEmail",placeholder:"Parent Email *",value:t.parentEmail,onChange:n,className:"px-4 py-2 bg-slate-700 border border-slate-600 rounded text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none"}),e.jsx("input",{type:"tel",name:"parentPhone",placeholder:"Parent Phone *",value:t.parentPhone,onChange:n,className:"col-span-2 px-4 py-2 bg-slate-700 border border-slate-600 rounded text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-300",children:"Registration Fee"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-gray-400",children:"$"}),e.jsx("input",{type:"number",name:"fee",value:t.fee,onChange:n,className:"flex-1 px-4 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:border-blue-500 focus:outline-none"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-300",children:"Payment Method"}),e.jsxs("select",{name:"selectedPayment",value:l.selectedPayment,onChange:c,className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:border-blue-500 focus:outline-none",children:[e.jsx("option",{value:"stripe",children:"Stripe (Credit/Debit Card)"}),e.jsx("option",{value:"paypal",children:"PayPal"}),e.jsx("option",{value:"square",children:"Square"}),e.jsx("option",{value:"check",children:"Check"}),e.jsx("option",{value:"cash",children:"Cash"})]}),(l.selectedPayment==="stripe"||l.selectedPayment==="square")&&e.jsxs("div",{className:"space-y-3 p-3 bg-slate-700 rounded border border-slate-600",children:[e.jsx("input",{type:"text",name:"cardName",placeholder:"Cardholder Name",value:l.cardName,onChange:c,className:"w-full px-4 py-2 bg-slate-600 border border-slate-500 rounded text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none"}),e.jsx("input",{type:"text",name:"cardNumber",placeholder:"Card Number (4111 1111 1111 1111)",value:l.cardNumber,onChange:c,maxLength:19,className:"w-full px-4 py-2 bg-slate-600 border border-slate-500 rounded text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("input",{type:"text",name:"cardExpiry",placeholder:"MM/YY",value:l.cardExpiry,onChange:c,maxLength:5,className:"px-4 py-2 bg-slate-600 border border-slate-500 rounded text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none"}),e.jsx("input",{type:"text",name:"cardCVC",placeholder:"CVC",value:l.cardCVC,onChange:c,maxLength:4,className:"px-4 py-2 bg-slate-600 border border-slate-500 rounded text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none"})]}),e.jsx("p",{className:"text-xs text-gray-400",children:"ðŸ’³ Test Card: 4111 1111 1111 1111 | Any future date | Any CVC"})]})]}),e.jsx("button",{type:"submit",className:"w-full px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition font-medium",children:"Submit Registration"})]})]}),P?e.jsx("div",{className:"text-center py-8 text-gray-400",children:"Loading registrations..."}):y.length===0?e.jsx("div",{className:"text-center py-8 text-gray-400",children:"No registrations yet"}):e.jsx("div",{className:"grid gap-4",children:y.map(a=>e.jsxs("div",{className:"p-6 bg-slate-800 border border-slate-700 rounded-lg space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:a.playerName}),e.jsxs("p",{className:"text-sm text-gray-400",children:["Age ",a.playerAge]})]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium capitalize ${F(a.status)}`,children:a.status})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400",children:"Position"}),e.jsx("p",{className:"text-white",children:a.playerPosition||"Not specified"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400",children:"Jersey #"}),e.jsx("p",{className:"text-white",children:a.playerJerseyNumber||"Not assigned"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400",children:"Parent"}),e.jsx("p",{className:"text-white",children:a.parentName})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400",children:"Email"}),e.jsx("p",{className:"text-white",children:a.parentEmail})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400",children:"Phone"}),e.jsx("p",{className:"text-white",children:a.parentPhone})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400",children:"Fee"}),e.jsxs("p",{className:"text-white",children:["$",a.fee]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("p",{className:"text-gray-400",children:"Payment Method"}),e.jsx("p",{className:"text-white",children:L(a.paymentMethod)})]})]}),h&&e.jsxs("div",{className:"space-y-3 p-3 bg-slate-700 rounded",children:[e.jsx("p",{className:"text-sm font-medium text-gray-300",children:"Link to Roster"}),C?e.jsx("p",{className:"text-xs text-gray-400",children:"Loading roster..."}):N.length===0?e.jsx("p",{className:"text-xs text-gray-400",children:"No roster players available"}):e.jsxs("select",{value:a.rosterPlayerId||"",onChange:r=>{r.target.value&&A(a.id,r.target.value)},className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm focus:border-blue-500 focus:outline-none",children:[e.jsx("option",{value:"",children:"Select player..."}),N.map(r=>e.jsxs("option",{value:r.id,children:[r.name," (#",r.number,")"]},r.id))]})]}),h&&e.jsx("div",{className:"flex gap-2",children:a.status==="pending"&&e.jsx("button",{onClick:()=>k(a.id),className:"flex-1 px-3 py-2 text-sm bg-green-600 hover:bg-green-700 text-white rounded transition",children:"Approve"})})]},a.id))})]})};export{H as RegistrationsView,H as default};
