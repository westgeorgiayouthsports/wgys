import{a8 as g}from"./vendor-antd-CieyQibU.js";import{I as u,J as f,K as y,L as h,M as p}from"./vendor-firebase-BzUsRx-X.js";import{E as i,l}from"./index-lWfxYzVq.js";function A(t,r){if(!t)return null;const e=r||g(),a=e.year(),s=e.month()>=7?a:a-1,n=12-(t-s-1);return n>=0&&n<=12?n:null}const B={async uploadFile(t,r){try{const e=u(i,t),a=await p(e,r);return await f(a.ref)}catch(e){throw l.error("❌ Error uploading file to storage:",e),e}},async uploadFileWithProgress(t,r,e){return new Promise((a,c)=>{try{const s=u(i,t),n=h(s,r);n.on("state_changed",o=>{if(e&&o.totalBytes){const d=Math.round(o.bytesTransferred/o.totalBytes*100);e(d)}},o=>{l.error("Upload failed",o),c(o)},()=>{f(n.snapshot.ref).then(o=>{a({url:o,path:t})}).catch(o=>{c(o)})})}catch(s){l.error("uploadFileWithProgress error",s),c(s)}})},async deleteFile(t){try{const r=u(i,t);await y(r)}catch(r){l.error("❌ Error deleting file from storage:",r)}},async getFileUrl(t){try{const r=u(i,t);return await f(r)}catch(r){throw l.error("❌ Error getting download URL:",r),r}}};export{A as c,B as s};
